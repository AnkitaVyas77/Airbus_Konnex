(function(a){if(navigator.userAgent.match(/.*?(Trident|Edge)/)){a(document).on("click","button[type=submit]",function(d){var f=this.getAttribute("form");
if(f){d.preventDefault();
var c=document.getElementById(f);
if(c){var b=document.createEvent("Event");
b.initEvent("submit",true,true);
c.dispatchEvent(b)
}}})
}a(document).on("click","button[type=reset]",function(c){var d=this.getAttribute("form");
if(d){c.preventDefault();
var b=document.getElementById(d);
if(b){b.reset()
}}});
if(!Array.prototype.find){Array.prototype.find=function(d,b){var c;
Array.prototype.some.call(this,function(e){if(d.apply(b,arguments)){c=e;
return true
}return false
});
return c
}
}if(!String.prototype.startsWith){String.prototype.startsWith=function(c,b){b=b||0;
return this.substr(b,c.length)===c
}
}})(Granite.$);
Granite=window.Granite||{};
Granite.UI=Granite.UI||{};
Granite.UI.Foundation=Granite.UI.Foundation||{};
(function(a,c,b){b.options.transformHash=false
})(document,Granite.$,History);
(function(c,a,b,d){b.UI.Foundation.Utils=b.UI.Foundation.Utils||(function(){var g=[];
var f=function(l,j,k,m){m=m||d(j);
var i=[];
l.find(j).each(function(){var o=this;
var n=m.is(function(){return k(this,o)
});
if(n){d(o).remove()
}else{i.push(d(o).detach()[0])
}});
return d(i)
};
var h=function(j,i){if(j.length===0){Array.prototype.push.apply(j,i);
return j
}d.each(i,function(){var k=this;
var l=j.some(function(m){return m.src===k.src
});
if(!l){j.push(k)
}});
return j
};
var e=function(i,j){var k=[];
d.each(i,function(){var m=this;
var n=a.createElement("script");
var l=d.Deferred();
k.push(l);
d(n).one("load error",function(){l.resolve()
});
n.async=false;
n.src=m.src;
j.appendChild(n)
});
return d.when.apply(null,k)
};
return{everyReverse:function(m,l,j){for(var k=m.length-1;
k>=0;
k--){if(!l.call(j,m[k],k,m)){return false
}}return true
},debounce:function(j,l,i){var k;
return function(){var p=this;
var o=arguments;
var n=function(){k=null;
if(!i){j.apply(p,o)
}};
var m=i&&!k;
clearTimeout(k);
k=setTimeout(n,l);
if(m){j.apply(p,o)
}}
},processHtml:function(m,k,p,l){var j;
if(m.jquery){j=m
}else{var i=a.createElement("div");
i.innerHTML=m;
j=d(i)
}var r=f(j,"script[src]",function(t,u){return t.src===u.src
},d(h(g,d("script[src]"))));
var q=f(j,"link[rel=stylesheet]",function(t,u){return t.href===u.href
});
var o=d("head");
if(!l){o.append(d("link[rel=stylesheet]",a.body));
d("script[src]",a.body).remove()
}var s=e(r,o[0]);
o.append(q);
if(p){setTimeout(function(){s.done(p)
},0)
}var n=j.find(k);
if(m.jquery){if(k){return n.length?n:j
}else{return j
}}else{if(k){return n.length?n[0].outerHTML:j[0].innerHTML
}else{return j[0].innerHTML
}}}}
})()
})(window,document,Granite,Granite.$);
(function(a,b){Granite.UI.Foundation.Registry=Granite.UI.Foundation.Registry||(function(){var c=new Map();
return{register:function(e,d){if(c.has(e)){c.get(e).push(d)
}else{c.set(e,[d])
}},get:function(d){if(c.has(d)){return c.get(d)
}else{return[]
}}}
})();
Granite.UI.Foundation.Registry.register("foundation.adapters",{type:"foundation-registry",selector:b(a),adapter:function(){return Granite.UI.Foundation.Registry
}})
})(window,Granite.$);
(function(a,b){a.UI.Foundation.Adapters=a.UI.Foundation.Adapters||(function(){var c=a.UI.Foundation.Registry;
var d=function(){return c.get("foundation.adapters")
};
return{register:function(h,e,f){var g={type:h,selector:e,adapter:f};
c.register("foundation.adapters",g)
},has:function(e){return d().some(function(f){return f.type===e
})
},get:function(f){var e=[];
d().forEach(function(g){if(g.type===f){e.push(g)
}});
return e
},adapt:function(h,k){if(!h||!k){return
}var j=b(h);
var g;
a.UI.Foundation.Utils.everyReverse(d(),function(l){if(l.type===k&&j.is(l.selector)){g=l;
return false
}return true
});
if(!g){return
}var i="foundation.adapters.internal.adapters."+g.type;
var f=j.data(i);
if(f&&f.config===g){return f.instance
}var e=g.adapter(h);
j.data(i,{config:g,instance:e});
return e
}}
})();
b.fn.adaptTo=b.fn.adaptTo||function(c){return a.UI.Foundation.Adapters.adapt(this[0],c)
}
})(Granite,Granite.$);
(function(a,b){b(a).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-tracker",selector:b(a),adapter:function(){var d=false;
var c=function(e,f){if(d){console.dir({type:e,data:f})
}};
return{setDebugMode:function(e){d=!!e
},trackPage:function(f){c("page",f);
try{a.Granite.Tracking.Tracker.trackPage(f)
}catch(e){}},trackEvent:function(f){c("event",f);
try{a.Granite.Tracking.Tracker.trackEvent(f)
}catch(e){}}}
}})
})(window,Granite.$);
(function(b,a,c){c(function(){var d=c('meta[name="foundation.tracking.page"]',a.head).attr("content");
if(!d){return
}var f=JSON.parse(d);
var e=c(b).adaptTo("foundation-tracker");
e.trackPage(f)
})
})(window,document,Granite.$);
(function(b,a,c){c(a).on("click","[data-foundation-tracking-event]",function(f){var d=c(this).adaptTo("foundation-tracking-event");
d.track(f)
});
c(b).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-tracking-event",selector:"[data-foundation-tracking-event]",adapter:function(d){return{track:function(f){var e=d.getAttribute("data-foundation-tracking-event");
var h=d.getAttribute("tracking");
if(!e||(h&&h!=="ON")){return
}var g=JSON.parse(e);
g.feature=g.feature||"";
g.action="click";
if(g.widget){g.widget.name=g.widget.name||g.element
}var i=c(d).adaptTo("foundation-tracking-event-data-provider");
if(i&&i.getTrackingAttributes){g.attributes=i.getTrackingAttributes(d)
}c(b).adaptTo("foundation-tracker").trackEvent(g)
}}
}})
})(window,document,Granite.$);
(function(a,b){if(typeof Coral==="undefined"||!Coral.tracking){return
}function d(e){if(typeof e!=="string"){return""
}return e.toLowerCase()
}function c(j,h,f,e){var k={element:d(j.targetElement),type:d(j.targetType),action:d(j.eventType),widget:{name:d(j.rootElement),type:d(j.rootType)},feature:d(j.rootFeature)};
var i=f.getAttribute("tracking");
if(i&&i!=="ON"){return
}var l=b(f).adaptTo("foundation-tracking-event-data-provider");
if(l&&l.getTrackingAttributes){k.attributes=l.getTrackingAttributes(f)
}var g=b(a).adaptTo("foundation-tracker");
g.trackEvent(k)
}Coral.tracking.addListener(c)
}(window,Granite.$));
(function(b,a,c){c(b).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-form-handle-tracking",selector:"*",adapter:function(d){return{trackFormSubmit:function(m){if(!m){return
}var o=c(m).serializeArray?c(m).serializeArray():[];
var f=c(m).attr("fieldTrackingIdentifier");
var k=c(m).attr("trackingElement");
var s=c(m).attr("trackingFeature");
var j=c(m).attr("trackingWidget");
if(!k||!s){return
}var n={};
if(j){try{n=JSON.parse(j)
}catch(h){}}if(!n.name){n.name=k.toLowerCase()
}if(!n.type){n.type="form"
}var t={element:k.toLowerCase(),type:"button",action:"click",widget:n,feature:s};
var r=c(m).adaptTo("foundation-tracking-event-data-provider");
if(r&&r.getTrackingAttributes){t.attributes=r.getTrackingAttributes(m)
}if(f&&o&&o.length>0){try{var g={};
for(var p=0;
p<o.length;
p++){g[o[p].name]=o[p].value
}f="["+f+"]";
var e=JSON.parse(f);
t.attributes=t.attributes?t.attributes:{};
for(var l=0;
l<e.length;
l++){if(g[e[l].name]){t.attributes[e[l].tag]=g[e[l].name]
}}}catch(h){}}var q=c(b).adaptTo("foundation-tracker");
q.trackEvent(t)
}}
}})
})(window,document,Granite.$);
(function(i,e,d,g){var k;
function j(){if(!k){k=new g.Dialog().set({closable:"on"}).on("coral-overlay:close",function(l){l.target.remove()
})
}return k
}var h;
function b(){if(!h){h=new g.Dialog().set({backdrop:g.Dialog.backdrop.STATIC,interaction:"off"}).on("coral-overlay:close",function(l){l.target.remove()
})
}return h
}var f;
function c(){if(!f){f=e(i.createElement("div")).addClass("foundation-ui-mask");
f.append(new g.Wait().set({centered:true,size:"L"}))
}return f
}var a=e(window).adaptTo("foundation-registry");
a.register("foundation.adapters",{type:"foundation-ui",selector:e(window),adapter:function(){return{alert:function(o,n,m){var l=j();
l.variant=m||"default";
l.header.textContent=o||"";
l.content.innerHTML=n||"";
i.body.appendChild(l);
l.show()
},notify:function(p,o,m){var l=new g.Alert();
l.classList.add("foundation-ui-notification");
l.variant=m||"info";
l.header.textContent=p||(function(){switch(m){case"error":return d.I18n.get("Error");
case"notice":return d.I18n.get("Notice");
case"success":return d.I18n.get("Success");
case"help":return d.I18n.get("Help");
default:return d.I18n.get("Info")
}})();
l.content.innerHTML=o||"";
var n=d.UI.Foundation.Utils.everyReverse(a.get("foundation.ui.notify.positionhandler"),function(q){return q.call(l,l)===false
});
if(n){i.body.appendChild(l)
}setTimeout(function(){l.remove()
},5000)
},waitTicker:function(n,m){var l=new g.Dialog();
l.backdrop=g.Dialog.backdrop.STATIC;
l.header.textContent=n;
l.header.insertBefore(new g.Wait(),l.header.firstChild);
l.content.innerHTML=m||"";
i.body.appendChild(l);
l.show();
return{updateMessage:function(o){l.content.innerHTML=o
},clear:function(){l.hide();
requestAnimationFrame(function(){l.remove()
})
}}
},prompt:function(p,n,m,o,q){var l=b();
l.variant=m||"default";
l.header.textContent=p||"";
l.content.innerHTML=n||"";
l.footer.innerHTML="";
o.forEach(function(s){var r=new g.Button();
r.label.textContent=s.text;
if(s.primary){r.variant="primary"
}else{if(s.warning){r.variant="warning"
}}r.on("click",function(t){l.hide();
if(s.handler){s.handler(s)
}if(q){q(s.id,s)
}});
l.footer.appendChild(r)
});
i.body.appendChild(l);
l.show()
},wait:function(l){c().appendTo(l||i.body)
},clearWait:function(){c().detach()
}}
}})
})(document,Granite.$,Granite,Coral);
(function(e,a,g){var d=[];
var c=function(m,j,k,l){l=l||g(j);
var i=[];
Array.prototype.forEach.call(m.querySelectorAll(j),function(o){var n=l.is(function(){return k(this,o)
});
if(n){g(o).remove()
}else{i.push(g(o).detach()[0])
}});
return i
};
var h=function(j,i){if(j.length===0){Array.prototype.push.apply(j,i);
return j
}g.each(i,function(){var k=this;
var l=j.some(function(m){return m.src===k.src
});
if(!l){j.push(k)
}});
return j
};
var b=function(i,j){var k=i.map(function(m){var l=g.Deferred();
var n=a.createElement("script");
g(n).one("load error",function(){l.resolve()
});
n.async=false;
n.src=m.src;
j.appendChild(n);
return l
});
return g.when.apply(null,k)
};
var f=function(j,n){var i=c(j,"script[src]",function(o,p){return o.src===p.src
},g(h(d,g("script[src]"))));
var m=c(j,"link[rel=stylesheet]",function(o,p){return o.href===p.href
});
var k=g("head");
if(!n){k.append(g("link[rel=stylesheet]",a.body));
g("script[src]",a.body).remove()
}var l=b(i,k[0]);
k.append(m);
return l
};
g(e).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-util-htmlparser",selector:g(e),adapter:function(){return{parse:function(j,k){var i;
if(j instanceof Element||j instanceof DocumentFragment){i=j
}else{i=this.createFragment(j)
}return f(i,k).then(function(){return i
})
},createFragment:function(i){var j=a.createElement("template");
if("content" in j){j.innerHTML=i;
return a.importNode(j.content,true)
}else{return a.createRange().createContextualFragment(i)
}}}
}})
})(window,document,Granite.$);
(function(d,c,e){var b=2000;
function a(g){var i=g.length>b;
var l="GET";
var j=g;
var h=undefined;
if(i){var k=g.lastIndexOf("?");
if(k>=0){l="POST";
j=g.substring(0,k);
h=g.substring(k+1)
}}return{method:l,url:j,data:h}
}function f(g){this.el=g.el;
this._$el=e(this.el);
this.isLoading=false;
this.hasNext=true;
this.offset=0;
this.limit=g.limit||20;
this._resolveURL=g.resolveURL;
this._processResponse=g.processResponse;
this._onNewPage=g.onNewPage||e.noop;
this._wait=g.wait||function(){return{clear:e.noop}
};
this._tolerance=20;
this._destroyed=false;
this._started=false;
this._performTimeoutId=null
}f.NS=".foundation-util-paginator";
f.prototype.start=function(m,g,j,i){if(this._destroyed){throw new Error("Illegal state: paginator is already destroyed")
}if(this._started){throw new Error("Illegal state: paginator is already started")
}var h=this;
var l=this._$el;
this._started=true;
this.offset=m>=0?m:0;
this.hasNext=typeof g==="boolean"?g:true;
var k=function(){l.on("scroll"+f.NS,c.UI.Foundation.Utils.debounce(function(){if(h._destroyed){return
}var o=l.prop("scrollHeight");
var p=l.prop("scrollTop");
var n=l.prop("clientHeight");
if(n+p+h._tolerance>=o){h._loadNextPage()
}},100));
h.restart(h.offset,h.hasNext,j)
};
if(i){this._performTimeoutId=setTimeout(function(){k()
},i)
}else{k()
}};
f.prototype.restart=function(i,g,h){if(this._destroyed){throw new Error("Illegal state: paginator is already destroyed")
}if(!this._started){throw new Error("Illegal state: paginator is not yet started")
}this.offset=i>=0?i:0;
this.hasNext=typeof g==="boolean"?g:true;
if(h&&this.isLoading){this._lastRequest.abort()
}this._doFirstLoad(h)
};
f.prototype.destroy=function(){this._$el.off("scroll"+f.NS);
clearTimeout(this._performTimeoutId);
if(this.isLoading){this._lastRequest.abort()
}this._destroyed=true
};
f.prototype._doFirstLoad=function(k){var g=this;
var j=k;
if(!j){var i=this._$el.prop("clientHeight");
var h=this._$el.prop("scrollHeight");
j=i>0&&h-i<=this._tolerance
}if(j){this._loadNextPage().then(function(){g._doFirstLoad()
})
}return j
};
f.prototype._loadNextPage=function(){var g=this;
if(this.isLoading||!this.hasNext){return e.Deferred().reject().promise()
}this.isLoading=true;
var j=this._wait(this);
var h=this._resolveURL(this);
var i=a(h);
this._lastRequest=e.ajax({method:i.method,url:i.url,data:i.data,cache:false});
return this._lastRequest.then(function(k){j.clear();
return g._processResponse(g,k)
},function(m,k){g.isLoading=false;
j.clear();
if(k!=="abort"){var o=c.I18n.get("Error");
var l=c.I18n.get("Fail to load next page.");
var n=e(d).adaptTo("foundation-ui");
n.alert(o,l,"error")
}}).then(function(k){g.offset+=k.length;
g.hasNext=k.hasNext;
g.isLoading=false;
g._onNewPage(g)
})
};
e(d).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-util-paginator",selector:e(d),adapter:function(){return f
}})
})(window,Granite,Granite.$);
(function(b,a,c){var d="foundation-util-messenger.internal.messages";
c(b).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-util-messenger",selector:c(b),adapter:function(){return{put:function(j,h,f){try{var g=JSON.parse(b.sessionStorage.getItem(d))||[];
g.push({title:j,message:h,type:f});
b.sessionStorage.setItem(d,JSON.stringify(g))
}catch(i){if(b.console){console.warn("Error occur saving message",i)
}}},promptAll:function(){var f=c(b).adaptTo("foundation-ui");
var e=JSON.parse(b.sessionStorage.getItem(d));
if(e){e.forEach(function(g){f.notify(g.title,g.message,g.type)
});
b.sessionStorage.removeItem(d)
}}}
}});
c(function(){c(b).adaptTo("foundation-util-messenger").promptAll()
})
})(window,document,Granite.$);
(function(b){function a(c){this._descriptor=c;
this._mixins=[]
}a.prototype.mix=function(c){this._mixins.push(c);
return this
};
a.prototype.build=function(){var d=this._descriptor;
var c=this._mixins.reduce(function(g,f){return f(g)
},d);
var e=this._mixins.reduceRight(function(g,f){return f(g)
},d);
return{configurable:d.configurable,enumerable:d.enumerable,get:c.get,set:e.set}
};
a.createAttrBasedProperty=function(d,c){return{get:function(){var e=this.getAttribute(d);
if(c===undefined){return e
}else{return e===null?c:e
}},set:function(e){this.setAttribute(d,e)
}}
};
a.createBooleanAttrBasedProperty=function(d,c){return{get:function(){if(this.hasAttribute(d)){return true
}return c===undefined?false:c
},set:function(e){if(!!e){this.setAttribute(d,"")
}else{this.removeAttribute(d)
}}}
};
a.integerType=function(c){return function(e){var d=0;
return{get:function(){var f=parseInt(e.get.call(this),10);
return isNaN(f)?c:f
},set:function(g){var f=parseInt(g,10);
if(isNaN(f)){f=d
}e.set.call(this,f)
}}
}
};
a.positiveNumber=function(c){return function(d){return{get:function(){var e=d.get.call(this);
return e<0?c:e
},set:function(e){if(e<0){throw new RangeError("Value is negative number")
}d.set.call(this,e)
}}
}
};
$(b).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-util-propertybuilder",selector:$(b),adapter:function(){return a
}})
})(window);
(function(b,c){var d=Granite.UI.Foundation.Utils.everyReverse;
var a=c(b).adaptTo("foundation-registry");
a.register("foundation.adapters",{type:"foundation-response-parser",selector:c(b),adapter:function(){return{parse:function(f){var e;
var g=f.getResponseHeader("content-type");
if(!g){return f.responseText
}d(a.get("foundation.response.parser"),function(i){if(!g.match(i.contentType)){return true
}var h=i.handler(f);
if(h===false){return true
}e=h;
return false
});
return e
}}
}})
})(window,Granite.$);
(function(a,b){b(a).adaptTo("foundation-registry").register("foundation.response.parser",{name:"foundation.json",contentType:/application\/json/,handler:function(c){return JSON.parse(c.responseText)
}})
})(window,Granite.$);
(function(a,b){b(a).adaptTo("foundation-registry").register("foundation.response.parser",{name:"foundation.html",contentType:/text\/html/,handler:function(c){return b(a).adaptTo("foundation-util-htmlparser").createFragment(c.responseText)
}})
})(window,Granite.$);
(function(j,l,g,f){var m=f.UI.Foundation.Utils.everyReverse;
var c=g(j).adaptTo("foundation-registry");
function h(q,p){for(var o=q.length-1;
o>=0;
o--){var n=q[o];
if(n.submittable&&p.is(n.submittable)){return n
}}return undefined
}function k(n,o){this.el=n;
this.selectorConfig=o;
this.$el=g(n);
this.message=null;
this.customMessage=null;
this.isValidated=false;
this.state=(function(p){return{getCustomError:function(){return !!p.customMessage
},isValid:function(){return !p.customMessage&&!p.message
},isValidated:function(){return p.isValidated
}}
})(this)
}k.prototype={willValidate:function(){if(!this.selectorConfig){var n=c.get("foundation.validation.selector");
this.selectorConfig=h(n,this.$el)
}var o=this.selectorConfig.candidate;
return o&&this.$el.is(o)
},setCustomValidity:function(n){this.customMessage=n
},getValidity:function(){return this.state
},checkValidity:function(n){n=n||{};
if(!this.willValidate()){return true
}this.isValidated=true;
if(this.customMessage){if(!n.suppressEvent){this.$el.trigger("foundation-validation-invalid")
}return false
}this.message=null;
m(c.get("foundation.validation.validator"),function(p){if(!p.validate){return true
}if(!this.$el.is(p.selector)){return true
}var o=p.validate(this.el);
if(o){this.message=o;
return false
}else{return true
}},this);
if(this.message){if(!n.suppressEvent){this.$el.trigger("foundation-validation-invalid")
}return false
}if(!n.suppressEvent){this.$el.trigger("foundation-validation-valid")
}return true
},getValidationMessage:function(){if(!this.willValidate()){return""
}return this.customMessage||this.message||""
},updateUI:function(){if(this.el.dataset.foundationValidationUi==="none"){return
}var n;
if(this.getValidity().isValid()){n=function(o){if(!o.clear){return true
}if(!this.$el.is(o.selector)){return true
}var p=false;
o.clear(this.el,{next:function(){p=true
}});
return p
}
}else{n=function(o){if(!o.show){return true
}if(!this.$el.is(o.selector)){return true
}var p=false;
o.show(this.el,this.getValidationMessage(),{next:function(){p=true
}});
return p
}
}m(c.get("foundation.validation.validator"),n,this)
}};
var i=new WeakMap();
function b(n){return n.reduceRight(function(p,o){if(o.submittable){p.push(o.submittable)
}return p
},[]).join(",")
}function d(o,n){return o.some(function(p){if(!p.exclusion){return false
}return n.is(p.exclusion)
})
}g.extend(g.expr[":"],{"-foundation-submittable":function(r){if(i.has(r)){return i.get(r).isSubmittable
}var p=g(r);
var o=c.get("foundation.validation.selector");
var n=h(o,p);
var q=false;
if(n){q=!d(o,p)
}i.set(r,{isSubmittable:q,selectorConfig:n});
return q
}});
c.register("foundation.adapters",{type:"foundation-validation",selector:":-foundation-submittable",adapter:function(n){return new k(n,i.get(n).selectorConfig)
}});
c.register("foundation.adapters",{type:"foundation-validation-helper",selector:"*",adapter:function(n){return{getSubmittables:function(){var p=c.get("foundation.validation.selector");
var o=g(n).find(b(p));
return o.filter(function(){var q=!d(p,g(this));
i.set(this,{isSubmittable:q});
return q
}).toArray()
},isValid:function(){return this.getSubmittables().every(function(o){var p=g(o).adaptTo("foundation-validation");
var q=p.getValidity();
if(q.isValidated()){return q.isValid()
}else{return p.checkValidity({suppressEvent:true})
}})
}}
}});
function e(n){return g(n.adaptTo("foundation-validation-helper").getSubmittables()).map(function(){var o=g(this).adaptTo("foundation-validation");
if(o.checkValidity({suppressEvent:true})){return
}return{el:this,api:o}
}).map(function(){var o=g.Event("foundation-validation-invalid");
g(this.el).trigger(o);
if(!o.isDefaultPrevented()){return this
}})
}function a(o){var n=e(o);
if(n.length>0){n.each(function(){this.api.updateUI()
});
return false
}return true
}l.addEventListener("submit",function(q){var o=g(q.target);
if(!o.is("form")||o.prop("noValidate")===true||(o.prop("noValidate")===undefined&&o.attr("novalidate")!==undefined)){return
}var n=o.data("foundation-validation-bind.internal.valid");
var p;
if(n!==undefined){p=n
}else{p=a(o)
}if(!p){q.stopPropagation();
q.preventDefault()
}},true)
})(window,document,Granite.$,Granite);
(function(g,a,h,f){var c=0;
function e(i){if(g.console&&c<1){c++;
console.warn("@deprecated ",i,"; use foundation-validation")
}}h.extend(h.expr[":"],{submittable:function(i){e(":submittable");
return h(i).is(":-foundation-submittable")
}});
h.fn.willValidate=function(){e("$.fn.willValidate");
var i=this.adaptTo("foundation-validation");
if(i){return i.willValidate()
}else{return false
}};
h.fn.validationMessage=function(){e("$.fn.validationMessage");
var i=this.adaptTo("foundation-validation");
if(i){return i.getValidationMessage()
}else{return""
}};
h.fn.checkValidity=function(){e("$.fn.checkValidity");
var i=this.adaptTo("foundation-validation");
if(i){return i.checkValidity()
}else{return true
}};
h.fn.setCustomValidity=function(i){e("$.fn.setCustomValidity");
return this.each(function(){var j=h(this).adaptTo("foundation-validation");
if(j){j.setCustomValidity(i)
}})
};
h.fn.updateErrorUI=function(){e("$.fn.updateErrorUI");
return this.each(function(){var i=h(this).adaptTo("foundation-validation");
if(i){i.updateUI()
}})
};
var b=h(g).adaptTo("foundation-registry");
function d(k){var l=k.validate;
if(l){k.validate=function(m){return l(h(m))
}
}var j=k.show;
if(j){k.show=function(n,o,m){if(j(h(n),o)===h.validator.CONTINUE){m.next()
}}
}var i=k.clear;
if(i){k.clear=function(n,m){if(i(h(n))===h.validator.CONTINUE){m.next()
}}
}return k
}h.validator={CONTINUE:1,STOP:2,register:function(){e("$.validator");
h.each(arguments,function(){b.register("foundation.validation.validator",d(this))
})
},isValid:function(i,j){e("$.validator");
return i.adaptTo("foundation-validation-helper").getSubmittables().every(function(k){var l=h(k).adaptTo("foundation-validation");
var m=l.getValidity();
if(m.isValidated()){return m.isValid()
}else{return l.checkValidity({suppressEvent:j})
}})
}};
h(a).on("foundation-validation-valid",function(i){h(i.target).trigger("valid")
});
h(a).on("foundation-validation-invalid",function(j){var i=h.Event("invalid",{isJqueryValidator:true});
h(j.target).trigger(i);
if(i.isDefaultPrevented()){j.preventDefault()
}})
})(window,document,Granite.$,Granite);
(function(a,f,e){function c(h){var g=h.find(".foundation-validation-bind");
var i=h.prop("id");
if(i){g=g.add(f(".foundation-validation-bind[form]").filter(function(){return f(this).attr("form")===i
}))
}return g
}function b(i){var h=c(i);
if(!h.length){return
}var g=i.adaptTo("foundation-validation-helper").isValid();
i.data("foundation-validation-bind.internal.valid",g);
h.prop("disabled",!g)
}function d(h,j){var i="foundation-validation-bind.internal.invalids";
var g=h.data(i);
if(g===undefined){g=[];
h.data(i,g)
}if(g.indexOf(j)<0){g.push(j)
}}f(a).on("foundation-validation-invalid","form",function(h){var g=f(this);
c(g).prop("disabled",true);
d(g,h.target)
});
f(a).on("foundation-validation-valid","form",function(n){var l=f(this);
var g=l.data("foundation-validation-bind.internal.invalids");
if(!g){b(l);
return
}var k=g.indexOf(n.target);
if(k>=0){g.splice(k,1)
}if(g.length===0){b(l);
return
}var m=false;
var h=g.length;
while(h--){if(l.has(g[h]).length){m=true;
break
}g.splice(h,1)
}if(!m){b(l)
}})
})(document,Granite.$,Granite);
(function(d,a,e,c){var b=e(d).adaptTo("foundation-registry");
b.register("foundation.validation.validator",{selector:"*",show:function(i,j){var h=e(i);
var g=h.adaptTo("foundation-field");
if(g&&g.setInvalid){g.setInvalid(true)
}var f=h.data("foundation-validation.internal.error");
if(f){f.content.innerHTML=j;
if(!f.parentNode){h.after(f);
f.show()
}}else{f=new c.Tooltip();
f.variant="error";
f.interaction="off";
f.placement="top";
f.target=i;
f.content.innerHTML=j;
f.open=true;
h.data("foundation-validation.internal.error",f);
h.after(f)
}},clear:function(i){var h=e(i);
var g=h.adaptTo("foundation-field");
if(g&&g.setInvalid){g.setInvalid(false)
}var f=h.data("foundation-validation.internal.error");
if(f){f.hide();
f.remove()
}}});
b.register("foundation.validation.selector",{exclusion:".foundation-field-mixed"});
b.register("foundation.validation.selector",{exclusion:".foundation-field-related"})
})(window,document,Granite.$,Coral);
(function(c,d,b){var a='%/\\:*?"[]|\n\t\r. ';
d(c).adaptTo("foundation-registry").register("foundation.validation.validator",{selector:"[data-foundation-validation~='foundation.jcr.name'],[data-validation~='foundation.jcr.name']",validate:function(g){var e=g.value;
for(var f=0,h=e.length;
f<h;
f++){if(a.indexOf(e[f])>=0||e.charCodeAt(f)>127){return b.I18n.get('Invalid character "{0}". It must be a valid JCR name.',[e[f]])
}}}})
})(window,Granite.$,Granite);
(function(h,m,e,n,l,d){var s="foundationAutocompleteCustom";
var r=e(h).adaptTo("foundation-util-propertybuilder");
function q(t){if(!t){return e.Deferred().reject().promise()
}if(t[0]==="#"){return e.when(m.querySelector(t))
}return e.ajax({url:t,cache:false}).then(function(u){return e(h).adaptTo("foundation-util-htmlparser").parse(u)
}).then(function(u){return e(u).children()[0]
})
}var j=h.navigator.userAgent.indexOf("Trident/7.0")>=0;
var k=500;
var b=9;
var p=13;
var c=27;
var i=38;
var a=40;
var o=Object.create(HTMLElement.prototype);
o.createdCallback=function(){var v=this;
this._render();
var t;
if(j){this._input.addEventListener("keydown",function(x){clearTimeout(t);
t=setTimeout(v._onUserInput.bind(v),v.delay)
})
}else{this._input.addEventListener("input",function(x){clearTimeout(t);
t=setTimeout(v._onUserInput.bind(v),v.delay)
})
}this._input.addEventListener("keydown",function(y){switch(y.keyCode){case i:case a:y.preventDefault();
clearTimeout(t);
if(v._suggestion.open){v._focus(v._suggestion,y.keyCode===i)
}else{v._onUserInput()
}break;
case c:y.preventDefault();
clearTimeout(t);
v._cancelSuggestion();
break;
case b:clearTimeout(t);
v._cancelSuggestion();
break;
case p:if(v._suggestion.open||(v.valueDisplayMode!=="inline"&&v._input.value!=="")){y.preventDefault()
}clearTimeout(t);
var x=v._input.value.trim();
if(x.length){v._appendValue(x).then(function(){v._cancelSuggestion();
v._input.value=""
})
}break
}});
this._input.addEventListener("blur",function(x){if(!v.multiple&&v.forceSelection){v._getValueAPI(function(z){var y=z.getValues();
if(y.length){v._input.value=y[0].text
}else{v._input.value=""
}})
}});
e(this).on("change","coral-taglist[foundation-autocomplete-value]",function(x){v._onValueChangeByUser()
});
e(this).on("coral-collection:remove","coral-taglist[foundation-autocomplete-value]",function(x){if(!v.classList.contains("foundation-field-mixed")){return
}var y=x.originalEvent.detail.item;
if(!y.value.startsWith("+")){v._removedValuesWhenMixed.push(y.value)
}});
e(this).on("change foundation-field-change",function(x){if(x.target!==v){x.stopImmediatePropagation()
}});
this._button.addEventListener("click",function(x){x.preventDefault();
v._togglePicker()
});
this._suggestion={el:null,open:false,api:null};
this._value={el:null,api:null};
this._picker={el:null,open:false,loading:false,api:null};
this._removedValuesWhenMixed=[];
this._setupValueObserver();
var u=this.attributes;
for(var w=0;
w<u.length;
w++){this.attributeChangedCallback(u[w].name,undefined,u[w].value)
}};
o.attributeChangedCallback=function(v,t,u){if(v==="pickersrc"){this._picker.el=null;
return
}if(v==="variant"){this._onVariantChange();
return
}if(v==="name"){this._getValueAPI(function(y){y.setName(u)
});
return
}if(v==="placeholder"){this._input.setAttribute("placeholder",u);
return
}if(v==="labelledby"){this._input.setAttribute("labelledby",u);
return
}if(v==="disabled"){var w=u!==null;
this._input.disabled=w;
this._button.disabled=w;
this._getValueAPI(function(y){y.setDisabled(w)
});
return
}if(v==="readonly"){var x=u!==null;
this._input.readOnly=x;
this._button.disabled=x;
this._getValueAPI(function(y){y.setReadOnly(x)
});
return
}if(v==="invalid"){this._input.invalid=u!==null;
return
}if(v==="required"){this._input.setAttribute("aria-required",u!==null);
return
}};
Object.defineProperties(o,{field:{get:function(){return this._input
}},delay:new r(r.createAttrBasedProperty("delay")).mix(r.integerType(k)).mix(r.positiveNumber(k)).build(),pickerSrc:r.createAttrBasedProperty("pickersrc"),valueDisplayMode:r.createAttrBasedProperty("valuedisplaymode","inline"),variant:r.createAttrBasedProperty("variant"),name:r.createAttrBasedProperty("name",""),placeholder:r.createAttrBasedProperty("placeholder",""),labelledBy:r.createAttrBasedProperty("labelledby",""),disabled:r.createBooleanAttrBasedProperty("disabled"),readOnly:r.createBooleanAttrBasedProperty("readonly"),invalid:r.createBooleanAttrBasedProperty("invalid"),required:r.createBooleanAttrBasedProperty("required"),multiple:r.createBooleanAttrBasedProperty("multiple"),forceSelection:r.createBooleanAttrBasedProperty("forceselection"),value:{get:function(){if(this.multiple){return this.values[0]
}else{return this.values[0]||""
}},set:function(t){this.values=[t]
}},values:{get:function(){return this._getValueAPI(function(t){return t.getValues().map(function(u){return u.value
})
})
},set:function(u){var t=this;
this._getValueAPI(function(w){var v=u.map(function(x){return{value:x,text:x}
});
if(t.multiple){w.setValues(v)
}else{w.setValues(v.length>0?[v[0]]:[])
}t._validate()
})
}}});
o.focus=function(){requestAnimationFrame(function(){this._input.focus()
}.bind(this))
};
o.clear=function(){this.values=[];
if(this._input){requestAnimationFrame(function(){this._input.value=""
}.bind(this))
}};
o._render=function(){for(var u=0;
u<this.children.length;
u++){var w=this.children[u];
if(w.classList.contains("foundation-autocomplete-inputgroupwrapper")){this.removeChild(w)
}}this._inputGroup=m.createElement("div");
this._inputGroup.classList.add("coral-InputGroup");
this._input=new n.Textfield();
this._input.classList.add("coral-InputGroup-input");
this._input.autocomplete="off";
this._input.placeholder=this.placeholder;
this._input.labelledBy=this.labelledBy;
var v=m.createElement("span");
v.classList.add("coral-InputGroup-button");
var t=l.I18n.get("Open Selection Dialog");
this._button=new n.Button().set({icon:"select",title:t,type:"button"});
this._button.setAttribute("aria-label",t);
v.appendChild(this._button);
this._inputGroup.appendChild(this._input);
this._inputGroup.appendChild(v);
this._inputGroupWrapper=m.createElement("div");
this._inputGroupWrapper.classList.add("foundation-autocomplete-inputgroupwrapper");
this._inputGroupWrapper.appendChild(this._inputGroup);
this.insertBefore(this._inputGroupWrapper,this.firstChild);
this._onVariantChange();
this.setAttribute("role","combobox")
};
o._setupValueObserver=function(){var v=this;
var t=[this._handleInputSize(),this._handleSingleSelectionMode()];
var w=function(){v._getValueAPI(function(){t.forEach(function(x){x.perform.call(v)
})
})
};
w();
var u=new MutationObserver(function(x){x.forEach(function(y){e(y.addedNodes).filter("[foundation-autocomplete-value]").each(function(){w()
})
})
});
u.observe(this,{childList:true})
};
o._handleInputSize=function(){var u=function(v){var x=e(this._input);
if(this.multiple&&this.valueDisplayMode==="inline"){if(v){var w=e(v).outerWidth(true);
x.css("padding-left",w)
}else{x.css("padding-left","")
}}else{x.css("padding-left","")
}}.bind(this);
var t=function(v){u(this)
};
return{perform:function(){n.commons.addResizeListener(this._value.el,t)
},destroy:function(){u();
n.commons.removeResizeListener(this._value.el,t)
}}
};
o._handleSingleSelectionMode=function(){var u=function(){var v=this._value.el.items.getAll()[0];
if(v){this._input.value=v.value
}}.bind(this);
var t;
return{perform:function(){if(!this.multiple){requestAnimationFrame(function(){u()
})
}t=new MutationObserver(function(v){if(this.multiple){return
}v.forEach(function(x){var w=e(x.addedNodes).filter("coral-tag").length;
if(w){u()
}})
}.bind(this));
t.observe(this._value.el,{childList:true})
},destroy:function(){t.disconnect()
}}
};
o._onVariantChange=function(){var t=this.variant;
if(t==="omnisearch"){this._input.variant="quiet";
this._button.variant="quiet";
this._inputGroup.classList.add("coral-InputGroup--quiet")
}else{this._input.variant=n.Textfield.variant.DEFAULT;
this._button.variant=n.Button.variant.DEFAULT;
this._inputGroup.classList.remove("coral-InputGroup--quiet")
}};
o._onUserInput=function(){var t=this;
if(!this.multiple){this._appendValue(this._input.value.trim(),true)
}var u=function(v){t._input.value=v
};
this._getSuggestionAPI(function(v){var w=this._getValueAPI(function(x){return x.getValues()
},function(){return[]
});
v.pick(t,w,t._input.value,u).then(function(x){t._suggestion.open=false;
t._input.value="";
t._input.focus();
t._setSelections(x)
},function(){t._suggestion.open=false;
t._input.focus()
});
t._suggestion.open=true
})
};
o._onValueChangeByUser=function(u){var t=this;
if(u){if(!this._deferChangeEvent){this._deferChangeEvent=true;
e(this._input).on("focusout",function v(w){if(t.contains(w.relatedTarget)){return
}e(t._input).off("focusout",v);
t._triggerChangeEvent();
t._deferChangeEvent=null
});
this._validate()
}return
}this._triggerChangeEvent();
this._validate()
};
o._triggerChangeEvent=function(){var t=m.createEvent("HTMLEvents");
t.initEvent("change",true,false);
this.dispatchEvent(t);
e(this).trigger("foundation-field-change")
};
o._getSuggestionAPI=function(v,u){if(!this._suggestion.api){var t=e(this).children("[foundation-autocomplete-suggestion]").first();
if(!t.length){if(u){return u.call(this)
}return
}this._suggestion.el=t[0];
this._suggestion.api=t.adaptTo("foundation-picker")
}return v.call(this,this._suggestion.api)
};
o._getValueAPI=function(v,u){if(!this._value.api){var t=e(this).children("[foundation-autocomplete-value]").first();
if(!t.length){if(u){return u.call(this)
}return
}this._value.el=t[0];
this._value.api=g(t[0])
}return v.call(this,this._value.api)
};
o._focus=function(t,u){if("focus" in t.api){t.api.focus(u)
}else{t.el.focus()
}};
o._validate=function(){var t=e(this).adaptTo("foundation-validation");
if(t){t.checkValidity();
t.updateUI()
}};
o._setSelections=function(v,u){var t=this;
t._getValueAPI(function(w){if(t.multiple){if(t.classList.contains("foundation-field-mixed")){w.appendValues(v.map(function(y){var x=t._removedValuesWhenMixed.indexOf(y.value);
if(x>=0){t._removedValuesWhenMixed.splice(x,1)
}else{y.value="+"+y.value
}return y
}))
}else{w.appendValues(v)
}}else{if(v.length){w.setValues([v[0]])
}else{w.setValues([])
}}t._onValueChangeByUser(u)
})
};
o._cancelSuggestion=function(){var t=this;
if(!t._suggestion.open){return
}this._getSuggestionAPI(function(u){u.cancel();
t._suggestion.open=false
})
};
o._appendValue=function(v,w){var u=this;
if(!this.multiple&&v.length===0){this._setSelections([],w);
return e.when()
}var t=e.Deferred();
this._getSuggestionAPI(function(x){x.resolve([v]).then(function(y){if(y[0]!==null){u._setSelections(y,w);
t.resolve()
}else{if(!u.forceSelection){u._setSelections([{value:v,text:v,isUserDefined:true}],w);
t.resolve()
}}})
},function(){if(u.forceSelection){return t.reject()
}u._setSelections([{value:v,text:v,isUserDefined:true}],w);
t.resolve()
});
return t.promise()
};
o._resolvePickerSrc=function(){var t=this._getValueAPI(function(v){return v.getValues()
},function(){return[]
});
var u={value:""};
if(t.length>0){u.value=t[t.length-1].value
}this._resolvedPickerSrc=d.expand(this.pickerSrc,u)
};
o._loadAndShowPicker=function(){var t=this;
this._picker.loading=true;
this._resolvePickerSrc();
q(this._resolvedPickerSrc).then(function(u){t._picker.loading=false;
t._picker.el=u;
t._picker.api=e(u).adaptTo("foundation-picker");
t._showPicker()
},function(){t._picker.loading=false
})
};
o._togglePicker=function(){if(this._picker.loading){return
}if(this._picker.el){if(this._picker.open){this._picker.api.cancel();
this._onCancelPicker()
}else{this._loadAndShowPicker()
}}else{this._loadAndShowPicker()
}};
o._showPicker=function(){var t=this;
var u=this._picker.api;
u.attach(this);
var v=this._getValueAPI(function(w){return w.getValues()
},function(){return[]
});
u.pick(this,v,this._input.value).then(function(w){t._picker.api.detach();
t._picker.open=false;
t._input.focus();
t._setSelections(w)
},function(){t._onCancelPicker()
});
this._focus(this._picker);
this._picker.open=true
};
o._onCancelPicker=function(){this._picker.api.detach();
this._picker.open=false;
this._input.focus()
};
m.registerElement("foundation-autocomplete",{prototype:o});
function g(t){return{setName:function(u){t.setAttribute("name",u)
},setDisabled:function(u){t.disabled=u
},setReadOnly:function(u){t.readOnly=u
},getValues:function(){return t.items.getAll().map(function(u){return{value:u.value,text:u.label.textContent,isUserDefined:u.hasAttribute("data-foundation-autocomplete-value-userdefined")}
})
},setValues:function(u){t.items.clear();
this.appendValues(u)
},appendValues:function(u){u.forEach(function(x){var v=new n.Tag().set({closable:true,value:x.value,label:{textContent:x.text}});
if(x.isUserDefined){v.setAttribute("data-foundation-autocomplete-value-userdefined","")
}if(x.data){for(var w in x.data){if(x.data.hasOwnProperty(w)){var z=w;
var y=w.charAt(0);
if(y!==y.toUpperCase()){z=y.toUpperCase();
if(w.length>1){z+=w.substr(1)
}}v.dataset[s+z]=x.data[w]
}}}t.items.add(v)
})
}}
}var f=e(h).adaptTo("foundation-registry");
f.register("foundation.adapters",{type:"foundation-overlay-anchor",selector:"foundation-autocomplete",adapter:function(t){return{getElement:function(){return t._inputGroupWrapper
}}
}});
f.register("foundation.validation.selector",{submittable:"foundation-autocomplete",candidate:"foundation-autocomplete:not([readonly]):not([disabled])",exclusion:"foundation-autocomplete *"});
f.register("foundation.validation.validator",{selector:"foundation-autocomplete",validate:function(t){if(!t.required){return
}if(t.multiple&&t.values.length===0){return l.I18n.get("Please fill out this field.")
}else{if(!t.multiple&&t.value.length===0){return l.I18n.get("Please fill out this field.")
}}}});
f.register("foundation.adapters",{type:"foundation-field",selector:"foundation-autocomplete",adapter:function(u){var t=e(u);
return{getName:function(){return u.name
},setName:function(v){t.children(".foundation-field-related").each(function(){if(this.name.startsWith(u.name+"@")){this.name=v+this.name.substring(u.name.length)
}});
u.name=v
},isDisabled:function(){return u.disabled
},setDisabled:function(v){u.disabled=v;
t.children(".foundation-field-related:not(.foundation-field-mixed-patchcontrol)").prop("disabled",v)
},isInvalid:function(){return u.invalid
},setInvalid:function(v){u.invalid=v
},isRequired:function(){return u.required
},setRequired:function(v){u.required=v
},getValue:function(){return u.value
},setValue:function(v){u.value=v
},getLabelledBy:function(){return u.labelledBy
},setLabelledBy:function(v){u.labelledBy=v
},getValues:function(){return u.values
},setValues:function(v){u.values=v
},clear:function(){u.clear()
}}
}});
f.register("foundation.form.submit",{selector:"*",handler:function(u){var t=[];
e(u).find("foundation-autocomplete.foundation-field-mixed").each(function(){var v=this;
v._removedValuesWhenMixed.forEach(function(x){var w=m.createElement("input");
w.type="hidden";
w.name=v.name;
w.value="-"+x;
v.appendChild(w);
t.push(function(){v.removeChild(w)
})
});
t.push(function(){v._removedValuesWhenMixed=[]
})
});
return{post:function(){t.forEach(function(v){v()
});
return e.when()
}}
}})
})(window,document,Granite.$,Coral,Granite,Granite.URITemplate);
(function(a,b){b(a).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-collection",selector:".foundation-collection",adapter:function(c){var d=b(c);
return{append:function(e){d.append(e);
d.trigger("foundation-contentloaded")
},clear:function(){d.find(".foundation-collection-item").remove()
}}
}})
})(window,Granite.$);
(function(a,b){b(a).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-selections",selector:".foundation-collection",adapter:function(c){var d=b(c);
return{count:function(){return d.find(".foundation-selections-item").length
},clear:function(e){var f=d.find(".foundation-selections-item").removeClass("foundation-selections-item").length;
if(!e&&f){d.trigger("foundation-selections-change")
}return this
},select:function(e){var f=b(e);
if(!f.is(".foundation-collection-item")){return
}f.toggleClass("foundation-selections-item",true);
d.trigger("foundation-selections-change")
},deselect:function(e){var f=b(e);
if(!f.is(".foundation-collection-item")){return
}f.toggleClass("foundation-selections-item",false);
d.trigger("foundation-selections-change")
}}
}})
})(window,Granite.$);
(function(b,a,c){c(a).on("foundation-selections-change",".foundation-collection[role=listbox]",function(f){var g=c(this);
g.find(".foundation-collection-item").each(function(){var j=c(this);
var i=j.is(".foundation-selections-item");
j.attr("aria-selected",i);
if(g.hasClass("aria-skiphandling")){return
}var e=j.find("input.aria-value[type=hidden]");
e.prop("disabled",!i);
var h=g.data("aria-name");
if(h&&!e.prop("name")){e.prop("name",h)
}if(e.length&&b.console){console.log("@deprecated .aria-value, [data-aria-name]; please use .foundation-advancedselect instead.")
}});
var d=g.adaptTo("foundation-validation");
if(d){d.checkValidity();
d.updateUI()
}})
})(window,document,Granite.$);
(function(g,e,d){function f(l,k){if(k){l.removeClass("foundation-collection-action-hidden")
}else{l.addClass("foundation-collection-action-hidden")
}}function j(k,l){if(l===0&&k===0){return true
}if(l>0&&k===">0"){return true
}return false
}function i(l,k){if(k===0&&l==="none"){return true
}if(k===1&&l==="single"){return true
}if(k>=1&&l==="multiple"){return true
}return false
}function c(o,q,n,m){if(m==="none"){return true
}if(m==="item"){var l=n.toArray().map(function(t){var s=e(t).find(".foundation-collection-quickactions").data("foundationCollectionQuickactionsRel")||"";
s=s.trim();
return s.length?s.split(/\s+/):[]
});
var p=l.every(function(s){return s.length===0
});
if(p){return true
}return l.every(function(s){return !s.every(function(t){return !o.hasClass(t)
})
})
}else{var k=q.adaptTo("foundation-collection-meta");
if(!k){return true
}var r=k.getRelationship()||"";
r=r.trim();
var l=r.length?r.split(/\s+/):[];
if(l.length===0){return true
}return l.some(function(s){return o.hasClass(s)
})
}}function h(p,m,q,l,o){var k=true;
if("activeCount" in m){k=j(m.activeCount,l.length)
}if(k&&"activeSelectionCount" in m){k=i(m.activeSelectionCount,o.length)
}if(k&&"activeCondition" in m){d.UI.Foundation.Utils.everyReverse(a.get("foundation.collection.action.activecondition"),function(s){if(s.name!==m.activeCondition){return true
}var r=s.handler.call(p[0],s.name,p[0],m,q[0],o.toArray());
if(r===false||r===true){k=r;
return false
}return true
})
}if(k){var n=m.ignoreRel?"none":(m.relScope||"item");
k=c(p,q,o,n)
}return k
}function b(m,l){var n=l.target;
if(!n){var k=m.closest(".foundation-collection-actionbar");
if(k.length){n=k[0].dataset.foundationCollectionActionbarTarget
}}return n
}e(g).on("foundation-contentloaded",function(l){var k=new Map();
e(".foundation-collection-action:not(.foundation-collection-item .foundation-collection-action)",l.target).each(function(){var p=e(this);
var n=p.data("foundationCollectionAction")||{};
var r=b(p,n);
if(!r){return
}var s;
var m;
var o;
if(k.has(r)){var q=k.get(r);
s=q.collection;
m=q.items;
o=q.selections
}else{s=e(r);
m=s.find(".foundation-collection-item");
o=m.filter(".foundation-selections-item");
k.set(r,{collection:s,items:m,selections:o})
}if(!s.length){return
}f(p,h(p,n,s,m,o))
})
});
e(g).on("foundation-selections-change",".foundation-collection",function(m){var n=e(this);
var k;
var l;
e(".foundation-collection-action:not(.foundation-collection-item .foundation-collection-action)").each(function(){var p=e(this);
var o=p.data("foundationCollectionAction")||{};
var q=b(p,o);
if(!q||!n.is(q)){return
}if(!k){k=n.find(".foundation-collection-item");
l=k.filter(".foundation-selections-item")
}f(p,h(p,o,n,k,l))
})
});
var a=e(window).adaptTo("foundation-registry");
e(g).on("click",".foundation-collection-action",function(p){var n=e(this);
var l=n.data("foundationCollectionAction");
if(!l||!l.action){return
}var o=e();
var k=[];
var r=n.data("foundationCollectionItem");
if(r){o=e(r).closest(".foundation-collection");
k=[r]
}else{if(l.target){o=e(l.target);
k=o.find(".foundation-selections-item").toArray()
}else{var m=n.closest(".foundation-collection-item, .foundation-collection-actionbar");
if(m.hasClass("foundation-collection-actionbar")){var q=m;
o=e(q[0].dataset.foundationCollectionActionbarTarget);
k=o.find(".foundation-selections-item").toArray()
}else{if(m.hasClass("foundation-collection-item")){var s=m;
o=s.closest(".foundation-collection");
k=s.toArray()
}}}}d.UI.Foundation.Utils.everyReverse(a.get("foundation.collection.action.action"),function(u){if(u.name!==l.action){return true
}var t=u.handler.call(n[0],u.name,n[0],l,o[0],k)===false;
if(!t){p.preventDefault()
}return t
})
})
})(document,Granite.$,Granite);
(function(a,b,c){b(a).adaptTo("foundation-registry").register("foundation.collection.action.action",{name:"foundation.link",handler:function(f,h,e,i,g){var d=c.expand(e.data.href,{id:i.dataset.foundationCollectionId,item:g.map(function(j){return j.dataset.foundationCollectionItemId
})});
if(e.data.target){a.open(d,e.data.target)
}else{a.location=d
}}})
})(window,Granite.$,Granite.URITemplate);
(function(a,b,c){b(a).adaptTo("foundation-registry").register("foundation.collection.action.action",{name:"foundation.pushstate",handler:function(g,j,f,k,i){var d=b(".foundation-content").adaptTo("foundation-content");
if(d){var h=i.map(function(l){return b(l).data("foundation-collection-item-id")
});
var e=c.expand(f.data.href,{item:h});
d.pushState(f.data.data,f.data.title,e)
}}})
})(window,Granite.$,Granite.URITemplate);
(function(d,a,e,g){var b=new Map();
var c="."+Date.now();
function f(j,l,i){if(l){var k;
if(b.has(l)){k=e.Deferred().resolve(b.get(l)).promise()
}else{k=e.ajax({url:l,cache:false})
}return k.then(function(m){var n=e(m).on("foundation-toggleable-hide",function(p){var o=e(p.target);
requestAnimationFrame(function(){o.detach()
})
}).appendTo(a.body).trigger("foundation-contentloaded");
b.set(l,m);
return n
})
}var h;
if(i){h=e(i)
}else{h=j.closest(".foundation-toggleable")
}return e.Deferred().resolve(h).promise()
}e(d).adaptTo("foundation-registry").register("foundation.collection.action.action",{name:"foundation.dialog",handler:function(i,j,l,o,k){var n=e(j);
var p=l.data.target;
var m=l.data.nesting;
var h;
if(l.data.src){h=g.expand(l.data.src,{id:o.dataset.foundationCollectionId,item:k.map(function(q){return q.dataset.foundationCollectionItemId
})})
}f(n,h,p).then(function(q){var r=q.adaptTo("foundation-toggleable");
q.off(c).one("foundation-form-submitted"+c,function(t,v,u){if(!v){return
}r.hide();
var s=e(o).adaptTo("foundation-collection");
if("reload" in s){s.reload()
}});
requestAnimationFrame(function(){if(m==="hide"){var s=n.closest(".foundation-toggleable").adaptTo("foundation-toggleable");
if(s){s.hide()
}}r.show(j)
})
})
}})
})(window,document,Granite.$,Granite.URITemplate);
(function(a,b){b(a).on("click",".foundation-collection-item-activator",function(g){var f=b(this);
var d=f.closest(".foundation-collection-item");
var c=d.closest(".foundation-collection").adaptTo("foundation-selections");
c.select(d[0])
})
})(document,Granite.$);
(function(a,b){b(a).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-collection-item-action",selector:".foundation-collection",adapter:function(c){var d=b(c);
return{execute:function(f){var h;
if(b(f).hasClass("foundation-collection-navigator")){h=f
}else{h=f.querySelector(".foundation-collection-navigator")
}if(!h){return
}var e=h.dataset.foundationCollectionNavigatorHref;
var i=h.dataset.foundationCollectionNavigatorTarget;
if(e&&i){a.open(e,i)
}else{if(e){a.location=e
}else{var g=d.adaptTo("foundation-collection");
g.load(f.dataset.foundationCollectionItemId)
}}}}
}})
})(window,Granite.$);
(function(a,b){b(a).on("foundation-selections-change",".foundation-collection-masterdetail",function(i){var h=b(this);
var g=this.dataset.foundationCollectionMasterdetailTarget;
var d=b(g);
if(!d.length){return
}var f=h.find(".foundation-selections-item").first();
if(!f.length){return
}var c=d.adaptTo("foundation-collection");
c.load(f[0].dataset.foundationCollectionItemId)
})
})(document,Granite.$);
(function(a,b){b(a).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-toggleable",selector:".foundation-toggleable",adapter:function(d){var c=b(d);
return{isOpen:function(){return c.attr("hidden")===undefined
},show:function(e){c.removeAttr("hidden");
c.trigger("foundation-toggleable-show")
},hide:function(){c.attr("hidden","");
c.trigger("foundation-toggleable-hide")
}}
}})
})(window,Granite.$);
(function(a,d){var b=new Map();
function e(h){var i=h.data("foundationToggleableControlSrc");
var g=h.data("foundationToggleableControlTarget");
if(i){if(b.has(i)){var f=b.get(i);
f.appendTo(a.body);
return d.Deferred().resolve(f).promise()
}return d.ajax({url:i,cache:false}).then(function(j){var k=d(j).on("foundation-toggleable-hide",function(m){var l=d(m.target);
requestAnimationFrame(function(){l.detach()
})
}).appendTo(a.body).trigger("foundation-contentloaded");
b.set(i,k);
return k
})
}var f;
if(g){f=d(g)
}else{f=h.closest(".foundation-toggleable")
}return d.Deferred().resolve(f).promise()
}function c(h,g){var f=h.attr("data-foundation-tracking-event");
if(!f){return
}var i=JSON.parse(f);
i.feature=i.feature||"";
i.type="toggleable";
i.action=g;
i.widget={name:i.element,type:"toggleable"};
d(window).adaptTo("foundation-tracker").trackEvent(i)
}d(a).on("click",".foundation-toggleable-control",function(g){g.preventDefault();
var f=d(this);
e(f).then(function(h){var i=h.adaptTo("foundation-toggleable");
var j=f.data("foundationToggleableControlAction");
requestAnimationFrame(function(){if(j===undefined){if(i.isOpen()){j="hide"
}else{j="show"
}}c(f,j);
if(j==="show"){if(f.data("foundationToggleableControlNesting")==="hide"){var k=f.closest(".foundation-toggleable").adaptTo("foundation-toggleable");
if(k){k.hide()
}}i.show(f[0])
}else{if(j==="hide"){i.hide()
}}})
})
});
d(window).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-tracking-event",selector:".foundation-toggleable-control[data-foundation-tracking-event]",adapter:function(f){return{track:function(g){}}
}})
})(document,Granite.$);
(function(a,b){b(a).on("click",".foundation-mode-change",function(f){f.preventDefault();
var c=b(this);
var g=c.data("foundationModeValue");
var d=c.data("foundationModeGroup");
c.trigger("foundation-mode-change",[g,d])
})
})(document,Granite.$);
(function(a,b){b(a).on("foundation-mode-change",function(d,f,c){b(".foundation-mode-switcher").each(function(){var e=b(this);
var g=e.data("foundationModeSwitcherGroup");
if(g!==c){return
}e.children(".foundation-mode-switcher-item").each(function(){var i=b(this);
var h=i.data("foundationModeSwitcherItemMode");
i.toggleClass("foundation-mode-switcher-item-active",h===f)
})
})
})
})(document,Granite.$);
(function(d,a,f){var e=f(d).adaptTo("foundation-ui");
var c=new WeakMap();
function b(g){e.prompt(Granite.I18n.get("Unsaved changes"),Granite.I18n.get("You have unsaved changes! Are you are sure you want to close the page?"),"warning",[{text:Granite.I18n.get("Cancel")},{text:Granite.I18n.get("Yes"),primary:true,handler:function(){d.location=g.getAttribute("href")
}}])
}f(a).on("foundation-contentloaded",function(g){f("[data-foundation-command]",g.target).each(function(h,i){var j=i.dataset.foundationCommand;
if(j&&c.get(i)!==true){c.set(i,true);
Coral.keys.on(j,function(k){f(i).click()
})
}})
});
f(a).on("click",".foundation-anchor",function(j){j.preventDefault();
var h=this;
var g=h.dataset.foundationAnchorHref;
var i=h.dataset.foundationAnchorTarget;
if(i){d.open(g,i)
}else{d.location=g
}});
f(a).on("click",".foundation-backanchor",function(j){var g=this;
var h=g.dataset.foundationBackanchorForm;
if(h){var i=f("#"+h).adaptTo("foundation-form");
if(i&&i.isDirty()){j.preventDefault();
b(g)
}}else{f("form.foundation-form").each(function(){if(f(this).adaptTo("foundation-form").isDirty()){j.preventDefault();
b(g);
return false
}})
}})
})(window,document,Granite.$);
(function(e,b,f){var h=e.location.href;
var g;
var c=new WeakMap();
function a(l){var n=l.prop("id");
if(!n){return
}var k=l[0].dataset.foundationFixedanchorAttr||"href";
if(g.has(n)){var i=g.get(n);
l.attr(k,i.href)
}try{var j="foundation-fixedanchor::"+n;
sessionStorage.setItem(j,JSON.stringify({url:h,id:n,href:l.attr(k)}))
}catch(m){if(e.console){console.warn("Error occur saving foundation-fixedanchor state",m)
}}}function d(){if(g){return
}g=new Map();
if(e!==e.parent){return
}try{var j=[];
for(var l=0,m=sessionStorage.length;
l<m;
l++){var k=sessionStorage.key(l);
if(!k||!k.startsWith("foundation-fixedanchor::")){continue
}var n=JSON.parse(sessionStorage.getItem(k));
if(n.url===h){g.set(n.id,n)
}j.push(k)
}j.forEach(function(i){sessionStorage.removeItem(i)
})
}catch(o){if(e.console){console.warn("Error occur restoring foundation-fixedanchor state",o)
}}}f(b).on("foundation-contentloaded",function(i){d();
f(".foundation-fixedanchor",i.target).each(function(){var j=f(this);
if(c.has(this)){return
}c.set(this,true);
a(j)
})
})
})(window,document,Granite.$);
(function(b,c){var a=c(b).adaptTo("foundation-registry");
a.register("foundation.adapters",{type:"foundation-editable",selector:".foundation-editable",adapter:function(e){var d=c(e);
return{edit:function(){var f;
Granite.UI.Foundation.Utils.everyReverse(a.get("foundation.editable.editor"),function(i){if(!d.is(i.selector)){return true
}f=i.handler.call(d[0],d[0]);
return false
});
if(!f){return
}var h=d.position();
var g=c(document.createElement("div")).css({position:"absolute",top:h.top,left:h.left,width:d.css("width")});
g.append(f.el);
g.insertAfter(d);
f.renderCallback();
d.on("foundation-editable-commit foundation-editable-cancel",function(i){g.remove()
})
}}
}})
})(window,Granite.$);
(function(d,e,c){var a=13;
var b=27;
e(d).adaptTo("foundation-registry").register("foundation.editable.editor",{selector:".foundation-editable[data-foundation-editable-editor='foundation.text']",handler:function(h){var f=e(h);
var g=e(new c.Textfield()).css({display:"block",width:"100%"});
var j=function(){f.text(g.val());
f.trigger("foundation-editable-commit")
};
var i=function(){f.trigger("foundation-editable-cancel")
};
g.on("blur",function(k){j()
}).on("keydown",function(k){if(k.which===a){k.preventDefault();
j()
}else{if(k.which===b){k.preventDefault();
i()
}}});
g.val(f.text());
return{el:g[0],renderCallback:function(){g.focus()
}}
}})
})(window,Granite.$,Coral);
(function(a,d){var b=13;
function c(f){var e=f.adaptTo("foundation-editable");
e.edit()
}d(a).on("click",".foundation-editable-control",function(f){f.preventDefault();
c(d(this))
});
d(a).on("keydown",".foundation-editable-control",function(f){if(f.which!==b){return
}f.preventDefault();
c(d(this))
})
})(document,Granite.$);
(function(a,b){b(a).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-wizard",selector:".foundation-wizard",adapter:function(c){var d=b(c);
return{toggleNext:function(e){this.toggle("next",e)
},togglePrev:function(e){this.toggle("prev",e)
},toggleCancel:function(e){this.toggle("cancel",e)
},toggle:function(h,e){var f=d.adaptTo("foundation-layout");
if(f&&typeof f.toggle==="function"){f.toggle(h,e);
return
}var g=d.children(".foundation-wizard-step.foundation-wizard-step-active").find(".foundation-wizard-control[data-foundation-wizard-control-action="+h+"]");
g.each(function(){if(b(this).is("button")){b(this).prop("disabled",!e)
}else{b(this).toggleClass("disabled",!e)
}})
},next:function(){var f=d.adaptTo("foundation-layout");
if(f&&typeof f.next==="function"){f.next();
return
}var g=d.children(".foundation-wizard-step-active");
var e=g.nextAll(".foundation-wizard-step").first();
if(!e.length){return
}g.removeClass("foundation-wizard-step-active");
e.addClass("foundation-wizard-step-active");
d.trigger("foundation-wizard-stepchange",[e[0],g[0]])
},prev:function(){var e=d.adaptTo("foundation-layout");
if(e&&typeof e.prev==="function"){e.prev();
return
}var g=d.children(".foundation-wizard-step-active");
var f=g.prevAll(".foundation-wizard-step").first();
if(!f.length){return
}g.removeClass("foundation-wizard-step-active");
f.addClass("foundation-wizard-step-active");
d.trigger("foundation-wizard-stepchange",[f[0],g[0]])
},append:function(e,f){var g=d.adaptTo("foundation-layout");
if(g&&typeof g.append==="function"){g.append(e,f);
return
}if(f===undefined){d.append(e);
return
}d.children(".foundation-wizard-step").eq(f).after(e);
d.trigger("foundation-contentloaded")
},appendAfter:function(f,e){var g=d.adaptTo("foundation-layout");
if(g&&typeof g.appendAfter==="function"){g.appendAfter(f,e);
return
}b(e).after(f);
d.trigger("foundation-contentloaded")
},remove:function(e){var f=d.adaptTo("foundation-layout");
if(f&&typeof f.remove==="function"){f.remove(e);
return
}b(e).remove()
},getPrevSteps:function(f){var e=d.adaptTo("foundation-layout");
if(e&&typeof e.getPrevSteps==="function"){return e.getPrevSteps(f)
}return b(f).prevAll(".foundation-wizard-step").toArray()
}}
}})
})(window,Granite.$);
(function(a,e){function d(g,f){var h=g.closest(".foundation-wizard").adaptTo("foundation-wizard");
h.toggleNext(f)
}function b(g){var f=g.adaptTo("foundation-validation-helper").isValid();
g.data("foundation-wizard-step.internal.valid",f);
d(g,f)
}function c(h,i){var g="foundation-wizard.internal.invalids";
var f=h.data(g);
if(f===undefined){f=[];
h.data(g,f)
}if(f.indexOf(i)<0){f.push(i)
}}e(a).on("foundation-validation-invalid",".foundation-wizard-step",function(g){var f=e(this);
if(f.data("foundationWizardStepValidation")===false){return
}d(f,false);
c(f,g.target)
});
e(a).on("foundation-validation-valid",".foundation-wizard-step",function(m){var k=e(this);
if(k.data("foundationWizardStepValidation")===false){return
}var f=k.data("foundation-wizard.internal.invalids");
if(!f){b(k);
return
}var h=f.indexOf(m.target);
if(h>=0){f.splice(h,1)
}if(f.length===0){b(k);
return
}var l=false;
var g=f.length;
while(g--){if(k.has(f[g]).length){l=true;
break
}f.splice(g,1)
}if(!l){b(k)
}})
})(document,Granite.$);
(function(a,c,d){function b(e){var f={};
e.find(":input").each(function(){var g=c(this);
g.serializeArray().forEach(function(i){var j=i.name;
var l=i.value;
var n;
if(f.hasOwnProperty(j)){var h=f[j];
if(!Array.isArray(h)){h=[h]
}h.push(l);
n=h
}else{n=l
}f[j]=n;
var k=g[0].dataset.foundationUritemplateParent;
if(k){var m=f[k]=f[k]||{};
m[j]=f[j]
}})
});
return f
}c(a).on("foundation-wizard-stepchange",function(m,p,i){var h=c(p);
if(!h.hasClass("foundation-wizard-lazycontainer")){return
}var f=p.dataset.foundationWizardLazycontainerSrc;
if(!f){return
}var n=c(m.target);
var k=n.adaptTo("foundation-wizard");
var j=c(k.getPrevSteps(p));
if(j.length&&i&&!j.is(i)){return
}var q=b(j);
var g=d.expand(f,q);
var r="foundation-wizard-lazycontainer.internal.lastURL";
var l=h.data(r);
if(l===g){return
}h.data(r,g);
var o=c(window).adaptTo("foundation-ui");
o.wait();
c.ajax({url:g,cache:false}).done(function(e){var s=c(window).adaptTo("foundation-util-htmlparser");
s.parse(e).then(function(t){o.clearWait();
h.html("").append(t);
h.trigger("foundation-contentloaded");
h.adaptTo("foundation-validation-helper").getSubmittables().every(function(u){var w=c(u).adaptTo("foundation-validation");
var x=w.getValidity();
if(!x.isValidated()){return w.checkValidity()
}return true
})
})
}).fail(function(){o.clearWait();
var s=Granite.I18n.get("Error");
var e=Granite.I18n.get("Something went wrong.");
o.alert(s,e,"error")
})
})
})(document,Granite.$,Granite.URITemplate);
(function(r,j,f,q){var m=q.UI.Foundation.Utils.everyReverse;
var h=f(j).adaptTo("foundation-registry");
var o=f(j).adaptTo("foundation-ui");
var n=new WeakMap();
var g={show:function(v,w){o.wait(w)
},hide:function(v,w){o.clearWait()
}};
function s(v,w){return w.done(function(){n["delete"](v[0])
}).done(b(v)).fail(t(v)).done(function(){v.trigger("foundation-form-submitted",[true,w])
}).fail(function(){v.trigger("foundation-form-submitted",[false,w])
})
}function e(v,w){f.when.apply(null,w).done(function(){n["delete"](v[0])
}).done(function(){var z=v.data("foundationFormOutputReplace");
var y=false;
if(z){y=true
}else{z=v.data("foundationFormOutputPush")
}if(!z){return
}var x={name:"foundation.content",redirect:v.data("foundationFormRedirect"),history:v.data("foundationFormHistory"),target:z,replace:y};
m(h.get("foundation.form.response.ui.success"),function(A){if(A.name!==x.name){return true
}return A.handler.call(v[0],v[0],x)===false
})
}).fail(t(v)).done(function(){}).fail(function(){})
}function b(v){return function(z,x,D){var y=v.data("foundationFormResponseUiSuccess")||v.children(".foundation-form-response-ui-success").data("foundationFormResponseUiSuccess");
if(!y){var C=v.data("foundationFormOutputReplace");
var w=false;
if(C){w=true
}else{C=v.data("foundationFormOutputPush")
}if(!C){return
}y={name:"foundation.content",redirect:v.data("foundationFormRedirect"),history:v.data("foundationFormHistory"),target:C,replace:w}
}var A=f(j).adaptTo("foundation-response-parser").parse(D);
var E=p(v,D,A)||z;
var B=f(v).adaptTo("foundation-form-handle-tracking");
B.trackFormSubmit(v);
m(h.get("foundation.form.response.ui.success"),function(F){if(F.name!==y.name){return true
}return F.handler.call(v[0],v[0],y,E,x,D,A)===false
})
}
}function t(v){return function(A,w,y){if(v.data("foundationFormUi")==="none"){return
}var x=f(j).adaptTo("foundation-response-parser").parse(A);
var z=p(v,A,x);
m(h.get("foundation.form.response.ui.error"),function(B){return B.handler.call(v[0],v[0],z,A,w,y)===false
})
}
}function p(w,y,x){var z=y.getResponseHeader("content-type");
if(!z){return y.responseText
}var v;
m(h.get("foundation.form.response.parser"),function(B){if(!w.is(B.selector)){return true
}if(!z.match(B.contentType)){return true
}var A=B.handler.call(w[0],w[0],y,x);
if(A===false){return true
}v=A;
return false
});
return v
}function d(y){var w=y.data("foundationFormLoadingmask");
if(w===true){var v=f();
var z=y.data("foundationFormOutputReplace")||y.data("foundationFormOutputPush");
if(z){v=f(z)
}var x=g;
x.show(y[0],v[0]);
y.data("foundation-form.internal.currentLoadingMask",{target:v[0],impl:x})
}}function c(w){var v=w.data("foundation-form.internal.currentLoadingMask");
if(v){v.impl.hide(w[0],v.target);
w.removeData("foundation-form.internal.currentLoadingMask")
}}function i(v,w){v.each(function(){var x=f(this).adaptTo("foundation-field");
if(x){x.setDisabled(w)
}})
}function u(v){return v.reduce(function(w,x){if(x.post){return w.concat(x.post())
}else{return w
}},[])
}function k(w){if(w.data("foundationFormActions")){var v=w.attr("action");
var z=w.data("foundationFormActions").split(" ");
var x=[];
z.forEach(function(A){w.prop("action",A);
var B=w.adaptTo("foundation-form").submitAsync();
B.always(function(){w.attr("action",v)
});
x.push(B)
});
return function(){e(w,x)
}
}else{var y=w.adaptTo("foundation-form").submitAsync();
return function(){return s(w,y)
}
}}function a(x){d(x);
var v=[];
h.get("foundation.form.submit").forEach(function(y){if(!x.is(y.selector)){return
}v.push(y.handler.call(x[0],x[0]))
});
var w=v.reduce(function(y,z){if(z.preResult){return y.concat(z.preResult)
}else{return y
}},[]);
return f.when.apply(null,w).then(function(){var y=k(x);
return f.when.apply(null,u(v)).then(y,y)
}).always(function(){c(x)
})
}f(r).on("foundation-form-submit-callback","form.foundation-form",function(v,w){s(f(this),w)
});
f(r).on("reset","form.foundation-form",function(v){f(this).adaptTo("foundation-form").reset(true)
});
f(r).on("foundation-field-change","form.foundation-form",function(v){n.set(this,true)
});
var l=new WeakMap();
f(r).on("submit","form.foundation-form",function(x){var w=f(this);
if(w.data("foundationFormAjax")){x.preventDefault();
if(!w.data("foundationFormDisable")){if(!l.has(w[0])){l.set(w[0],[])
}var v=l.get(w[0]);
v.push(function(){a(w).always(function(){v.shift();
if(v.length){v[0]()
}})
});
if(v.length===1){v[0]()
}}}});
h.register("foundation.adapters",{type:"foundation-form",selector:"form.foundation-form",adapter:function(w){var x=f(w);
var v=function(z){var y=z.adaptTo("foundation-field");
if(y&&y.reset){y.reset()
}};
return{submitAsync:function(){var A=x.attr("enctype");
var C=x.attr("method")||"get";
var z=x.attr("action");
var y=C.toLowerCase()==="post";
if(y&&A==="multipart/form-data"){var B=new FormData(x[0]);
return f.ajax({method:C,url:z,contentType:false,mimeType:A,processData:false,data:B})
}return f.ajax({method:C,url:z,contentType:A,data:x.serialize(),cache:false})
},reset:function(y){if(!y){w.reset()
}x.find(".foundation-field-editable").each(function(){var z=f(this);
v(z.find(".foundation-field-readonly"));
v(z.find(".foundation-field-edit"))
})
},isDirty:function(){return n.get(w)===true
}}
}});
h.register("foundation.form.submit",{selector:"*",handler:function(w){var v=f(w).find(".foundation-field-mixed");
i(v,true);
return{post:function(){i(v,false)
}}
}})
})(document,window,Granite.$,Granite);
(function(a,b,c){c(b).adaptTo("foundation-registry").register("foundation.form.response.parser",{name:"foundation.sling",selector:"*",contentType:/text\/html/,handler:function(d,f,e){var g=c(e);
if(!g.find("#Status").length){return false
}return Array.prototype.reduce.call(g.find("[id]"),function(i,h){if(h.href){i[h.id]=h.href
}else{i[h.id]=h.textContent
}return i
},{})
}})
})(document,window,Granite.$);
(function(a,b,c){c(b).adaptTo("foundation-registry").register("foundation.form.response.parser",{name:"foundation.form",selector:"*",contentType:/text\/html/,handler:function(e,g,f){var h=c(f);
var d=h.find(".foundation-form-response-status-code").next().text();
if(!d){return false
}return{statusCode:d,message:h.find(".foundation-form-response-status-message").next().text(),redirect:h.find(".foundation-form-response-redirect").attr("href"),path:h.find(".foundation-form-response-path").next().text(),title:h.find(".foundation-form-response-title").next().text(),description:h.find(".foundation-form-response-description").next().html()}
}})
})(document,window,Granite.$);
(function(a,b){b(a).adaptTo("foundation-registry").register("foundation.form.response.ui.error",{name:"foundation.default",handler:function(e,g,j,c,h){var i=c||Granite.I18n.get("Error");
var d=h||Granite.I18n.get("Fail to submit the form.");
var f=b(a).adaptTo("foundation-ui");
f.alert(i,d,"error")
}})
})(window,Granite.$);
(function(b,c,a){c(b).adaptTo("foundation-registry").register("foundation.form.response.ui.error",{name:"foundation.sling",handler:function(f,h,k,d,i){if(!h||!h.Status){return false
}var j=a.I18n.get("Error");
var e=h.Message;
var g=c(b).adaptTo("foundation-ui");
g.alert(j,e,"error")
}})
})(window,Granite.$,Granite);
(function(a,b){b(a).adaptTo("foundation-registry").register("foundation.form.response.ui.error",{name:"foundation.html",handler:function(e,g,j,c,h){if(!g||!g.statusCode){return false
}var i=g.title||Granite.I18n.get("Error");
var d=g.description||g.message;
var f=b(a).adaptTo("foundation-ui");
f.alert(i,d,"error")
}})
})(window,Granite.$);
(function(c,d){function a(e,g){var f;
if(e.lastIndexOf("?")>=0){f="&"
}else{f="?"
}return e+f+g
}function b(j,h,i){var f=d(h.target);
var e=f.adaptTo("foundation-content");
if(!e){f.html(i);
return
}var k;
if(h.history){var g=h.history.url||h.history.useFormUrl?a(j.attr("action"),j.serialize()):undefined;
k={data:h.history.data,title:h.history.title,url:g}
}if(h.replace){e.replace(i,k)
}else{e.push(i,k)
}}d(c).adaptTo("foundation-registry").register("foundation.form.response.ui.success",{name:"foundation.content",handler:function(f,e,h,j,i){if(!e.target){return
}var g=d(f);
if(e.redirect){d.ajax({url:e.redirect,cache:false}).done(function(k){b(g,e,k)
})
}else{b(g,e,h)
}}})
})(window,Granite.$);
(function(b,c,d){function a(e,f){if(!e||e[0]!=="/"){return
}if(f){b.open(e)
}else{b.location=e
}}c(b).adaptTo("foundation-registry").register("foundation.form.response.ui.success",{name:"foundation.prompt.open",handler:function(f,e,h,j,i){var g=c(b).adaptTo("foundation-ui");
g.prompt(e.title,e.message,"success",[{text:Granite.I18n.get("Done"),handler:function(){a(d.expand(e.redirect,h))
}},{text:Granite.I18n.get("Open"),primary:true,handler:function(){a(d.expand(e.open,h),true);
a(d.expand(e.redirect,h))
}}])
}})
})(window,Granite.$,Granite.URITemplate);
(function(b,c,d){function a(f){var g=document.location.host,i=document.location.protocol,h="//"+g,e=i+h;
return(f===e||f.slice(0,e.length+1)===e+"/")||(f===h||f.slice(0,h.length+1)===h+"/")||!(/^(\/\/|http:|https:).*/.test(f))
}c(b).adaptTo("foundation-registry").register("foundation.form.response.ui.success",{name:"foundation.redirect",handler:function(g,f,h,j,i){var e=d.expand(f.href,h);
if(a(e)){b.location=e
}}})
})(window,Granite.$,Granite.URITemplate);
(function(b,c,a){c(b).adaptTo("foundation-registry").register("foundation.form.response.ui.success",{name:"foundation.reload",handler:function(e,d,g,i,h){var f=c(b).adaptTo("foundation-util-messenger");
f.put(null,d.message||a.I18n.get("The form has been submitted successfully"),"success");
b.location.reload()
}})
})(window,Granite.$,Granite);
(function(a,b){b(a).on("foundation-field-change",".foundation-field-autosubmit",function(f){var d=b(this).closest("form");
if(d.length){var c=a.createEvent("Event");
c.initEvent("submit",true,true);
d[0].dispatchEvent(c)
}})
})(document,Granite.$);
(function(i,j,d,g,b){function c(m){var k=[m];
var l=0;
return{current:function(){return this.peek(0)
},peek:function(n){return k[l+n]
},pointToToken:function(o){for(var n=0,p=k.length;
n<p;
n++){var q=k[n];
if(q.token===o){l=n;
return q
}}},forward:function(){if(l<k.length-1){return k[++l]
}},back:function(){if(l>0){return k[--l]
}},push:function(n){k.splice(++l,k.length-l,n)
}}
}function e(k){var l;
g(k).each(function(){if(g(this).is("title")){l=this;
return false
}});
return g(l).text()
}function a(k){return g.ajax(k,{cache:false})
}function h(){return""+Date.now()
}var f=h();
if(b.enabled){b.replaceState({foundationContent:{token:f}})
}g(i).on("statechange",function(n){var m=b.getState();
if(!m.data.foundationContent){return
}var l=g(".foundation-content");
if(!l.length){return
}var k=l.adaptTo("foundation-content");
k.goToToken(m.data.foundationContent.token)
});
g(i).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-content",selector:".foundation-content",adapter:function(m){var o=g(m);
var l=c({token:f,el:o.children(".foundation-content-current")});
var k=function(p){return p.children(".foundation-content-current").removeClass("foundation-content-current").detach()
};
var n;
return{pushState:function(q,r,p){return this.go(p,false,b.enabled?{data:q,title:r,url:p}:undefined)
},replaceState:function(q,r,p){return this.go(p,true,b.enabled?{data:q,title:r,url:p}:undefined)
},go:function(q,r,s){var p=this;
if(n&&n.state()==="pending"){n.abort()
}var t=a(q);
n=t;
return t.then(function(u){if(r){return p.replace(u,s)
}else{return p.push(u,s)
}}).fail(function(){o.trigger("foundation-content-loaded",[false,r,t])
})
},goToToken:function(p){var q=l.pointToToken(p);
if(!q||q.el.is(".foundation-content-current")){return
}var r=g(i).adaptTo("foundation-util-htmlparser");
r.parse(q.el[0]);
k(o);
q.el.addClass("foundation-content-current").appendTo(o)
},refresh:function(){return this.go(j.location.toString(),true)
},push:function(r,u){var q=h();
var t=g(".foundation-content-path").data("foundation-content-path");
var w=g(i).adaptTo("foundation-util-htmlparser");
var p=w.createFragment(r);
var v=w.parse(p);
var s=g(p.querySelector(".foundation-content-current"));
if(!s.length){s=g(j.createElement("div")).addClass("foundation-content-current").append(p)
}l.push({token:q,el:s,history:b.enabled&&u});
v.then(function(){k(o);
o.append(s);
if(g(".foundation-content-path").length===0){g('<div class="foundation-content-path" hidden></div>').data("foundation-content-path",t).prependTo(s)
}s.trigger("foundation-contentloaded");
if(b.enabled&&u){var x=u.data||{};
x.foundationContent={token:q};
b.pushState(x,u.title||e(r),u.url)
}o.trigger("foundation-content-loaded",[true,false])
});
return q
},replace:function(p,r){var q=l.current();
var s=g(i).adaptTo("foundation-util-htmlparser");
s.parse(p).then(function(t){var u=g(t.querySelector(".foundation-content-current"));
if(!u.length){u=g(t).children()
}if(u.is(".foundation-content-current")){o.children(".foundation-content-current").remove();
u.appendTo(o).trigger("foundation-contentloaded")
}else{o.children(".foundation-content-current").empty().append(u).trigger("foundation-contentloaded")
}q.historyConfig=b.enabled&&r;
if(q.historyConfig){var v=r.data||{};
v.foundationContent={token:q.token};
b.replaceState(v,r.title||e(p),r.url)
}o.trigger("foundation-content-loaded",[true,true])
});
return q.token
},back:function(r){if(b.enabled&&l.current().history&&b.getState().data.foundationContent){if(r){var p=this;
g(i).one("statechange",function(){p.refresh()
})
}var t=l.peek(-1);
b.back();
return t?t.token:undefined
}var s=l.back();
if(!s){return
}var u=g(i).adaptTo("foundation-util-htmlparser");
u.parse(s.el[0]);
k(o);
s.el.addClass("foundation-content-current").appendTo(o);
if(r){this.refresh()
}var q=g(".foundation-collection",o).data("cardView");
if(q&&q.layout){q.layout()
}return s.token
},forward:function(r){if(b.enabled&&b.getState().data.foundationContent){if(r){var p=this;
g(i).one("statechange",function(){p.refresh()
})
}var t=l.peek(1);
b.forward();
return t?t.token:undefined
}var q=l.forward();
if(!q){return
}var s=g(i).adaptTo("foundation-util-htmlparser");
s.parse(q.el[0]);
k(o);
q.el.addClass("foundation-content-current").appendTo(o);
if(r){this.refresh()
}return q.token
}}
}})
})(window,document,Granite,Granite.$,History);
(function(a,b){b(a).on("click",".foundation-content-control",function(h){h.preventDefault();
var g=b(this);
var f=g.data("foundationContentControlAction");
var d=g.data("foundationContentControlRefresh");
var c=g.closest(".foundation-content").adaptTo("foundation-content");
if(f==="back"){c.back(d)
}else{if(f==="forward"){c.forward(d)
}}})
})(document,Granite.$);
(function(a,c){function d(h,g,e,f){return h.data(g+"-"+e)||(function(){var i=h.data(g);
if(!i){return undefined
}if(f&&typeof i!=="object"){return i
}return i[e]
})()
}function b(e){var f=d(e,"foundation-content-history","action",true);
return{title:d(e,"foundation-content-history","title"),url:e.prop("href"),replace:f!==undefined?f==="replace":!!d(e,"foundation-content-history","replace"),data:d(e,"foundation-content-history","data")}
}c(a).on("click","a[data-foundation-content-history]",function(j){j.preventDefault();
var f=c(this);
var h=c(".foundation-content");
if(!h.length){return
}var i=b(f);
var g=h.adaptTo("foundation-content");
if(i.replace){g.replaceState(i.data,i.title,i.url)
}else{g.pushState(i.data,i.title,i.url)
}})
})(document,Granite.$);
(function(b,a,c){c(a).on("click",".foundation-history-control",function(g){g.preventDefault();
var f=c(this);
var d=f.data("foundationHistoryControlAction");
if(d==="back"){b.history.back()
}else{if(d==="forward"){b.history.forward()
}}})
})(window,document,Granite.$);
(function(d,g,c,e){var b="foundationPickerButtonlistCustom";
function f(k,j){if(!k.id){k.id=j+":"+Date.now()
}return k.id
}function i(k,j){return k.substring(0,j.length)===j
}function h(m,l){var k=m.getBoundingClientRect();
var j=l.getBoundingClientRect();
return k.top<j.top
}var a=c(d).adaptTo("foundation-registry");
a.register("foundation.adapters",{type:"foundation-picker",selector:"coral-overlay.foundation-picker-buttonlist",adapter:function(q){var o=c(q);
var s=null;
var n=null;
var k=null;
var t=null;
var l=false;
var r=c(g.createElement("div")).addClass("foundation-picker-buttonlist-loader").attr("role","progressbar").append(new Coral.Wait().set({centered:true}));
var j=c(d).adaptTo("foundation-util-paginator");
var u=new j({el:q,limit:q.dataset.foundationPickerButtonlistLimit||10,resolveURL:function(w){return e.expand(q.dataset.foundationPickerButtonlistSrc,{offset:w.offset,limit:w.limit,query:t})
},wait:function(w){o.append(r);
return{clear:function(){r.remove()
}}
},processResponse:function(z,x){var w=c.Deferred();
var y=c(d).adaptTo("foundation-util-htmlparser");
y.parse(x).then(function(C){var D=c(C).children();
if(!D.is("coral-buttonlist")){return
}var B=D.children("button");
B.attr("tabindex",-1);
var F=o.children("coral-buttonlist");
F.append(B);
if(z.offset===0){var E=F.children("button").first();
if(E.length){var G=E.val();
if(t.length>0&&!l&&i(G,t)){if(c(n).is("foundation-autocomplete")){n.field.value=G;
n.field.setSelectionRange(t.length,G.length)
}E.siblings(".is-focused").removeClass("is-focused");
E.addClass("is-focused")
}}}var A=D[0].dataset.foundationPickerButtonlistHasnext;
if(A==="true"){A=true
}else{if(A==="false"){A=false
}else{A=B.length>=z.limit
}}requestAnimationFrame(function(){w.resolve({length:B.length,hasNext:A})
})
});
return w.promise()
}});
var v=function(){if(!k){return
}k(t)
};
var m=function(){s=null;
n=null;
k=null
};
var p=function(x,y){var A={};
for(var w in x.dataset){if(x.dataset.hasOwnProperty(w)){if(w.length<=y.length||!w.startsWith(y)){continue
}var z=w.charAt(y.length);
if(z!==z.toUpperCase()){continue
}var B=w.substr(y.length);
A[B.toLowerCase()]=x.dataset[w]
}}return A
};
u.start();
q.tabIndex=-1;
q.placement="bottom";
q.collision="flip";
o.on("coral-overlay:open",function(w){if(w.target!==q||!n){return
}q.scrollTop=0;
if(n.getAttribute("role")==="combobox"){n.setAttribute("aria-expanded","true")
}if(h(q,n)){o.addClass("is-above")
}else{o.removeClass("is-above")
}});
o.on("coral-overlay:close",function(w){if(w.target!==q){return
}o.find("> coral-buttonlist > button.is-focused").removeClass("is-focused");
if(n.getAttribute("role")==="combobox"){n.removeAttribute("aria-activedescendant");
n.setAttribute("aria-expanded","false")
}m()
});
o.on("mouseover","coral-buttonlist > button",function(x){var w=c(this);
w.siblings(".is-focused").removeClass("is-focused");
w.addClass("is-focused")
});
o.on("click","coral-buttonlist > button",function(x){var w=[{value:this.value,text:this.getAttribute("foundation-picker-buttonlist-text")||this.content.textContent,data:p(this,b)}];
s.resolve(w);
q.open=false
});
c(g).on("click",function(w){if(!q.open||!n){return
}if(!n.contains(w.target)){v();
s.reject();
q.open=false
}});
return{attach:function(w){o.appendTo(w);
o.trigger("foundation-contentloaded")
},detach:function(){o.detach()
},pick:function(w,x,F,y){var E=F===t;
l=t&&F.length<t.length&&i(t,F);
s=c.Deferred();
n=w;
t=F;
k=y;
var B=n.getAttribute("role")==="combobox";
if(B){n.field.setAttribute("aria-autocomplete","both")
}if(!E){var D=o.children("coral-buttonlist");
if(!D.length){var A=new Coral.ButtonList().set({interaction:"off"});
o.append(A);
if(B){n.setAttribute("aria-owns",f(A,"foundation-picker-buttonlist"))
}}else{D.children("button").remove()
}u.restart(undefined,undefined,true)
}if(!q.open){var z=c(w).adaptTo("foundation-overlay-anchor");
var C=z?z.getElement():w;
o.outerWidth(c(C).outerWidth());
q.target=C;
q.open=true
}return s.promise()
},cancel:function(){v();
q.open=false
},resolve:function(w){var x=c.Deferred();
var y=w.map(function(z){var A=o.find("> coral-buttonlist > button").filter(function(){return this.value===z
}).first();
if(A.length){return{value:A[0].value,text:A[0].content.textContent,data:p(A[0],b)}
}else{return null
}});
x.resolve(y);
return x.promise()
},focus:function(A){if(!k){return
}var B=o.children("coral-buttonlist");
var x=B.children(".is-focused");
var w=function(C){if(!C){return
}C.classList.add("is-focused");
var E=C.getBoundingClientRect();
var D=q.getBoundingClientRect();
if(E.top<D.top){C.scrollIntoView()
}else{if(E.top+E.height>D.bottom){C.scrollIntoView(false)
}}f(C,"foundation-picker-buttonlist");
n.setAttribute("aria-activedescendant",C.id);
k(C.value)
};
if(A){if(x.length){x.removeClass("is-focused");
var z=x.prev("button");
if(z.length){w(z[0])
}else{v()
}}else{w(B.children("button:last-of-type")[0])
}}else{if(x.length){x.removeClass("is-focused");
var y=x.next("button");
if(y.length){w(y[0])
}else{v()
}}else{w(B.children("button:first-of-type")[0])
}}}}
}})
})(window,document,Granite.$,Granite.URITemplate);
(function(b,c){var a=c(b).adaptTo("foundation-registry");
a.register("foundation.adapters",{type:"foundation-picker",selector:"coral-popover.foundation-picker-collection, coral-dialog.foundation-picker-collection",adapter:function(e){var d=c(e);
var f=null;
d.on("coral-overlay:open",function(g){if(g.target!==e){return
}g.target.target=null
});
d.on("coral-overlay:close",function(g){if(g.target!==e||!f){return
}f.reject()
});
d.on("click",".granite-pickerdialog-submit",function(h){h.preventDefault();
var g=d.find(".foundation-collection .foundation-selections-item").toArray().map(function(j){return{value:j.dataset.foundationPickerCollectionItemValue||j.dataset.foundationCollectionItemId,text:j.dataset.foundationPickerCollectionItemText||c(j).find(".foundation-collection-item-title").text()}
});
var i=f;
f=null;
e.open=false;
i.resolve(g)
});
d.on("foundation-selections-change",".foundation-collection",function(h){var g=c(this).adaptTo("foundation-selections");
d.find(".granite-pickerdialog-submit").prop("disabled",g.count()===0)
});
return{attach:function(g){if(d.is("coral-dialog")){d.appendTo(document.body)
}else{d.appendTo(g)
}d.trigger("foundation-contentloaded")
},detach:function(){d.detach()
},pick:function(g){f=c.Deferred();
requestAnimationFrame(function(){var h=d.find(".foundation-collection").adaptTo("foundation-selections");
if(h){h.clear()
}e.target=g;
e.open=true
});
return f.promise()
},cancel:function(){f=null;
e.open=false
}}
}})
})(window,Granite.$);
(function(b,c){var a=c(b).adaptTo("foundation-registry");
a.register("foundation.adapters",{type:"foundation-picker",selector:"coral-popover.foundation-picker-form, coral-dialog.foundation-picker-form",adapter:function(g){var e=c(g);
var f=e.adaptTo("foundation-picker-form");
var d=null;
e.on("coral-overlay:open",function(i){if(i.target!==g){return
}i.target.target=null
});
e.on("coral-overlay:close",function(i){if(i.target!==g||!d){return
}d.reject()
});
var h=g.dataset.foundationPickerFormTarget||"form";
e.on("submit",h,function(j){j.preventDefault();
var i=c(this);
var k=d;
d=null;
g.open=false;
k.resolve(f.getSelections())
});
return{attach:function(i){if(e.is("coral-dialog")){e.appendTo(document.body)
}else{e.appendTo(i)
}e.trigger("foundation-contentloaded")
},detach:function(){e.detach()
},pick:function(j,k,i){d=c.Deferred();
requestAnimationFrame(function(){f.setup(j,k,i).then(function(){g.target=j;
g.open=true
})
});
return d.promise()
},cancel:function(){d=null;
g.open=false
}}
}})
})(window,Granite.$);
(function(e,g,d,c){var a=d(e).adaptTo("foundation-registry");
function b(m,l,k){var j=m.data("foundationPickerControlAction");
c.UI.Foundation.Utils.everyReverse(a.get("foundation.picker.control.action"),function(n){if(n.name!==j.name){return true
}return n.handler.call(m[0],n.name,m[0],j,k)===false
})
}function h(k,j){j.api.attach(this);
j.api.pick(k[0],[]).then(function(l){j.api.detach();
j.open=false;
b(k,j,l)
},function(){i(k,j)
});
if("focus" in j.api){j.api.focus()
}else{j.el.focus()
}j.open=true
}function i(k,j){j.api.detach();
j.open=false
}function f(k){var l="foundation-picker-control.internal.state";
var j=k.data(l);
if(!j){j={el:null,open:false,loading:false};
k.data(l,j)
}return j
}d(g).on("click",".foundation-picker-control",function(l){l.preventDefault();
var k=d(this);
var j=f(k);
if(j.loading){return
}if(j.el){if(j.open){j.api.cancel();
i(k,j)
}else{h(k,j)
}}else{var m=k[0].dataset.foundationPickerControlSrc;
if(!m){return
}j.loading=true;
d.ajax({url:m,cache:false}).then(function(n){return d(e).adaptTo("foundation-util-htmlparser").parse(n)
}).then(function(n){return d(n).children()[0]
}).then(function(n){j.loading=false;
j.el=n;
j.api=d(n).adaptTo("foundation-picker");
h(k,j)
},function(){j.loading=false
})
}})
})(window,document,Granite.$,Granite);
(function(a,b,c,d){b.UI.Foundation.Layouts=b.UI.Foundation.Layouts||(function(){var e=c(window).adaptTo("foundation-registry");
var f=function(g){return e.get("foundation.layouts").find(function(h){return h.name===g
})
};
return{register:function(g,i,h){e.register("foundation.layouts",{name:g,doLayout:i,clean:h})
},layout:function(i){var h=c(i);
var g=h.data("foundationLayout");
var j=f(g.name);
if(j){if(g.stateId){c.cookie(g.stateId+".layoutId",g.layoutId,{expires:7,path:"/"})
}j.doLayout(i,g);
h.trigger("foundation-layout-perform")
}},switchLayout:function(k,i){var h=c(k);
var g=h.data("foundationLayout");
if(g&&g.name===i.name){return
}if(g){var j=f(g.name);
(j.clean||this.clean)(k,g)
}h.addClass(i.name);
h.data("foundationLayout",i);
this.layout(k)
},clean:function(i){var h=c(i);
var g=h.data("foundationLayout");
h.removeClass(g.name);
h.data("foundationLayout",null);
if(g.stateId){c.removeCookie(g.stateId+".layoutId",{path:"/"})
}},cleanAll:function(j){var h=c(j);
var g=h.data("foundationLayout");
if(g){var i=f(g.name);
(i.clean||this.clean)(j,g)
}}}
})();
c(a).on("foundation-contentloaded",function(f){c(f.target).filter("[data-foundation-layout]").add(c("[data-foundation-layout]",f.target)).each(function(){b.UI.Foundation.Layouts.layout(this)
})
})
})(document,Granite,Granite.$);
(function(a,b,c){c(a).on("click",".foundation-layout-control",function(h){var g=c(this);
var d=g.data("foundationLayoutControl");
if(d.action==="switch"){var f=d.target?c(d.target):g.closest("[data-foundation-layout]");
b.UI.Foundation.Layouts.switchLayout(f[0],d.config);
c(".foundation-layout-control").each(function(){var j=c(this);
if(j.is(g)){return
}var i=j.data("foundationLayoutControl");
if(i.action!=="switch"){return
}if(d.config.name!==i.config.name){return
}var e=i.target?f.is(i.target):f.is(j.closest("[data-foundation-layout]"));
if(!e){return
}if(j.parent(".coral-CycleButton").length){j.addClass("is-active");
j.siblings(".foundation-layout-control").removeClass("is-active")
}else{if(j.parent("coral-cyclebutton").length){j.prop("selected",true)
}}})
}})
})(document,Granite,Granite.$);
(function(a,b,d){function c(e){var f=e?a.localStorage:a.sessionStorage;
return{get:function(g){return JSON.parse(f.getItem(g))
},set:function(g,h){f.setItem(g,JSON.stringify(h))
},remove:function(g){f.removeItem(g)
}}
}b(a).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-clipboard",selector:b(a),adapter:function(e){var g=b(e);
var f=c();
return{get:function(h){return f.get(h)
},set:function(h,i){f.set(h,i);
g.trigger("foundation-clipboard-change",{key:h,data:i,timestamp:new Date().getTime()})
},remove:function(h){f.remove(h);
g.trigger("foundation-clipboard-change",{key:h,data:null,timestamp:new Date().getTime()})
}}
}})
})(window,Granite.$);
(function(c,a,d,e){var b=(function(){var f=[];
return{register:function(g,h){f.push({varname:g,provider:h})
},expandURITemplate:function(h){if(!h){return h
}var g=f.reduce(function(j,i){j[i.varname]=i.provider(i.varname);
return j
},{});
return e.expand(h,g)
},resolveVar:function(g){var h=f.find(function(i){return i.varname===g
});
return h?h.provider(g):undefined
}}
})();
b.register("window.location",function(){return c.location.href
});
d(a).on("click","a.foundation-setter",function(f){f.preventDefault();
c.location=b.expandURITemplate(this.href)
});
d(a).on("foundation-contentloaded",function(f){d("input.foundation-setter",f.target).each(function(){this.value=b.resolveVar(d(this).data("foundationSetterVar"))
})
})
})(window,document,Granite.$,Granite.URITemplate);
(function(e,a,g,d){var h;
function c(){if(!h){h=d.I18n.get("Please fill out this field.")
}return h
}a.addEventListener("invalid",function(k){if(k.isJqueryValidator){return
}k.preventDefault();
var j=g(k.target);
var i=j.closest(":-foundation-submittable").adaptTo("foundation-validation");
i.checkValidity();
i.updateUI()
},true);
var b=g(e).adaptTo("foundation-registry");
b.register("foundation.validation.selector",{submittable:"input, textarea, select, button, keygen, object",candidate:"input:not([readonly]):not([disabled]):not([type=hidden]):not([type=reset]):not([type=button]), select:not([disabled]), textarea:not([readonly]):not([disabled]), button:not([disabled]):not([type=reset]):not([type=button])"});
b.register("foundation.validation.selector",{submittable:"[role=checkbox], [role=radio], [role=combobox], [role=listbox], [role=radiogroup], [role=tree], [role=slider], [role=spinbutton], [role=textbox]",candidate:"[role=checkbox]:not([aria-disabled=true]), [role=radio]:not([aria-disabled=true]), [role=combobox]:not([aria-disabled=true]), [role=listbox]:not([aria-disabled=true]), [role=radiogroup]:not([aria-disabled=true]), [role=tree]:not([aria-disabled=true]), [role=slider]:not([aria-disabled=true]), [role=spinbutton]:not([aria-disabled=true]), [role=textbox]:not([aria-disabled=true]):not([aria-readonly=true])"});
b.register("foundation.validation.validator",{selector:"input, textarea, select",validate:function(i){var j=g(i);
var l=i.required===true||(i.required===undefined&&j.attr("required")!==undefined)||j.attr("aria-required")==="true";
if(!l){return
}var k=false;
if(j.is("[type=checkbox], [type=radio]")){k=i.checked
}else{k=i.value.length>0
}if(!k){return c()
}}});
var f=function(j){var i=g(this).adaptTo("foundation-validation");
if(i){i.checkValidity();
i.updateUI()
}};
g(a).on("change","input, textarea",f);
g(a).on("input","input, textarea",d.UI.Foundation.Utils.debounce(f,500));
b.register("foundation.validation.validator",{selector:"[role=listbox]",validate:function(i){var k=g(i);
if(k.attr("aria-required")!=="true"){return
}var j=false;
k.find("[role=option]").each(function(){if(g(this).attr("aria-selected")==="true"){j=true;
return false
}});
if(!j){return c()
}}})
})(window,document,Granite.$,Granite);
(function(a,b){b(a).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-field",selector:"input, textarea, select",adapter:function(c){return{getName:function(){return c.name
},setName:function(d){c.name=d
},isDisabled:function(){return c.disabled
},setDisabled:function(d){c.disabled=d
},isInvalid:function(){return c.getAttribute("aria-invalid")==="true"
},setInvalid:function(d){c.setAttribute("aria-invalid",!!d?"true":"false")
},isRequired:function(){return c.getAttribute("aria-required")==="true"
},setRequired:function(d){c.setAttribute("aria-required",!!d?"true":"false")
},getValue:function(){if(c.type==="checkbox"||c.type==="radio"){return c.checked?c.value:null
}else{return c.value
}},setValue:function(d){if(c.type==="checkbox"||c.type==="radio"){c.checked=c.value===d
}else{c.value=d
}},getValues:function(){if(c.tagName==="SELECT"){return Array.prototype.map.call(c.selectedOptions,function(d){return d.value
})
}else{return[this.getValue()]
}},setValues:function(d){if(c.tagName==="SELECT"){Array.prototype.forEach.call(c.selectedOptions,function(e){e.selected=false
});
d.forEach(function(f){var e=Array.prototype.find.call(c.options,function(g){return g.value===f
});
if(e){e.selected=true
}})
}else{if(c.type==="checkbox"||c.type==="radio"){c.checked=d.some(function(e){return c.value===e
})
}else{c.value=d[0]
}}}}
}});
b(document).on("change","input, textarea, select",function(c){b(this).trigger("foundation-field-change")
})
})(window,Granite.$);
(function(a,d,b){var c;
function e(){if(!c){c=b.I18n.get("<Mixed entries>")
}return c
}d(window).adaptTo("foundation-registry").register("foundation.adapters",{type:"foundation-field-mixed",selector:"input, textarea",adapter:function(f){var g=d(f);
return{setMixed:function(h){if(h){g.addClass("foundation-field-mixed");
g.attr("placeholder",e())
}else{g.removeClass("foundation-field-mixed");
g.removeAttr("placeholder")
}}}
}});
d(a).on("change",".foundation-field-mixed",function(){var g=d(this);
var f=g.adaptTo("foundation-field-mixed");
if(f){f.setMixed(false)
}})
})(document,Granite.$,Granite);
(function(a,b,c){b(a).on("foundation-contentloaded",function(h){b("[data-datepicker-format]",h.target).each(function(){var j=b(this);
var k=j.data("datepicker-format");
if(!k){return
}var i=j.text();
if(!i){return
}var e=c(i,["YYYY-MM-DD[T]HH:mm:ss.SSSZ","YYYY-MM-DD[T]HH:mm:ssZ",k]);
if(!e){return
}j.replaceWith(e.format(k))
});
var g=c().locale(a.documentElement.lang);
var f=g.utcOffset();
var d=g.format("Z");
b(".granite-datepicker-timezone",h.target).each(function(){var i=b(this);
var e=parseInt(i.attr("data-granite-datepicker-timezone-server"),10);
if(e===f){i.attr("hidden","");
return
}i.find(".granite-datepicker-timezone-client").text(d)
})
})
})(document,Granite.$,moment);
(function(a,e,g){e(a).on("cui-contentloaded",function(i,h){if(h&&h._foundationcontentloaded){return
}e(i.target).trigger("foundation-contentloaded",{_cuicontentloaded:true})
});
e(a).on("foundation-contentloaded",function(i,h){if(h&&h._cuicontentloaded){return
}e(i.target).trigger("cui-contentloaded",{_foundationcontentloaded:true})
});
var c=["folder","hierarchy","hierarchyNotFile","nosystem"];
var f=function(h){var i={name:"granite.ui.pathBrowser.pages."+h,handler:function(j,k){e.get(j+".pages.json",{predicate:h},function(o){var m=o.pages;
var l=[];
for(var n=0;
n<m.length;
n++){l.push(m[n].label)
}if(k){k(l)
}},"json");
return false
}};
return i
};
for(var d=0;
d<c.length;
d++){CUI.PathBrowser.register("optionLoader",f(c[d]))
}e(a).on("foundation-contentloaded",function(h){e(".granite-autocomplete.coral-Autocomplete",h.target).each(function(){if(e(this).data("autocomplete")===undefined){var i=new CUI.Autocomplete({element:this,selectlistConfig:{loadData:function(p,j){var o=this.$element.attr("data-granite-autocomplete-src");
if(!o){return
}var l=g.expand(o,e.extend({},this.options.dataadditional,{start:p,end:j}));
var k=this;
var m=e.get(l);
var n=m.then(function(r){var q=e(r);
var s=q.filter("li").length;
k.$element.append(q);
return s<k.options.datapagesize
});
n.abort=function(){m.abort()
};
return n
}}})
}})
});
var b=e(window).adaptTo("foundation-registry");
b.register("foundation.adapters",{type:"foundation-field",selector:".coral-PathBrowser",adapter:function(j){var l=e(j);
var i=l.find(".js-coral-pathbrowser-input");
var h=i.adaptTo("foundation-field");
var k=l.data("pathBrowser");
return{getName:h.getName,setName:h.setName,isDisabled:function(){return !!k.get("disabled")
},setDisabled:function(m){k.set("disabled",m)
},isInvalid:h.isInvalid,setInvalid:h.setInvalid,isRequired:h.isRequired,setRequired:h.setRequired,getValue:h.getValue,setValue:h.setValue,getValues:h.getValues,setValues:h.setValues}
}});
e(a).on("change",".js-coral-pathbrowser-input",function(h){e(this).closest(".coral-PathBrowser").trigger("foundation-field-change")
});
b.register("foundation.adapters",{type:"foundation-field",selector:".coral-Autocomplete:not(coral-autocomplete)",adapter:function(j){var l=e(j);
var i=l.find(".js-coral-Autocomplete-textfield");
var h=i.adaptTo("foundation-field");
var k=l.data("autocomplete");
return{getName:h.getName,setName:function(m){var n=h.getName();
l.children(".foundation-field-related").each(function(){if(this.name.startsWith(n+"@")){this.name=m+this.name.substring(n.length)
}});
h.setName(m)
},isDisabled:function(){return !!k.get("disabled")
},setDisabled:function(m){k.set("disabled",m);
l.children(".foundation-field-related").prop("disabled",m)
},isInvalid:h.isInvalid,setInvalid:h.setInvalid,isRequired:function(){return j.getAttribute("aria-required")==="true"
},setRequired:function(m){j.setAttribute("aria-required",!!m?"true":"false")
},getValue:function(){if(k.options.multiple){return k.getValue()[0]
}else{return k.getValue()
}},setValue:function(m){if(k.options.multiple){k.clear();
k._tagListWidget.addItem({value:m,display:m})
}else{h.setValue(m)
}},getValues:function(){if(k.options.multiple){return k.getValue()
}else{return[k.getValue()]
}},setValues:function(m){if(k.options.multiple){k.clear();
k._tagListWidget.addItem(m.map(function(n){return{value:n,display:n}
}))
}else{h.setValues(m)
}}}
}});
e(a).on("change:value",".coral-Autocomplete:not(coral-autocomplete)",function(h){e(this).trigger("foundation-field-change")
});
e(a).on("change",".js-coral-Autocomplete-textfield",function(h){e(this).closest(".coral-Autocomplete").trigger("foundation-field-change")
})
})(document,Granite.$,Granite.URITemplate);
(function(b,c){var a=c(b).adaptTo("foundation-registry");
a.register("foundation.adapters",{type:"foundation-toggleable",selector:"coral-dialog.foundation-toggleable",adapter:function(e){var d=c(e);
d.on("coral-overlay:open",function(f){if(f.target!==e){return
}d.trigger("foundation-toggleable-show")
});
d.on("coral-overlay:close",function(f){if(f.target!==e){return
}d.trigger("foundation-toggleable-hide")
});
return{isOpen:function(){return e.open
},show:function(f){e.show()
},hide:function(){e.hide()
}}
}});
a.register("foundation.adapters",{type:"foundation-toggleable",selector:"coral-popover.foundation-toggleable, coral-overlay.foundation-toggleable",adapter:function(e){var f=c(e);
var d=e.tagName.toLowerCase()==="coral-popover";
var g=function(h){var i=e._getTarget();
if(i&&!i.contains(h.target)&&!e.contains(h.target)){e.hide()
}};
f.on("coral-overlay:open",function(h){if(h.target!==e){return
}f.trigger("foundation-toggleable-show")
});
f.on("coral-overlay:close",function(h){if(h.target!==e){return
}if(d){document.removeEventListener("click",g,true)
}f.trigger("foundation-toggleable-hide")
});
return{isOpen:function(){return e.open
},show:function(h){if(!(h instanceof Element)){return
}e.target=h;
if(d){e.interaction="off";
document.addEventListener("click",g,true)
}e.show()
},hide:function(){e.hide()
}}
}});
a.register("foundation.adapters",{type:"foundation-toggleable",selector:"coral-panel.foundation-toggleable",adapter:function(e){var d=c(e);
return{isOpen:function(){return e.selected
},show:function(f){e.selected=true;
d.trigger("foundation-toggleable-show")
},hide:function(){e.selected=false;
d.trigger("foundation-toggleable-hide")
}}
}})
})(window,Granite.$);
(function(m,g,k){var f=500;
var n;
function h(){if(!n){n=Granite.I18n.get("Please fill out this field.")
}return n
}function o(r){var q=r.adaptTo("foundation-validation");
if(q){q.checkValidity();
q.updateUI()
}}function l(s,u){var t=g(s);
var w=t.closest(".coral-Form-field");
var r=t.adaptTo("foundation-field");
if(r&&r.setInvalid){r.setInvalid(true)
}w.nextAll(".coral-Form-fieldinfo").addClass("u-coral-screenReaderOnly");
var q=w.data("foundation-validation.internal.error");
if(q){var v=g(q).data("foundation-validation.internal.error.tooltip");
v.content.innerHTML=u;
if(!q.parentNode){w.after(q,v)
}}else{q=new k.Icon();
q.icon="alert";
q.classList.add("coral-Form-fielderror");
v=new k.Tooltip();
v.variant="error";
v.placement=w.closest(".coral-Form").hasClass("coral-Form--vertical")?"left":"bottom";
v.target=q;
v.content.innerHTML=u;
g(q).data("foundation-validation.internal.error.tooltip",v);
w.data("foundation-validation.internal.error",q);
w.after(q,v)
}}function c(s){var t=g(s);
var v=t.closest(".coral-Form-field");
var r=t.adaptTo("foundation-field");
if(r&&r.setInvalid){r.setInvalid(false)
}var q=v.data("foundation-validation.internal.error");
if(q){var u=g(q).data("foundation-validation.internal.error.tooltip");
u.hide();
u.remove();
q.remove()
}v.nextAll(".coral-Form-fieldinfo").removeClass("u-coral-screenReaderOnly")
}var p=Granite.UI.Foundation.Utils.debounce;
var b=g(m).adaptTo("foundation-registry");
var j=[".coral-Form-fieldwrapper .coral-Form-field",".coral-Form-fieldwrapper .coral-Form-field.coral-InputGroup .coral-InputGroup-input",".coral-Form-fieldwrapper .coral-Form-field.coral-DecoratedTextfield .coral-DecoratedTextfield-input",".coral-Form-fieldwrapper .coral-Form-field.coral-PathBrowser .js-coral-pathbrowser-input",".coral-Form-fieldwrapper .coral-Form-field.coral-Checkbox .coral-Checkbox-input",".coral-Form-fieldwrapper .coral-Form-field.coral-Switch .coral-Switch-input",".coral-Form-fieldwrapper .coral-Form-field.coral-Select .coral-Select-select",".coral-Form-fieldwrapper .coral-Form-field.coral-FileUpload .coral-FileUpload-input"];
b.register("foundation.validation.validator",{selector:j.join(", "),show:function(q,r){l(q,r)
},clear:function(q){c(q)
}});
b.register("foundation.validation.validator",{selector:"input[type=password]",validate:function(t){var r=g(t);
if(!t.value){return
}var s=t.getAttribute("data-granite-password-retype");
if(s){var q=r.closest("form").find("input[type=password]").filter(function(){return this.name===s
});
if(q.val()){o(q)
}}else{var u=true;
r.closest("form").find("input[type=password][data-granite-password-retype]").each(function(){s=this.getAttribute("data-granite-password-retype");
if(!s||s!==t.name){return
}if(this.value&&this.value!==t.value){u=false;
return false
}});
if(!u){return Granite.I18n.get("Passwords do not match!")
}}}});
b.register("foundation.validation.selector",{submittable:"coral-checkbox, coral-radio, coral-switch",candidate:"coral-checkbox:not([readonly]):not([disabled]), coral-radio:not([readonly]):not([disabled]), coral-switch:not([readonly]):not([disabled])",exclusion:"coral-checkbox *, coral-radio *, coral-switch *"});
b.register("foundation.validation.validator",{selector:"coral-checkbox, coral-radio, coral-switch",validate:function(q){if(q.required&&!q.checked){return h()
}}});
b.register("foundation.validation.selector",{submittable:"coral-datepicker, coral-numberinput, coral-slider, coral-colorinput",candidate:"coral-datepicker:not([readonly]):not([disabled]), coral-numberinput:not([readonly]):not([disabled]), coral-slider:not([readonly]):not([disabled]), coral-colorinput:not([readonly]):not([disabled])",exclusion:"coral-datepicker *, coral-numberinput *, coral-slider *, coral-colorinput *"});
b.register("foundation.validation.validator",{selector:"coral-slider, coral-colorinput",validate:function(q){if(q.required&&q.value.length===0){return h()
}}});
b.register("foundation.validation.validator",{selector:"coral-numberinput",validate:function(q){if(q.required&&!q.value){return h()
}if(q.max!==null&&q.valueAsNumber>q.max){return Granite.I18n.get("Please enter a value that is no more than {0}.",[q.max],"{0}=max number")
}if(q.min!==null&&q.valueAsNumber<q.min){return Granite.I18n.get("Please enter a value that is no less than {0}.",[q.min],"{0}=min number")
}}});
b.register("foundation.validation.validator",{selector:"coral-datepicker",validate:function(t){if(t.required&&t.value.length===0){return h()
}var s=g(t);
var w="data-granite-datepicker-before";
var u="data-granite-datepicker-after";
var r;
var v=t.getAttribute(w);
if(v){g(v).each(function(){r=i(t,this);
if(r){return false
}});
if(r){return r
}}var q=t.getAttribute(u);
if(q){g(q).each(function(){r=a(t,this);
if(r){return false
}});
if(r){return r
}}g("coral-datepicker["+w+"]").each(function(){if(s.is(this.getAttribute(w))){r=a(t,this);
if(r){o(g(this))
}}});
g("coral-datepicker["+u+"]").each(function(){if(s.is(this.getAttribute(u))){r=i(t,this);
if(r){o(g(this))
}}})
}});
function a(r,q){if(r.valueAsDate===null||q.valueAsDate===null){return
}if(r.valueAsDate.getTime()>=q.valueAsDate.getTime()){return Granite.I18n.get("The date is not before {0}.",moment(q.valueAsDate).format(q.displayFormat))
}}function i(q,r){if(r.valueAsDate===null||q.valueAsDate===null){return
}if(r.valueAsDate.getTime()>=q.valueAsDate.getTime()){return Granite.I18n.get("The date is not after {0}.",moment(r.valueAsDate).format(r.displayFormat))
}}b.register("foundation.validation.selector",{submittable:"coral-autocomplete, coral-select, coral-taglist, coral-fileupload, coral-buttongroup",candidate:"coral-autocomplete:not([readonly]):not([disabled]), coral-select:not([readonly]):not([disabled]), coral-taglist:not([readonly]):not([disabled]), coral-fileupload:not([readonly]):not([disabled]), coral-buttongroup:not([readonly]):not([disabled])",exclusion:"coral-autocomplete *, coral-select *, coral-taglist *, coral-fileupload *, coral-buttongroup *"});
b.register("foundation.validation.validator",{selector:"coral-autocomplete, coral-select, coral-taglist, coral-fileupload, coral-buttongroup",validate:function(q){if(q.required){if(q.values.length===0||(q.values.length===1&&q.value==="")){return h()
}}}});
b.register("foundation.validation.selector",{submittable:"coral-multifield",candidate:"coral-multifield",exclusion:"[coral-multifield-template], [coral-multifield-template] *"});
b.register("foundation.validation.validator",{selector:"coral-multifield",validate:function(q){if(q.getAttribute("aria-required")==="true"&&q.items.getAll().length===0){return h()
}}});
g(document).on("change","coral-autocomplete, coral-checkbox, coral-switch, coral-datepicker, coral-numberinput, coral-colorinput, coral-radio, coral-select, coral-slider, coral-taglist, coral-multifield, coral-fileupload, coral-buttongroup",function(q){o(g(this))
});
g(document).on("input","coral-datepicker input[handle], coral-numberinput input[handle], coral-colorinput input[handle]",p(function(q){o(g(this).closest("coral-datepicker, coral-numberinput, coral-colorinput"))
},f));
b.register("foundation.validation.selector",{submittable:".coral-RadioGroup",candidate:".coral-RadioGroup",exclusion:".coral-RadioGroup *"});
b.register("foundation.validation.validator",{selector:".coral-RadioGroup",validate:function(s){var r=g(s);
if(r.attr("aria-required")!=="true"){return
}var q=r.children("coral-radio");
if(q.length){if(q.filter("[checked]").length===0){return h()
}}else{if(r.find("> * > :checked").length===0){return h()
}}}});
g(document).on("change",".coral-RadioGroup",function(q){o(g(this))
});
b.register("foundation.validation.selector",{submittable:".coral-Autocomplete:not(coral-autocomplete)",candidate:".coral-Autocomplete:not(coral-autocomplete)",exclusion:".coral-Autocomplete:not(coral-autocomplete) *"});
b.register("foundation.validation.validator",{selector:".coral-Autocomplete:not(coral-autocomplete)",validate:function(q){var r=g(q);
if(r.attr("aria-required")!=="true"){return
}var s=r.data("autocomplete");
if(s.getValue().length===0){return h()
}}});
g(document).on("change:value",".coral-Autocomplete:not(coral-autocomplete)",function(q){o(g(this))
});
var e=function(s){var q=g(this);
var r=q.closest(".coral-Autocomplete");
if(r.data("autocomplete").options.multiple){return
}o(r)
};
g(document).on("change",".js-coral-Autocomplete-textfield",e);
g(document).on("input",".js-coral-Autocomplete-textfield",p(e,f));
function d(r,t){var s="coral-tabview.internal.invalids";
var q=r.data(s);
if(q===undefined){q=[];
r.data(s,q)
}if(q.indexOf(t)<0){q.push(t)
}}g(document).on("foundation-validation-invalid","coral-panel",function(s){var q=g(this);
var r=q.parent().parent("coral-tabview")[0];
if(!r){return
}requestAnimationFrame(function(){var t=r.tabList.items.getAll()[q.index()];
t.invalid=true;
d(q,s.target)
})
});
g(document).on("foundation-validation-valid","coral-panel",function(s){var q=g(this);
var r=q.parent().parent("coral-tabview")[0];
if(!r){return
}requestAnimationFrame(function(){var x=r.tabList.items.getAll()[q.index()];
var v=function(){if(q.adaptTo("foundation-validation-helper").isValid()){x.invalid=false
}};
var t=q.data("coral-tabview.internal.invalids");
if(!t){v();
return
}var w=t.indexOf(s.target);
if(w>=0){t.splice(w,1)
}if(t.length===0){v();
return
}var y=false;
var u=t.length;
while(u--){if(q.has(t[u]).length){y=true;
break
}t.splice(u,1)
}if(!y){v()
}})
})
})(window,Granite.$,Coral);
(function(d,a,e){var c=e(d).adaptTo("foundation-registry");
var g=e(a);
function f(j,i,h){if(j.name.startsWith(i+"@")){j.name=h+j.name.substring(i.length)
}}var b=["input[is='coral-textfield']","textarea[is='coral-textarea']","coral-checkbox","coral-radio","coral-switch","coral-datepicker","coral-numberinput","coral-slider","coral-colorinput","coral-calendar","coral-autocomplete","coral-select","coral-taglist","coral-fileupload","coral-buttongroup"];
c.register("foundation.adapters",{type:"foundation-field",selector:b.join(","),adapter:function(h){var i=e(h);
return{getName:function(){return h.name
},setName:function(j){i.nextAll(".foundation-field-related").add(i.children(".foundation-field-related")).each(function(){f(this,h.name,j)
});
h.name=j
},isDisabled:function(){return h.disabled
},setDisabled:function(j){h.disabled=j;
i.nextAll(".foundation-field-related").add(i.children(".foundation-field-related")).prop("disabled",j)
},isInvalid:function(){return h.hasAttribute("invalid")
},setInvalid:function(j){if(j){h.setAttribute("invalid","")
}else{h.removeAttribute("invalid")
}},isRequired:function(){if(e(h).is("input, textarea")){return h.getAttribute("aria-required")==="true"
}else{return h.required
}},setRequired:function(j){if(e(h).is("input, textarea")){h.setAttribute("aria-required",!!j?"true":"false")
}else{h.required=j
}},getValue:function(){if(e(h).is("coral-checkbox, coral-radio, coral-switch")){return h.checked?h.value:null
}else{return h.value
}},setValue:function(j){if(e(h).is("coral-checkbox, coral-radio, coral-switch")){h.checked=h.value===j
}else{h.value=j
}},getValues:function(){if(e(h).is("coral-checkbox, coral-radio, coral-switch")){return[this.getValue()]
}if("values" in h){return h.values
}else{return[h.value]
}},setValues:function(j){if(e(h).is("coral-checkbox, coral-radio, coral-switch")){h.checked=j.some(function(k){return h.value===k
})
}else{if("values" in h){h.values=j
}else{h.value=j[0]
}}}}
}});
c.register("foundation.adapters",{type:"foundation-field",selector:"coral-multifield",adapter:function(i){var h=e(i);
return{getName:function(){return i.getAttribute("data-granite-coral-multifield-name")
},setName:function(j){i.setAttribute("data-granite-coral-multifield-name",j)
},isDisabled:function(){return h.children("[coral-multifield-add]").prop("disabled")
},setDisabled:function(j){h.children("coral-multifield-item").each(function(){var l=e(this);
l.children("[coral-Multifield-remove], [coral-Multifield-move]").prop("disabled",j);
var k=l.children(":first-child").adaptTo("foundation-field");
if(k&&"setDisabled" in k){k.setDisabled(j)
}});
h.children("[coral-multifield-add], .foundation-field-related").prop("disabled",j)
},isInvalid:function(){return i.getAttribute("aria-invalid")==="true"
},setInvalid:function(j){i.setAttribute("aria-invalid",!!j?"true":"false")
},isRequired:function(){return i.getAttribute("aria-required")==="true"
},setRequired:function(j){i.setAttribute("aria-required",!!j?"true":"false")
},getValue:function(){var j=h.find("> coral-multifield-item > :first-child").first().adaptTo("foundation-field");
if(j&&"getValue" in j){return j.getValue()
}else{return null
}},setValue:function(k){i.items.clear();
h.children("[coral-multifield-add]")[0].click();
var j=h.children("coral-multifield-item").last();
setTimeout(function(){var l=j.children(":first-child").adaptTo("foundation-field");
if(l&&"setValue" in l){return l.setValue(k)
}},0)
},getValues:function(){return Array.prototype.map(h.find("> coral-multifield-item > :first-child"),function(k){var j=e(k).adaptTo("foundation-field");
if(j&&"getValue" in j){return j.getValue()
}})
},setValues:function(j){i.items.clear();
var k=h.children("[coral-multifield-add]")[0];
j.forEach(function(m){k.click();
var l=h.children("coral-multifield-item").last();
setTimeout(function(){var n=l.children(":first-child").adaptTo("foundation-field");
if(n&&"setValue" in n){return n.setValue(m)
}},0)
})
}}
}});
g.on("change",b.concat("coral-multifield").join(","),function(h){e(this).trigger("foundation-field-change")
});
c.register("foundation.adapters",{type:"foundation-field",selector:".coral-RadioGroup",adapter:function(h){var i=e(h);
return{getName:function(){return i.children("coral-radio").first().prop("name")||""
},setName:function(j){var l=i.children("coral-radio");
var k=l.first().prop("name");
l.prop("name",j);
if(typeof k!=="undefined"){i.children(".foundation-field-related").each(function(){f(this,k,j)
})
}},isDisabled:function(){var j=i.children("coral-radio");
if(j.length===0){return false
}else{return Array.prototype.every.call(j,function(k){return k.disabled
})
}},setDisabled:function(j){i.children("coral-radio, .foundation-field-related").prop("disabled",j)
},isInvalid:function(){return h.getAttribute("aria-invalid")==="true"
},setInvalid:function(j){h.setAttribute("aria-invalid",!!j?"true":"false")
},isRequired:function(){return h.getAttribute("aria-required")==="true"
},setRequired:function(j){h.setAttribute("aria-required",!!j?"true":"false")
},getValue:function(){var j=Array.prototype.reduce.call(i.children("coral-radio"),function(k,l){if(l.checked){k.push(l.value)
}return k
},[]);
if(j.length){return j[0]
}else{return null
}},setValue:function(j){i.children("coral-radio").each(function(){if(this.value===j){return this.checked=true
}return false
})
},getValues:function(){return Array.prototype.reduce.call(i.children("coral-radio"),function(j,k){if(k.checked){j.push(k.value)
}return j
},[])
},setValues:function(k){var j=i.children("coral-radio");
k.forEach(function(l){j.each(function(){if(this.value===l){j=j.not(this);
this.checked=true;
return false
}})
})
}}
}});
g.on("change","coral-radio",function(h){e(this).parent(".coral-RadioGroup").trigger("foundation-field-change")
})
})(window,document,Granite.$);
(function(a,e,c){var d;
function f(){if(!d){d=c.I18n.get("<Mixed entries>")
}return d
}var b=e(window).adaptTo("foundation-registry");
b.register("foundation.adapters",{type:"foundation-field-mixed",selector:"coral-datepicker",adapter:function(g){return{setMixed:function(h){if(h){g.classList.add("foundation-field-mixed");
g.placeholder=f()
}else{g.classList.remove("foundation-field-mixed");
g.placeholder=""
}}}
}});
b.register("foundation.adapters",{type:"foundation-field-mixed",selector:"[data-init='pathbrowser']",adapter:function(g){var i=e(g);
var h=i.data("pathBrowser");
return{setMixed:function(j){if(j){h.$element.addClass("foundation-field-mixed");
h.$element.attr("placeholder",f())
}else{h.$element.removeClass("foundation-field-mixed");
h.$element.removeAttr("placeholder")
}}}
}});
b.register("foundation.adapters",{type:"foundation-field-mixed",selector:"coral-checkbox",adapter:function(g){return{setMixed:function(h){if(h){g.classList.add("foundation-field-mixed")
}else{g.classList.remove("foundation-field-mixed")
}}}
}});
b.register("foundation.adapters",{type:"foundation-field-mixed",selector:".js-cq-TagsPickerField[data-init='pathbrowser']",adapter:function(g){return{setMixed:function(h){}}
}})
})(document,Granite.$,Granite);
(function(c,f){var a="coral-multifield";
var b="coral-multifield[data-granite-coral-multifield-composite]";
function e(g,h){g.children().each(function(){var i=f(this);
if(i.is(":-foundation-submittable")){h(this)
}else{e(i,h)
}})
}function d(i,k){var h=f(i);
var g=h.is(b);
var l=h.adaptTo("foundation-field").getName();
var j=k||l;
if(!j){return
}i.items.getAll().forEach(function(n,m){j=k||l;
if(g){j+="/item"+m+"/"
}e(f(n),function(q){var s=f(q);
var p=s.adaptTo("foundation-field");
if(!p){return
}if(!p.setName){throw new Error("The field doesn't support FoundationField#setName")
}var o=s.data("cachedName");
if(!o){o=p.getName();
s.data("cachedName",o)
}if(!o){return
}var r=j+o;
p.setName(r);
if(s.is(a)){if(s.is(b)){d(q,r)
}else{d(q,j)
}}})
})
}f(document).on("coral-collection:add","coral-multifield",function(g){if(this===g.target){Coral.commons.nextFrame(function(){f(this).trigger("foundation-contentloaded")
}.bind(this))
}});
f(document).on("coral-collection:add coral-collection:remove coral-multifield:itemorder",b,function(){Coral.commons.ready(this,function(g){d(g,"")
})
});
f(document).on("foundation-contentloaded",function(h){var g=f(b,h.target);
g.each(function(){Coral.commons.ready(this,function(i){d(i,"")
})
})
})
})(window,Granite.$);
(function(a,b,c){c(a).on("foundation-mode-change",function(f,g,d){if(g!=="default"&&g!=="edit"){return
}c(".foundation-layout-form").each(function(){var e=c(this);
if(d===e.data("foundationModeGroup")){var h=g==="edit";
e.toggleClass("foundation-layout-form-mode-edit",h).toggleClass("foundation-layout-form-mode-default",!h)
}})
})
})(document,window,Granite.$);
(function(k,o,l,i,p,f){var j=i(k).adaptTo("foundation-registry");
var h="selection";
var n="default";
function c(w,t){var u=function(y,z,x){if(y._foundationLayoutMasonry){return
}if(z!==n&&z!==h){return
}if(w[0].dataset.foundationModeGroup!==x){return
}b(w,t,z)
};
i(o).on("foundation-mode-change",u);
var s=function(C){if(C.originalEvent.touches.length>1){return
}if(w.data("foundation-layout-masonry.internal.isSelectionMode")){return
}var B=10;
var z=".foundation-layout-masonry-touch";
var x=C.originalEvent.touches[0];
x={x:x.clientX,y:x.clientY};
var y=this;
var D=setTimeout(function(){i(o).off(z);
var E=w.adaptTo("foundation-selections");
E.select(y);
i(y).data("foundation-layout-masonry.internal.avoidSelecting",true)
},500);
var A=function(){clearTimeout(D);
i(o).off(z)
};
i(o).on("touchmove"+z,function(E){var F=E.originalEvent.touches[0];
if(Math.abs(F.clientX-x.x)>B||Math.abs(F.clientY-x.y)>B){A()
}}).on("touchend"+z,A).on("touchcancel"+z,A)
};
var v=function(C){if(C.originalEvent.button!==0||!C.originalEvent.isPrimary){return
}if(w.data("foundation-layout-masonry.internal.isSelectionMode")){return
}var B=10;
var z=".foundation-layout-masonry-pointer";
var y={x:C.originalEvent.clientX,y:C.originalEvent.clientY};
var x=this;
var D=setTimeout(function(){i(o).off(z);
var E=w.adaptTo("foundation-selections");
E.select(x);
i(x).data("foundation-layout-masonry.internal.avoidSelecting",true)
},500);
var A=function(){clearTimeout(D);
i(o).off(z)
};
i(o).on("pointermove"+z,function(E){if(Math.abs(E.originalEvent.clientX-y.x)>B||Math.abs(E.originalEvent.clientY-y.y)>B){A()
}}).on("pointerup"+z,A).on("pointercancel"+z,A)
};
if(navigator.pointerEnabled){w.on("pointerdown","coral-masonry-item",v)
}else{w.on("touchstart","coral-masonry-item",s)
}return function(){i(o).off("foundation-mode-change",u);
w.off("touchstart","coral-masonry-item",s);
w.off("pointerdown","coral-masonry-item",v)
}
}function d(u,s){var t=function(F){var C=F.originalEvent.detail;
var J=C.item;
var B=J.dragAction;
var x=B.dropZone;
var H=C.before;
var I=C.oldBefore;
var z=s.itemReorderAction;
if(!z){return
}var y=H?H.dataset.foundationCollectionItemId:undefined;
var E=y?y.substring(y.lastIndexOf("/")+1):undefined;
var w=f.expand(z,{item:J.dataset.foundationCollectionItemId,before:y,beforeName:E});
var v=w;
var A;
var D=w.indexOf("?");
if(D>=0){v=w.substring(0,D);
A=w.substring(D+1)
}var G=i(k).adaptTo("foundation-ui");
G.wait();
i.ajax({url:v,method:"POST",data:A}).always(function(){G.clearWait()
}).fail(function(){var L=l.I18n.get("Error");
var K=l.I18n.get("Fail to reorder.");
G.alert(L,K,"error");
if(I){i(J).insertBefore(I.nextSibling)
}else{i(J).insertBefore(x.firstChild)
}})
};
u.on("coral-masonry:order",t);
return function(){u.off("coral-masonry:order",t)
}
}function a(u,s){var t=function(v){v.preventDefault();
v.stopImmediatePropagation()
};
u[0].addEventListener("coral-dragaction:dragend",t,true);
return function(){u[0].removeEventListener("coral-dragaction:dragend",t,true)
}
}function q(x,s){var u=function(A){var y=!A.hasClass("foundation-selections-item");
var z=x.adaptTo("foundation-selections");
if(y){var B=x[0].dataset.foundationSelectionsMode;
if(B==="single"){x.children(".foundation-selections-item").removeClass("foundation-selections-item").prop("selected",false)
}z.select(A[0])
}else{z.deselect(A[0])
}};
var w=function(A){var z=i(A.target).closest(".foundation-collection, .foundation-collection-item, coral-quickactions");
if(!z.hasClass("foundation-collection-item")){return
}var y=x.data("foundation-layout-masonry.internal.isSelectionMode");
if(!y){return
}A.preventDefault();
A.stopPropagation();
if(z.data("foundation-layout-masonry.internal.avoidSelecting")){z.removeData("foundation-layout-masonry.internal.avoidSelecting");
return
}u(z)
};
var t=function(A){var z=p.Keys.keyToCode("space");
if(A.keyCode!==z){return
}var y=i(A.target);
if(!y.is("coral-masonry-item")){return
}A.preventDefault();
u(y)
};
var v=function(){if(o.activeElement===x[0]||x[0].contains(o.activeElement)){x.adaptTo("foundation-selections").clear()
}};
x[0].addEventListener("click",w,true);
x.on("keydown","coral-masonry-item.foundation-collection-item",t);
p.keys.on("escape",v);
return function(){x[0].removeEventListener("click",w,true);
x.off("keydown","coral-masonry-item.foundation-collection-item",t);
p.keys.off("escape",v)
}
}function b(z,s,y,u){var t=y===h;
var x=z.data("foundation-layout-masonry.internal.isSelectionMode");
if(x===t){return
}if(!u&&!t){z.children(".foundation-selections-item").removeClass("foundation-selections-item").prop("selected",false)
}z.data("foundation-layout-masonry.internal.isSelectionMode",t);
if(y===h){z.addClass("is-selectable")
}else{z.removeClass("is-selectable")
}if(u){var w=z[0].dataset.foundationModeGroup;
if(!w){return
}var v=i.Event("foundation-mode-change");
v._foundationLayoutMasonry=true;
z.trigger(v,[y,w])
}}function m(v,s){var u=v[0].dataset.foundationCollectionSrc;
var y=v[0].dataset.foundationLayoutMasonryHasmore;
if(!u||y==="false"){return
}var t=s.scrollSrc?v.closest(s.scrollSrc):v.parent();
var x=i(k).adaptTo("foundation-util-paginator");
var w=new x({el:t,limit:s.limit||20,resolveURL:function(z){return f.expand(u,{offset:z.offset,limit:z.limit,id:v[0].dataset.foundationCollectionId})
},processResponse:function(C,A){var z=i.Deferred();
var B=i(k).adaptTo("foundation-util-htmlparser");
B.parse(A).then(function(F){var G=i(F).children();
if(!G.hasClass("foundation-collection")){return
}var E=G.children(".foundation-collection-item").toArray();
var D=v.adaptTo("foundation-collection");
D.append(E);
var H=G[0].dataset.foundationLayoutMasonryHasmore;
if(H==="true"){H=true
}else{if(H==="false"){H=false
}else{H=E.length>=C.limit
}}z.resolve({length:E.length,hasNext:H})
});
return z.promise()
}});
v.data("foundation-layout-masonry.internal.paginator",w);
setTimeout(function(){var z=v.children(".foundation-collection-item").length;
w.start(z)
},500);
return function(){w.destroy();
v.removeData("foundation-layout-masonry.internal.paginator")
}
}function r(w,t){var s=function(x){w.adaptTo("foundation-collection-item-action").execute(x)
};
var v=function(y){var x=i(y.target).closest("button, a, coral-quickactions-item, .foundation-collection-item");
if(x.hasClass("foundation-layout-masonry-cardwrapper")){if(y.which===1&&!y.metaKey&&!y.shiftKey&&!y.altKey){y.preventDefault();
s(x.closest(".foundation-collection-item")[0])
}return
}if(x.hasClass("foundation-collection-item")){y.preventDefault();
s(x[0])
}};
var u=function(x){var y=p.Keys.keyToCode("enter");
if(x.keyCode!==y||!i(x.target).is("coral-masonry-item")){return
}if(!w.data("foundation-layout-masonry.internal.isSelectionMode")){s(x.target)
}};
w.on("click",".foundation-collection-item",v);
w.on("keydown","coral-masonry-item",u);
return function(){w.off("click",".foundation-collection-item",v);
w.off("keydown","coral-masonry-item",u)
}
}function e(v,u){var t=function(x){var w=v.data("foundation-layout-masonry.internal.isSelectionMode");
if(w){x.preventDefault()
}};
var s=function(y){if(i(y.explicitOriginalTarget).hasClass("coral-QuickActions-button")){y.preventDefault();
y.stopImmediatePropagation()
}var x=i(y.target).closest(".foundation-collection-item");
var w=x.find("coral-quickactions");
if(w.length){w[0].open=w[0].open?false:true
}};
v.on("coral-overlay:beforeopen","coral-quickactions",t);
v[0].addEventListener("coral-dragaction:dragstart",s,true);
v[0].addEventListener("coral-dragaction:dragend",s,true);
return function(){v.off("coral-overlay:beforeopen","coral-quickactions",t);
v[0].removeEventListener("coral-dragaction:dragstart",s,true);
v[0].removeEventListener("coral-dragaction:dragend",s,true)
}
}function g(t){var s=o.querySelector(".granite-collection-pagetitle");
t.find("coral-card.foundation-collection-navigator").wrap(function(){var u=i(this);
if(u.parent("a").length){return
}var w=o.createElement("a");
w.className="foundation-layout-masonry-cardwrapper";
w.tabIndex=-1;
var v=u[0].dataset.foundationCollectionNavigatorHref;
if(v){w.target=u[0].dataset.foundationCollectionNavigatorTarget
}else{if(!s){return
}if(!t.is(s.dataset.graniteCollectionPagetitleTarget)){return
}v=f.expand(s.dataset.graniteCollectionPagetitleSrc,{id:u.closest(".foundation-collection-item")[0].dataset.foundationCollectionItemId})
}w.href=v;
return i(w)
})
}j.register("foundation.layouts",{name:"foundation-layout-masonry",doLayout:function(w,u){var y=i(w);
if(!y.hasClass("foundation-collection")){return
}if(y.data("foundation-layout-masonry.internal.init")){return
}var s=[];
s.push((function(){y.data("foundation-layout-masonry.internal.stack",s);
return function(){y.removeData("foundation-layout-masonry.internal.stack")
}
})());
s.push((function(){y.data("foundation-layout-masonry.internal.init",true);
return function(){y.removeData("foundation-layout-masonry.internal.init")
}
})());
s.push(c(y,u));
s.push(q(y,u));
s.push(m(y,u));
s.push(r(y,u));
s.push(e(y,u));
s.push(a(y,u));
s.push(d(y,u));
g(y);
var t=y.data("foundation-layout-collection-switcher.internal.selectionIds");
var v=i();
if(t){v=y.children(".foundation-collection-item").filter(function(){return t.indexOf(this.dataset.foundationCollectionItemId)>=0
});
v.each(function(){i(this).attr("selected","").addClass("foundation-selections-item")
})
}var x=u.selectionMode||v.length?h:n;
requestAnimationFrame(function(){b(y,u,x,true);
y.trigger("foundation-selections-change")
})
},clean:function(u,t){var v=i(u);
var s=v.data("foundation-layout-masonry.internal.stack");
if(s){l.UI.Foundation.Utils.everyReverse(s,function(w){if(w){w()
}return true
})
}v.removeData("foundation-layout-masonry.internal.isSelectionMode");
l.UI.Foundation.Layouts.clean(u)
}});
j.register("foundation.adapters",{type:"foundation-collection",selector:".foundation-layout-masonry.foundation-collection",adapter:function(s){var u=i(s);
var t=function(A,v,y){var z=s.dataset.foundationCollectionSrc;
if(!v){var x=u.data("foundationLayout");
v=x.limit||20
}var w=f.expand(z,{offset:0,limit:v,id:A});
return i.ajax({url:w,cache:false}).then(function(C){var B=i.Deferred();
var D=i(k).adaptTo("foundation-util-htmlparser");
D.parse(C).then(function(F){var G=i(F).children();
if(!G.hasClass("foundation-collection")){B.reject(new Error("Invalid content"));
return
}if(y){var E=u.children(".foundation-selections-item").map(function(){return this.dataset.foundationCollectionItemId
}).toArray();
G.data("foundation-layout-collection-switcher.internal.selectionIds",E)
}l.UI.Foundation.Layouts.cleanAll(s);
G.replaceAll(u);
requestAnimationFrame(function(){G.trigger("foundation-collection-navigate")
});
G.trigger("foundation-contentloaded");
if(y){G.removeData("foundation-layout-collection-switcher.internal.selectionIds")
}B.resolve(G)
});
return B.promise()
},function(){var D=l.I18n.get("Error");
var B=l.I18n.get("Fail to load data.");
var C=i(k).adaptTo("foundation-ui");
C.alert(D,B,"error")
})
};
return{append:function(v){u.append(v);
g(u);
u.trigger("foundation-contentloaded")
},clear:function(){u.children(".foundation-collection-item").remove()
},getPagination:function(){var v=u.data("foundation-layout-masonry.internal.paginator");
if(!v){return null
}return{offset:v.offset,limit:v.limit}
},load:function(v){return t(v)
},reload:function(){var w;
var v=this.getPagination();
if(v){w=v.offset
}return t(s.dataset.foundationCollectionId,w,true)
}}
}});
j.register("foundation.adapters",{type:"foundation-collection-meta",selector:".foundation-layout-masonry.foundation-collection",adapter:function(t){var v=i(t);
var u=v.children(".foundation-collection-meta");
var s=u[0];
if(!s){return null
}return{getElement:function(){return s
},getTitle:function(){return s.dataset.foundationCollectionMetaTitle
},getThumbnail:function(){return u.children(".foundation-collection-meta-thumbnail")[0]
},isFolder:function(){return s.dataset.foundationCollectionMetaFolder==="true"
},getRelationship:function(){return s.dataset.foundationCollectionMetaRel
}}
}});
j.register("foundation.adapters",{type:"foundation-selections",selector:".foundation-layout-masonry.foundation-collection",adapter:function(t){var u=i(t);
var s=u.data("foundationLayout");
return{count:function(){return u.children(".foundation-selections-item").length
},clear:function(v){u.children(".foundation-selections-item").removeClass("foundation-selections-item").prop("selected",false);
if(!v){u.trigger("foundation-selections-change")
}if(s.autoDefaultMode){b(u,s,n,true)
}},select:function(v){var w=i(v);
if(!w.is(".foundation-collection-item")){return
}b(u,u.data("foundationLayout"),h,true);
v.selected=true;
w.addClass("foundation-selections-item");
u.trigger("foundation-selections-change")
},deselect:function(v){var w=i(v);
if(!w.is(".foundation-collection-item")){return
}v.selected=false;
w.removeClass("foundation-selections-item");
u.trigger("foundation-selections-change");
if(s.autoDefaultMode&&!u.find(".foundation-selections-item").length){b(u,s,n,true)
}}}
}})
})(window,document,Granite,Granite.$,Coral,Granite.URITemplate);
(function(k,p,f,d,q){var r=".foundation-layout-wizard2";
var c=new WeakMap();
var j=f(k).adaptTo("foundation-registry");
function b(s){var t={};
s.find(":input").each(function(){var u=f(this);
u.serializeArray().forEach(function(w){var x=w.name;
var z=w.value;
var B;
if(t.hasOwnProperty(x)){var v=t[x];
if(!Array.isArray(v)){v=[v]
}v.push(z);
B=v
}else{B=z
}t[x]=B;
var y=f(u).attr("data-foundation-uritemplate-parent");
if(y){var A=t[y]=t[y]||{};
A[x]=t[x]
}})
});
return t
}function o(t){if(t.data("foundationWizardStepValidation")===false){return true
}var s=t.data("foundation-wizard-step.internal.valid");
if(s!==undefined){return s
}var u=true;
t.adaptTo("foundation-validation-helper").getSubmittables().forEach(function(w){var x=f(w).adaptTo("foundation-validation");
if(!x.checkValidity()){u=false
}x.updateUI()
});
return u
}function e(u){var s=[];
var t=u.data("foundation-wizard-step.internal.children");
if(t){t.each(function(){var v=f(this);
var w=v.data("foundation-layout-wizard2.internal.actualStep");
if(!w){w=v
}s.push(w);
f.merge(s,e(v))
})
}return s
}function i(y,x,v){if(!o(x)){return
}var t=y.adaptTo("foundation-wizard");
var s=v.data("foundationWizardControlSrc");
if(!s){t.next();
return
}var B=f(t.getPrevSteps(x[0])).add(x);
var A=b(B);
var u=d.expand(s,A);
var C="foundation-wizard-control.internal.lastURL";
var w=v.data(C);
if(w===u){t.next();
return
}v.data(C,u);
var z=f(k).adaptTo("foundation-ui");
z.wait();
f.ajax({url:u,cache:false}).done(function(D){var E=f(k).adaptTo("foundation-util-htmlparser");
E.parse(D).then(function(G){var F=f(G.querySelectorAll(".foundation-wizard-step"));
t.remove(e(x));
x.data("foundation-wizard-step.internal.children",F);
t.appendAfter(F.toArray(),x[0]);
t.next();
z.clearWait()
})
}).fail(function(){z.clearWait();
var E=p.I18n.get("Error");
var D=p.I18n.get("Something went wrong.");
z.alert(E,D,"error")
})
}function m(t){var s=function(z){var y=f(this);
var x=y.data("foundationWizardControlAction");
var u=y.closest("coral-panel");
if(!u.prop("selected")){z.preventDefault();
return
}var v=t.find(".foundation-wizard-step-active");
if(x==="next"){if(y.prop("type")==="button"){z.preventDefault()
}i(t,v,y)
}else{if(x==="prev"){z.preventDefault();
var w=t.adaptTo("foundation-wizard");
w.prev()
}}};
t.on("click",".foundation-wizard-control",s);
return function(){t.off("click",".foundation-wizard-control",s)
}
}j.register("foundation.layouts",{name:"foundation-layout-wizard2",doLayout:function(u,t){h(u);
var v=f(u);
if(!v.hasClass("foundation-wizard")){return
}if(v.data("foundation-layout-wizard2.internal.init")===true){return
}var s=[];
s.push((function(){v.data("foundation-layout-wizard2.internal.stack",s);
return function(){v.removeData("foundation-layout-wizard2.internal.stack")
}
})());
s.push((function(){v.data("foundation-layout-wizard2.internal.init",true);
return function(){v.removeData("foundation-layout-wizard2.internal.init")
}
})());
s.push(m(v));
var w=v.find(".foundation-wizard-step").first();
if(w.length){requestAnimationFrame(function(){w.addClass("foundation-wizard-step-active");
v.trigger("foundation-wizard-stepchange",[w[0]])
})
}},clean:function(u,t){n(u);
var s=f(u).data("foundation-layout-wizard2.internal.stack");
if(s){p.UI.Foundation.Utils.everyReverse(s,function(w){if(w){w()
}return true
})
}p.UI.Foundation.Layouts.clean(u)
}});
j.register("foundation.adapters",{type:"foundation-wizard",selector:".foundation-layout-wizard2.foundation-wizard",adapter:function(s){var t=f(s);
var u=function(x){var A=x.attr("data-foundation-wizard-step-title");
var v=x.children(".foundation-wizard-control").detach().addClass("foundation-layout-inline2-item");
var y=x.children(".foundation-wizard-step-content").removeClass("foundation-wizard-step-content").addClass("foundation-wizard-step");
if(y.length===0){y=x
}else{x.data("foundation-layout-wizard2.internal.actualStep",y)
}var B=new q.Panel();
y.appendTo(B.content);
var w=document.createElement("div");
w.className="foundation-layout-inline2 foundation-layout-inline2-gap";
var z=new q.Panel();
z.content.appendChild(w);
v.appendTo(w);
return{step:new q.Step().set({label:{textContent:A}}),content:B,control:z}
};
return{toggleNext:function(v){this.toggle("next",v)
},togglePrev:function(v){this.toggle("prev",v)
},toggleCancel:function(v){this.toggle("cancel",v)
},toggle:function(x,v){var w=t.find(".foundation-layout-wizard2-controls > coral-panel[selected] .foundation-wizard-control[data-foundation-wizard-control-action="+x+"]");
w.prop("disabled",!v)
},next:function(){var z=t.find(".foundation-layout-wizard2-contents > coral-panel[selected]");
var y=z.next("coral-panel");
if(!y.length){return
}var w=y.index();
t.find(".foundation-layout-wizard2-steplist > coral-step").eq(w).attr("selected","");
y.attr("selected","");
t.find(".foundation-layout-wizard2-controls > coral-panel").eq(w).attr("selected","");
var x=z.find(".foundation-wizard-step").removeClass("foundation-wizard-step-active");
var v=y.find(".foundation-wizard-step").addClass("foundation-wizard-step-active");
t.trigger("foundation-wizard-stepchange",[v[0],x[0]])
},prev:function(){var z=t.find(".foundation-layout-wizard2-contents > coral-panel[selected]");
var y=z.prev("coral-panel");
if(!y.length){return
}var x=y.index();
t.find(".foundation-layout-wizard2-steplist > coral-step").eq(x).attr("selected","");
y.attr("selected","");
t.find(".foundation-layout-wizard2-controls > coral-panel").eq(x).attr("selected","");
var w=z.find(".foundation-wizard-step").removeClass("foundation-wizard-step-active");
var v=y.find(".foundation-wizard-step").addClass("foundation-wizard-step-active");
t.trigger("foundation-wizard-stepchange",[v[0],w[0]])
},append:function(v,x){var w=t.find(".foundation-layout-wizard2-contents > coral-panel");
var y;
if(x===undefined){y=w[w.length-1]
}else{y=w[x]
}this.appendAfter(v,y.querySelector(".foundation-wizard-step"))
},appendAfter:function(x,w){var y=[];
var A=[];
var v=[];
x.forEach(function(E){var D=u(f(E));
y.push(D.step);
A.push(D.content);
v.push(D.control)
});
var z=f(w).closest("coral-panel");
var B=z.index();
t.find(".foundation-layout-wizard2-steplist > coral-step").eq(B).after(y);
z.after(A);
t.find(".foundation-layout-wizard2-controls > coral-panel").eq(B).after(v);
t.trigger("foundation-contentloaded");
var C=t.data("foundation-layout-wizard2.internal.resizeController");
if(C){C.updateElement(t.find(".foundation-layout-wizard2-steplist")[0])
}},remove:function(x){var w=t.find(".foundation-layout-wizard2-steplist > coral-step");
var v=t.find(".foundation-layout-wizard2-controls > coral-panel");
var y=[];
f(x).each(function(){var C=f(this);
var A=C.closest("coral-panel");
var B=A.index();
y.push(A[0],w[B],v[B])
});
f(y).detach();
var z=t.data("foundation-layout-wizard2.internal.resizeController");
if(z){z.updateElement(t.find(".foundation-layout-wizard2-steplist")[0])
}},getPrevSteps:function(v){return f(v).closest("coral-panel").prevAll("coral-panel").find(".foundation-wizard-step").toArray()
}}
}});
function h(u){var v=f(u);
var x=v.data("foundation-layout-wizard2.internal.resizeController");
if(!x){var t=v.find(".foundation-layout-wizard2-header > .foundation-layout-wizard2-steplist");
var w=v.find(".foundation-layout-wizard2-header > .foundation-layout-wizard2-title");
var s=v.find(".foundation-layout-wizard2-header > .foundation-layout-wizard2-controls");
var x=new a({elements:[new l({element:t[0],states:[new g({fn:function(z){var y=z||this.element;
y.setAttribute("size","L")
}}),new g({fn:function(z){var y=z||this.element;
y.setAttribute("size","S")
}})]}),new l({element:w[0]}),new l({element:s[0]})],container:t[0].parentElement});
x.measureElements().then(function(){var y=function(z){requestAnimationFrame(function(){x.checkResize()
})
};
q.commons.addResizeListener(u,y);
c.set(u,y);
x.checkResize()
});
v.data("foundation-layout-wizard2.internal.resizeController",x)
}}function n(s){if(c.get(s)){q.commons.removeResizeListener(s,c.get(s));
c["delete"](s)
}var t=f(s);
var u=t.data("foundation-layout-wizard2.internal.resizeController");
if(u){u.clean();
f.removeData(t,"foundation-layout-wizard2.internal.resizeController")
}}function g(s){this.fn=s.fn
}g.prototype.clean=function(){this.fn=null
};
function l(s){this.element=s.element;
this.currentState=0;
this.measuredWidth=-1;
this.states=s.states
}l.prototype.measure=function(v){var u=f.Deferred();
var s=f(this.element).clone().css({display:"inline-block",width:"auto",visibility:"hidden"}).appendTo("body");
if(v&&this.states&&this.states.length){this.states[0].fn.call(this,s[0])
}var t=this;
q.commons.ready(this.element,function(){t.previousMeasuredWidth=t.measuredWidth;
t.measuredWidth=s.outerWidth(true);
u.resolve(t.measuredWidth);
s.remove()
});
return u.promise()
};
l.prototype.goToNextState=function(){if(this.states&&this.states.length&&this.currentState<this.states.length-1){this.states[++this.currentState].fn.call(this);
return true
}return false
};
l.prototype.goToPreviousState=function(){if(this.states&&this.states.length&&this.currentState>0){this.states[--this.currentState].fn.call(this);
return true
}return false
};
l.prototype.overflows=function(){return this.element.offsetWidth<this.measuredWidth
};
l.prototype.clean=function(){this.element=null;
this.config=null;
this.states.forEach(function(s){s.clean()
});
this.states=null
};
function a(s){this.config=s;
this.totalWidth=0;
this.elementsMap=new WeakMap();
for(var t=0;
t<this.config.elements.length;
++t){this.elementsMap.set(this.config.elements[t].element,this.config.elements[t])
}}a.prototype.measureElements=function(){var t=f.Deferred();
var s=this;
var u=this.config.elements.map(function(v){return v.measure()
});
f.when.apply(f,u).then(function(){for(var v=0;
v<arguments.length;
++v){s.totalWidth+=arguments[v]||0
}t.resolve(s.totalWidth)
});
return t.promise()
};
a.prototype.elementsOverflow=function(){return f(this.config.container).width()<this.totalWidth
};
a.prototype.checkResize=function(){if(this.elementsOverflow()){if(!this.hasOverflow){for(var t=0;
t<this.config.elements.length;
++t){var s=this.config.elements[t];
if(s.goToNextState()){this.hasOverflow=true;
break
}}}}else{if(this.hasOverflow){for(var t=0;
t<this.config.elements.length;
++t){var s=this.config.elements[t];
if(s.goToPreviousState()){this.hasOverflow=false;
break
}}}}};
a.prototype.updateElement=function(v){var t=this.elementsMap.get(v);
var u=this;
if(t){var s=t.measuredWidth;
t.measure(true).then(function(w){u.totalWidth-=s;
u.totalWidth+=w;
u.checkResize()
})
}};
a.prototype.clean=function(){this.config.elements.forEach(function(s){s.clean()
});
this.config=null;
this.elementsMap=null
}
})(window,Granite,Granite.$,Granite.URITemplate,Coral);
(function(h,e,c){var g=e(h).adaptTo("foundation-registry");
function l(u){return e(u[0].selectedItems)
}function k(w,v){w.data("foundation-layout-columnview.internal.bulkSelection",true);
var u=v();
w.removeData("foundation-layout-columnview.internal.bulkSelection");
return u
}function s(u,v){u[0].dataset.foundationCollectionId=v;
u.removeData("foundationCollectionId")
}function b(w,u){var v=function(y,z,x){if(y._foundationLayoutColumnview){return
}if(z!=="default"){return
}if(w[0].dataset.foundationModeGroup!==x){return
}k(w,function(){l(w).prop("selected",false)
});
w.children("coral-columnview-preview").remove();
w.trigger("foundation-selections-change")
};
e(document).on("foundation-mode-change",v);
return function(){e(document).off("foundation-mode-change",v)
}
}function p(w,u){var v=function(C){var B=e(C.originalEvent.detail.selection);
var A=e(C.originalEvent.detail.oldSelection);
A.removeClass("foundation-selections-item");
B.addClass("foundation-selections-item");
if(!w.data("foundation-layout-columnview.internal.bulkSelection")){if(B.length){var y=w[0].dataset.foundationCollectionId;
var z;
if(w[0].activeItem){z=w[0].activeItem.dataset.foundationCollectionItemId
}else{z=w.children("coral-columnview-column")[0].dataset.foundationLayoutColumnviewColumnid
}if(z!==y){w.data("foundation-layout-columnview.internal.delaySelectionEvent",{selections:B,prevSelections:A})
}else{a(w,false,B,A);
w.trigger("foundation-selections-change")
}}else{a(w,false,B,A);
w.trigger("foundation-selections-change")
}if(B.length===1&&w[0].dataset.foundationSelectionsMode!=="single"){t(w,u,B[0])
}else{w.children("coral-columnview-preview").remove()
}}};
var x=function(){if(document.activeElement===w[0]||w[0].contains(document.activeElement)){w.adaptTo("foundation-selections").clear()
}};
w.on("coral-columnview:change",v);
Coral.keys.on("escape",x);
return function(){w.off("coral-columnview:change",v);
Coral.keys.off("escape",x)
}
}function r(w,u){var v=function(y){var x=y.originalEvent.detail.column;
s(w,x.dataset.foundationLayoutColumnviewColumnid);
w.trigger("foundation-collection-navigate");
w.trigger("foundation-selections-change");
var A="foundation-layout-columnview.internal.delaySelectionEvent";
var z=w.data(A);
if(z){w.removeData(A);
a(w,false,z.selections,z.prevSelections)
}};
w.on("coral-columnview:navigate",v);
return function(){w.off("coral-columnview:navigate",v)
}
}function t(z,x,y,v){if(!x.previewSrc){return
}var A=y.dataset.foundationCollectionItemId;
var w=c.expand(x.previewSrc,{id:A});
var u=function(B){return m(B).then(function(C){var E=C.column;
if(e(E).is("coral-columnview-preview")){E.dataset.foundationLayoutColumnviewColumnid=A
}if(v){z.children("coral-columnview-preview").replaceWith(E)
}else{var D=e(y).closest("coral-columnview-column")[0];
z[0].setNextColumn(E,D)
}})
};
e.ajax({url:w,cache:false}).then(u,function(){var D=Granite.I18n.get("Error");
var B=Granite.I18n.get("Fail to load data.");
var C=e(h).adaptTo("foundation-ui");
C.alert(D,B,"error")
})
}function a(B,y,x,w){var A=B[0].dataset.foundationModeGroup;
if(!A){return
}var z=x?x.length:B.adaptTo("foundation-selections").count();
var v=w?w.length:0;
var u=function(D){var C=e.Event("foundation-mode-change");
C._foundationLayoutColumnview=true;
B.trigger(C,[D,A])
};
if((v===0||y)&&z>0){u("selection")
}else{if((v>0||y)&&z===0){u("default")
}}}function n(u){return u.find("coral-columnview-column[data-foundation-layout-columnview-lazy='true']").length===0
}function o(w,u){var v=function(H){var x=w[0].dataset.foundationCollectionSrc;
if(!x){return
}var G=H.originalEvent.detail;
var K=H.target;
var A=G.column;
var F=G.item;
var y;
var D=u.limit||20;
var J;
if(F){var I=F.variant!=="drilldown";
var z=F.dataset.foundationCollectionItemId;
if(!I){y=c.expand(x,{offset:G.start,limit:D,id:z})
}else{if(u.previewSrc){y=c.expand(u.previewSrc,{id:z})
}else{var C=K.columns.getAll();
var B=C.indexOf(A);
for(var E=C.length-1;
B>=0&&E>B;
E--){K.columns.remove(C[E])
}}}J=function(L){return m(L).then(function(M){var O=M.column;
var N=e(O);
if(N.is("coral-columnview-preview")){O.dataset.foundationLayoutColumnviewColumnid=z
}else{N.data("foundation-layout-columnview.internal.pagination",{offset:N.find(".foundation-collection-item").length,limit:D})
}K.setNextColumn(O,A);
if(w.data("foundation-layout-collection.internal.columnviewReloaded")&&n(w)){requestAnimationFrame(function(){w.trigger("foundation-collection-navigate")
})
}})
}
}else{if(A.dataset.foundationLayoutColumnviewHasmore==="false"){return
}y=c.expand(x,{offset:G.start,limit:D,id:A.dataset.foundationLayoutColumnviewColumnid});
J=function(L){return f(L).then(function(M){var N=M.items;
if(A.dataset.foundationLayoutColumnviewLazy){e(A.content).empty();
delete A.dataset.foundationLayoutColumnviewLazy;
if(M.meta){A.content.appendChild(M.meta)
}N.forEach(function(P){if(A.dataset.foundationLayoutColumnviewActiveitem===P.dataset.foundationCollectionItemId){delete A.dataset.foundationLayoutColumnviewActiveitem;
CustomElements.upgrade(P);
P.set("active",true,true);
A._oldActiveItem=P
}})
}N.forEach(function(P){A.items.add(P)
});
var O=M.hasMore;
if(O===undefined){O=N.length>=D
}A.dataset.foundationLayoutColumnviewHasmore=""+O;
e(A).data("foundation-layout-columnview.internal.pagination",{offset:A.items.getAll().length,limit:D});
if(w.data("foundation-layout-collection.internal.columnviewReloaded")&&n(w)){requestAnimationFrame(function(){w.trigger("foundation-collection-navigate")
})
}})
}
}if(y){e.ajax({url:y,cache:false}).then(J,function(){var N=Granite.I18n.get("Error");
var L=Granite.I18n.get("Fail to load data.");
var M=e(h).adaptTo("foundation-ui");
M.alert(N,L,"error")
})
}};
w.on("coral-columnview:loaditems",v);
return function(){w.off("coral-columnview:loaditems",v)
}
}function f(u){var v=e(h).adaptTo("foundation-util-htmlparser");
return v.parse(u).then(function(w){var y=e(w).children();
var x;
if(y.is("coral-columnview-column")){x=y
}else{x=y.find("coral-columnview-column").last()
}var z=x[0].dataset.foundationLayoutColumnviewHasmore;
if(z==="true"){z=true
}else{if(z==="false"){z=false
}}return{items:x.find(".foundation-collection-item").toArray(),hasMore:z,meta:x.find(".foundation-collection-meta")[0]}
})
}function m(u){var v=e(h).adaptTo("foundation-util-htmlparser");
return v.parse(u).then(function(w){var y=e(w).children();
var x;
if(y.is("coral-columnview-column, coral-columnview-preview")){x=y
}else{x=y.find("coral-columnview-column, coral-columnview-preview").last()
}return{column:x[0]}
})
}g.register("foundation.layouts",{name:"foundation-layout-columnview",doLayout:function(y,w){var z=e(y);
if(!z.hasClass("foundation-collection")){return
}if(z.data("foundation-layout-columnview.internal.init")){return
}var u=[];
u.push((function(){z.data("foundation-layout-columnview.internal.stack",u);
return function(){z.removeData("foundation-layout-columnview.internal.stack")
}
})());
u.push((function(){z.data("foundation-layout-columnview.internal.init",true);
return function(){z.removeData("foundation-layout-columnview.internal.init")
}
})());
var v=z.data("foundation-layout-collection-switcher.internal.selectionIds");
if(v){var x=z.find(".foundation-collection-item").filter(function(){return v.indexOf(this.dataset.foundationCollectionItemId)>=0
});
x.each(function(){e(this).attr("selected","").addClass("foundation-selections-item")
})
}u.push(b(z,w));
u.push(r(z,w));
u.push(p(z,w));
u.push(o(z,w));
requestAnimationFrame(function(){a(z,true);
z.trigger("foundation-selections-change")
})
},clean:function(w,v){var x=e(w);
var u=x.data("foundation-layout-columnview.internal.stack");
if(u){Granite.UI.Foundation.Utils.everyReverse(u,function(y){if(y){y()
}return true
})
}Granite.UI.Foundation.Layouts.clean(w)
}});
function j(x,w,y){var v="coral-columnview-column";
if(w){v+=", coral-columnview-preview"
}var u;
e(x).children(v).each(function(){if(this.dataset.foundationLayoutColumnviewColumnid===y){u=this;
return false
}});
return u
}function i(v,u){return j(v,u,v.dataset.foundationCollectionId)
}function q(y,z){var w=y[0];
var x=w.dataset.foundationCollectionSrc;
var v=y.data("foundationLayout");
var u=c.expand(x,{offset:0,limit:v.limit||20,id:z});
return e.ajax({url:u,cache:false}).then(function(A){var B=e(h).adaptTo("foundation-util-htmlparser");
Granite.UI.Foundation.Layouts.cleanAll(y[0]);
B.parse(A).then(function(C){var D=e(C).children();
D.data("foundation-layout-collection.internal.columnviewLoaded",y.data("foundation-layout-collection.internal.columnviewLoaded"));
D.replaceAll(y);
D.data("foundation-layout-collection.internal.columnviewReloaded",true);
D.trigger("foundation-contentloaded")
})
},function(){var C=Granite.I18n.get("Error");
var A=Granite.I18n.get("Fail to load data.");
var B=e(h).adaptTo("foundation-ui");
B.alert(C,A,"error")
})
}function d(D,E,x){var z=D[0];
var v=j(z,true,x);
var F=null;
var A=null;
if(v&&v.previousElementSibling){F=v.previousElementSibling.dataset.foundationLayoutColumnviewColumnid;
if(v.previousElementSibling.activeItem){A=v.previousElementSibling.activeItem.dataset.foundationCollectionItemId
}}var B=D.data("foundationLayout");
var u=z.dataset.foundationCollectionSrc;
var C;
var G=e(v).data("foundation-layout-columnview.internal.pagination");
if(G){C=G.offset
}else{C=B.limit||20
}var w=c.expand(u,{offset:0,limit:C,id:x});
var y=l(D);
if(y.length===1&&D[0].dataset.foundationSelectionsMode!=="single"){t(D,B,y[0],true)
}return e.ajax({url:w,cache:false}).then(function(H){return m(H).then(function(I){var N=I.column;
var M=e(N);
var K=l(D);
var L=K.map(function(){return this.dataset.foundationCollectionItemId
}).toArray();
var J=e(N).find(".foundation-collection-item").filter(function(){var O=L.indexOf(this.dataset.foundationCollectionItemId)>=0;
if(O){e(this).attr("selected","").addClass("foundation-selections-item")
}return O
});
if((F!==null&&A!==null)&&(v.nodeName!==N.nodeName||!N.querySelector("coral-columnview-item"))){d(D,E,F).then(function(){D.data("foundation-layout-collection.internal.columnviewLoaded",false);
E.load(A);
D.trigger("foundation-collection-reload");
D.trigger("foundation-selections-change")
});
return
}else{e(v).replaceWith(N)
}M.data("foundation-layout-columnview.internal.pagination",{offset:M.find(".foundation-collection-item").length,limit:B.limit||20});
D.trigger("foundation-collection-reload");
D.trigger("foundation-selections-change");
a(D,false,J,K)
})
},function(){var J=Granite.I18n.get("Error");
var H=Granite.I18n.get("Fail to load data.");
var I=e(h).adaptTo("foundation-ui");
I.alert(J,H,"error")
}).then(function(){return z
})
}g.register("foundation.adapters",{type:"foundation-collection",selector:".foundation-layout-columnview.foundation-collection",adapter:function(u){var v=e(u);
v.data("foundation-layout-collection.internal.columnviewLoaded",true);
return{append:function(w){var x=i(u);
if(x){e(x).children("coral-columnview-column-content").append(w).trigger("foundation-contentloaded")
}},clear:function(){var w=i(u);
if(w){w.items.clear()
}},getPagination:function(){var w=e(i(u)).data("foundation-layout-columnview.internal.pagination");
if(!w){return null
}return{offset:w.offset,limit:w.limit}
},load:function(A){var y=v.find(".foundation-collection-item").filter(function(){return this.dataset.foundationCollectionItemId===A
})[0];
if(y){if(v.data("foundation-layout-collection.internal.columnviewLoaded")){v.trigger("foundation-collection-reload")
}else{v.data("foundation-layout-collection.internal.columnviewLoaded",true)
}y.click()
}else{var x=u.columns.getAll();
var z=x.find(function(B){return B.dataset.foundationLayoutColumnviewColumnid===A
});
if(!z){q(v,A);
return
}var w=k(v,function(){var C=l(v);
var B=e();
z.items.getAll().forEach(function(D){D.selected=false;
D.active=false
});
return{prevSelections:C,selections:B}
});
if(v.data("foundation-layout-collection.internal.columnviewLoaded")){v.trigger("foundation-collection-reload")
}else{v.data("foundation-layout-collection.internal.columnviewLoaded",true)
}s(v,A);
v.trigger("foundation-collection-navigate");
v.trigger("foundation-selections-change");
a(v,false,w.selections,w.prevSelections)
}return e.Deferred().resolve(u).promise()
},reload:function(){v.data("foundation-layout-collection.internal.columnviewLoaded",true);
return d(v,this,u.dataset.foundationCollectionId)
}}
}});
g.register("foundation.adapters",{type:"foundation-collection-meta",selector:".foundation-layout-columnview.foundation-collection",adapter:function(v){var u=function(){return e(i(v,true)).find(".foundation-collection-meta")
};
return{getElement:function(){return u()[0]
},getTitle:function(){var w=u();
if(w.length){return w[0].dataset.foundationCollectionMetaTitle
}return null
},getThumbnail:function(){var w=u();
if(w.length){return w.children(".foundation-collection-meta-thumbnail")[0]
}return null
},isFolder:function(){var w=u();
if(w.length){return w[0].dataset.foundationCollectionMetaFolder==="true"
}return false
},getRelationship:function(){var w=u();
if(w.length){return w[0].dataset.foundationCollectionMetaRel
}return null
}}
}});
g.register("foundation.adapters",{type:"foundation-selections",selector:".foundation-layout-columnview.foundation-collection",adapter:function(u){var v=e(u);
return{count:function(){return u.selectedItems.length
},clear:function(w){var x=k(v,function(){var z=e(u.selectedItems).prop("selected",false);
var y=e();
return{prevSelections:z,selections:y}
});
v.children("coral-columnview-preview").remove();
a(v,false,x.selections,x.prevSelections);
if(!w){v.trigger("foundation-selections-change")
}},select:function(w){var x=e(w);
if(!x.hasClass("foundation-collection-item")){return
}w.selected=true
},deselect:function(w){var x=e(w);
if(!x.hasClass("foundation-collection-item")){return
}w.selected=false
}}
}})
})(window,Granite.$,Granite.URITemplate);
(function(k,n,f,h,l){var a=h(k).adaptTo("foundation-registry");
function c(t,r){var s=function(w,x,v){if(w._foundationLayoutTable){return
}if(x!=="default"){return
}if(t[0].dataset.foundationModeGroup!==v){return
}t.data("foundation-layout-table.internal.bulkSelection",true);
var u=t.find(".foundation-selections-item").each(function(){this.selected=false
});
t.removeData("foundation-layout-table.internal.bulkSelection");
t.trigger("foundation-selections-change")
};
h(n).on("foundation-mode-change",s);
return function(){h(n).off("foundation-mode-change",s)
}
}function g(u,r){var t=function(y){var x=y.originalEvent.detail;
var z=u[0].dataset.foundationSelectionsMode;
var w=h();
var v=h();
if(z==="single"){if(x.oldSelection){v=h(x.oldSelection)
}if(x.selection){w=h(x.selection)
}}else{v=h(x.oldSelection);
w=h(x.selection)
}v.removeClass("foundation-selections-item");
w.addClass("foundation-selections-item");
if(!u.data("foundation-layout-table.internal.bulkSelection")){o(u,false,w,v);
u.trigger("foundation-selections-change")
}};
var s=function(){if(n.activeElement===u[0]||u[0].contains(n.activeElement)){u.adaptTo("foundation-selections").clear()
}};
u.on("coral-table:change",t);
Coral.keys.on("escape",s);
return function(){u.off("coral-table:change",t);
Coral.keys.off("escape",s)
}
}function o(y,v,u,t){var x=y[0].dataset.foundationModeGroup;
if(!x){return
}var w;
if(u){w=u.length
}else{w=y.adaptTo("foundation-selections").count()
}var s;
if(t){s=t.length
}else{s=0
}var r=function(A){var z=h.Event("foundation-mode-change");
z._foundationLayoutTable=true;
y.trigger(z,[A,x])
};
if((s===0||v)&&w>0){r("selection")
}else{if((s>0||v)&&w===0){r("default")
}}}function p(t,r){var s=function(z){if(r.sortMode!=="remote"){return
}var C=t.data("foundation-layout-table.internal.paginator");
if(!C){return
}var y=z.originalEvent.detail;
var x=y.column;
var A=x.sortableType;
x.sortableType="custom";
var u=t[0].dataset.foundationCollectionSrc;
var w=x.dataset.foundationLayoutTableColumnName;
var B=(function(D){switch(D){case"ascending":return"asc";
case"descending":return"desc";
case"default":return null
}})(y.direction||y.sortableDirection);
t.data("foundation-layout-table.internal.paginator.sort",{name:w,direction:B,originalSortType:A});
var v=l.expand(u,{offset:0,limit:C.limit,id:t[0].dataset.foundationCollectionId,sortName:w,sortDir:B});
h.ajax({url:v,cache:false}).then(function(D){d(D).then(function(E){var G=E.items;
var F=t.adaptTo("foundation-collection");
F.clear();
F.append(G);
var H=E.hasMore;
if(H===undefined){H=G.length>=C.limit
}C.restart(G.length,H);
x.sortableType=A
})
},function(){var F=f.I18n.get("Error");
var D=f.I18n.get("Fail to load data.");
var E=h(k).adaptTo("foundation-ui");
E.alert(F,D,"error")
})
};
t.on("coral-table:beforecolumnsort",s);
return function(){t.off("coral-table:beforecolumnsort",s)
}
}function e(w,r,t){var v=w[0].dataset.foundationCollectionSrc;
var y=w[0].dataset.foundationLayoutTableHasmore;
if(!v||y==="false"){return
}var x;
var u=function(z){var A=h(k).adaptTo("foundation-util-paginator");
x=new A({el:z,limit:r.limit||20,resolveURL:function(C){var B=w.data("foundation-layout-table.internal.paginator.sort");
return l.expand(v,{offset:C.offset,limit:C.limit,id:w[0].dataset.foundationCollectionId,sortName:B?B.name:undefined,sortDir:B?B.direction:undefined})
},processResponse:function(D,C){var B=h.Deferred();
d(C).then(function(E){var G=E.items;
var F=w.adaptTo("foundation-collection");
F.append(G);
var H=E.hasMore;
if(H===undefined){H=G.length>=D.limit
}B.resolve({length:G.length,hasNext:H})
});
return B.promise()
}});
w.data("foundation-layout-table.internal.paginator",x);
setTimeout(function(){var B=w.find(".foundation-collection-item").length;
x.start(B)
},500)
};
var s=w.children(".coral-Table-wrapper-container");
if(s.length){u(s)
}else{requestAnimationFrame(function(){u(w.children(".coral-Table-wrapper-container"))
})
}return function(){if(x){x.destroy();
w.removeData("foundation-layout-table.internal.paginator");
w.removeData("foundation-layout-table.internal.paginator.sort")
}}
}function d(r){var s=h(k).adaptTo("foundation-util-htmlparser");
return s.parse(r).then(function(u){var v=h(u).children();
if(!v.hasClass("foundation-collection")){return
}var t=v.find(".foundation-collection-item").toArray();
var w=v[0].dataset.foundationLayoutTableHasmore;
if(w==="true"){w=true
}else{if(w==="false"){w=false
}}return{items:t,hasMore:w}
})
}function j(u,s){var r=function(v){u.adaptTo("foundation-collection-item-action").execute(v)
};
var t=function(w){var v=h(w.target).closest("[coral-table-rowselect], button, a, .foundation-collection-item");
if(v.hasClass("foundation-layout-table-cellwrapper")){if(w.which===1&&!w.metaKey&&!w.shiftKey&&!w.altKey){w.preventDefault();
r(v.closest(".foundation-collection-item")[0])
}return
}if(v.hasClass("foundation-collection-item")){w.preventDefault();
r(v[0])
}};
u.on("click",".foundation-collection-item",t);
return function(){u.off("click",".foundation-collection-item",t)
}
}function q(t,r){var s=function(C){var z=C.originalEvent.detail;
var G=z.row;
var E=z.before;
var F=z.oldBefore;
var x=r.rowReorderAction;
if(!x){return
}var w=E?E.dataset.foundationCollectionItemId:undefined;
var B=w?w.substring(w.lastIndexOf("/")+1):undefined;
var v=l.expand(x,{item:G.dataset.foundationCollectionItemId,before:w,beforeName:B});
var u=v;
var y;
var A=v.indexOf("?");
if(A>=0){u=v.substring(0,A);
y=v.substring(A+1)
}var D=h(k).adaptTo("foundation-ui");
D.wait();
h.ajax({url:u,method:"POST",data:y}).always(function(){D.clearWait()
}).fail(function(){var I=f.I18n.get("Error");
var H=f.I18n.get("Fail to reorder.");
D.alert(I,H,"error");
if(F){h(G).insertBefore(F)
}else{G.parentElement.appendChild(G)
}})
};
t.on("coral-table:roworder",s);
return function(){t.off("coral-table:roworder",s)
}
}function b(r){r.find("col[is=coral-table-column]").each(function(t,u){var s=t+1;
var v=u.getAttribute("alignment");
r.find("th[is=coral-table-headercell]:nth-child("+s+"), td[is=coral-table-cell]:nth-child("+s+")").each(function(){var w=this.getAttribute("alignment");
if(!w||w==="column"){this.setAttribute("alignment",v)
}})
})
}function i(r){if(r.find("td[is=coral-table-cell][coral-table-rowselect]").length){r.attr("variant","list")
}}function m(s){var r=n.querySelector(".granite-collection-pagetitle");
s.find("tr.foundation-collection-navigator").each(function(){var t=h(this);
t.children("td:not([coral-table-rowselect]):not(:has([coral-table-rowselect]))").first().wrapInner(function(){var w=h(this);
if(w.find("a").length){return
}var v=n.createElement("a");
v.className="foundation-layout-table-cellwrapper";
var u=t[0].dataset.foundationCollectionNavigatorHref;
if(u){v.target=t[0].dataset.foundationCollectionNavigatorTarget
}else{if(!r){return
}if(!s.is(r.dataset.graniteCollectionPagetitleTarget)){return
}u=l.expand(r.dataset.graniteCollectionPagetitleSrc,{id:t.closest(".foundation-collection-item")[0].dataset.foundationCollectionItemId})
}v.href=u;
return h(v)
})
})
}a.register("foundation.layouts",{name:"foundation-layout-table",doLayout:function(v,t){var w=h(v);
if(!w.hasClass("foundation-collection")){return
}if(w.data("foundation-layout-table.internal.init")){return
}var r=[];
r.push((function(){w.data("foundation-layout-table.internal.stack",r);
return function(){w.removeData("foundation-layout-table.internal.stack")
}
})());
r.push((function(){w.data("foundation-layout-table.internal.init",true);
return function(){w.removeData("foundation-layout-table.internal.init")
}
})());
if(w[0].hasAttribute("selectable")){var s=w.data("foundation-layout-collection-switcher.internal.selectionIds");
if(s){var u=w.find(".foundation-collection-item").filter(function(){return s.indexOf(this.dataset.foundationCollectionItemId)>=0
});
u.each(function(){h(this).attr("selected","").addClass("foundation-selections-item")
})
}}r.push(c(w,t));
r.push(g(w,t));
r.push(p(w,t));
r.push(e(w,t));
r.push(j(w,t));
r.push(q(w,t));
m(w);
i(w);
b(w);
requestAnimationFrame(function(){o(w,true);
w.trigger("foundation-selections-change")
})
},clean:function(t,s){var u=h(t);
var r=u.data("foundation-layout-table.internal.stack");
if(r){f.UI.Foundation.Utils.everyReverse(r,function(w){if(w){w()
}return true
})
}f.UI.Foundation.Layouts.clean(t)
}});
a.register("foundation.adapters",{type:"foundation-collection",selector:".foundation-layout-table.foundation-collection",adapter:function(r){var t=h(r);
var s=function(z,u,x){var y=r.dataset.foundationCollectionSrc;
if(!u){var w=t.data("foundationLayout");
u=w.limit||20
}var v=l.expand(y,{offset:0,limit:u,id:z});
return h.ajax({url:v,cache:false}).then(function(B){var A=h.Deferred();
var C=h(k).adaptTo("foundation-util-htmlparser");
C.parse(B).then(function(E){var F=h(E).children();
if(!F.hasClass("foundation-collection")){A.reject(new Error("Invalid content"));
return
}if(x){var D=t.find(".foundation-selections-item").map(function(){return this.dataset.foundationCollectionItemId
}).toArray();
F.data("foundation-layout-collection-switcher.internal.selectionIds",D)
}f.UI.Foundation.Layouts.cleanAll(r);
F.replaceAll(t);
requestAnimationFrame(function(){F.trigger("foundation-collection-navigate")
});
F.trigger("foundation-contentloaded");
if(x){F.removeData("foundation-layout-collection-switcher.internal.selectionIds")
}A.resolve(F)
});
return A.promise()
},function(){var C=f.I18n.get("Error");
var A=f.I18n.get("Fail to load data.");
var B=h(k).adaptTo("foundation-ui");
B.alert(C,A,"error")
})
};
return{append:function(u){t.find("tbody").append(u);
m(t);
b(t);
i(t);
t.trigger("foundation-contentloaded")
},clear:function(){t.find(".foundation-collection-item").remove()
},getPagination:function(){var u=t.data("foundation-layout-table.internal.paginator");
if(!u){return null
}return{offset:u.offset,limit:u.limit}
},load:function(u){return s(u)
},reload:function(){var v;
var u=this.getPagination();
if(u){v=u.offset
}return s(r.dataset.foundationCollectionId,v,true)
}}
}});
a.register("foundation.adapters",{type:"foundation-collection-meta",selector:".foundation-layout-table.foundation-collection",adapter:function(s){var u=h(s);
var t=u.find("> caption > .foundation-collection-meta");
var r=t[0];
if(!r){return null
}return{getElement:function(){return r
},getTitle:function(){return r.dataset.foundationCollectionMetaTitle
},getThumbnail:function(){return t.children(".foundation-collection-meta-thumbnail")[0]
},isFolder:function(){return r.dataset.foundationCollectionMetaFolder==="true"
},getRelationship:function(){return r.dataset.foundationCollectionMetaRel
}}
}});
a.register("foundation.adapters",{type:"foundation-selections",selector:".foundation-layout-table.foundation-collection",adapter:function(r){var s=h(r);
return{count:function(){return s.find(".foundation-selections-item").length
},clear:function(t){s.data("foundation-layout-table.internal.bulkSelection",true);
var u=s.find(".foundation-selections-item").each(function(){this.selected=false
});
s.removeData("foundation-layout-table.internal.bulkSelection");
o(s,false,h(),u);
if(!t){s.trigger("foundation-selections-change")
}},select:function(t){var u=h(t);
if(!u.hasClass("foundation-collection-item")){return
}t.selected=true
},deselect:function(t){var u=h(t);
if(!u.hasClass("foundation-collection-item")){return
}t.selected=false
}}
}})
})(window,document,Granite,Granite.$,Granite.URITemplate);
(function(b,c,a){c(b).adaptTo("foundation-registry").register("foundation.validation.validator",{selector:".foundation-layout-actionfield-field",show:function(f,h){var g=c(f);
var j=g.closest(".coral-Form-field");
var e=g.adaptTo("foundation-field");
if(e&&e.setInvalid){e.setInvalid(true)
}j.nextAll(".coral-Form-fieldinfo").addClass("u-coral-screenReaderOnly");
var d=g.data("foundation-validation.internal.error");
if(d){var i=c(d).data("foundation-validation.internal.error.tooltip");
i.content.innerHTML=h
}else{d=new a.Icon();
d.icon="alert";
d.classList.add("coral-Form-fielderror");
i=new a.Tooltip();
i.variant="error";
i.placement=j.closest("form").hasClass("coral-Form--vertical")?"left":"bottom";
i.target=d;
i.content.innerHTML=h;
c(d).data("foundation-validation.internal.error.tooltip",i);
g.data("foundation-validation.internal.error",d);
g.after(d,i)
}},clear:function(f){var g=c(f);
var i=g.closest(".coral-Form-field");
var e=g.adaptTo("foundation-field");
if(e&&e.setInvalid){e.setInvalid(false)
}var d=g.data("foundation-validation.internal.error");
if(d){var h=c(d).data("foundation-validation.internal.error.tooltip");
h.hide();
h.remove();
d.remove()
}i.nextAll(".coral-Form-fieldinfo").removeClass("u-coral-screenReaderOnly")
}})
})(window,Granite.$,Coral);
(function(d,a,e){var b=e(d).adaptTo("foundation-registry");
b.register("foundation.adapters",{type:"foundation-toggleable",selector:".foundation-layout-panel-rail.foundation-toggleable",adapter:function(f){var g=e(f);
return{isOpen:function(){return f.classList.contains("foundation-layout-panel-rail-active")
},show:function(h){f.classList.add("foundation-layout-panel-rail-active");
g.trigger("foundation-toggleable-show")
},hide:function(){f.classList.remove("foundation-layout-panel-rail-active");
g.find("> coral-panelstack > coral-panel.foundation-layout-panel-rail-panel[selected]").prop("selected",false).trigger("foundation-toggleable-hide");
g.trigger("foundation-toggleable-hide")
}}
}});
b.register("foundation.adapters",{type:"foundation-toggleable",selector:"coral-panel.foundation-layout-panel-rail-panel.foundation-toggleable",adapter:function(g){var f=e(g);
return{isOpen:function(){return g.selected&&f.closest(".foundation-layout-panel-rail").adaptTo("foundation-toggleable").isOpen()
},show:function(h){var i=f.parent("coral-panelstack")[0].selectedItem;
g.selected=true;
var j=f.closest(".foundation-layout-panel-rail").addClass("foundation-layout-panel-rail-active");
if(i){e(i).trigger("foundation-toggleable-hide")
}f.trigger("foundation-toggleable-show");
j.trigger("foundation-toggleable-show")
},hide:function(){g.selected=false;
var h=f.closest(".foundation-layout-panel-rail").removeClass("foundation-layout-panel-rail-active");
f.trigger("foundation-toggleable-hide");
h.trigger("foundation-toggleable-hide")
}}
}});
var c="foundation-layout-panel-rail-panel.internal.loaded";
e(a).on("foundation-toggleable-show","coral-panel.foundation-layout-panel-rail-panel",function(g){var h=this.dataset.foundationLayoutPanelRailPanelSrc;
if(!h){return
}var f=e(this);
if(f.data(c)){return
}f.data(c,true);
e.ajax({url:h,cache:false}).done(function(i){var j=e(d).adaptTo("foundation-util-htmlparser");
j.parse(i).then(function(k){e(f[0].content).html("").append(k);
f.trigger("foundation-contentloaded")
})
}).fail(function(){var k=Granite.I18n.get("Error");
var i=Granite.I18n.get("Something went wrong.");
var j=e(d).adaptTo("foundation-ui");
j.alert(k,i,"error")
})
})
})(window,document,Granite.$);
(function(g,e){function c(m){var o=m.data("foundationAdvancedselectControlSrc");
if(!o){return
}var j=m.closest(".foundation-advancedselect");
if(!j.length){return
}var l=e(window).adaptTo("foundation-ui");
l.wait();
var k=j.find(".foundation-advancedselect-navigator");
var n=j.find(".foundation-advancedselect-collection");
e.ajax(o).done(function(p){var q=e(window).adaptTo("foundation-util-htmlparser");
q.parse(p).then(function(t){var u=e(t.querySelectorAll(".foundation-advancedselect"));
var s=u.find(".foundation-advancedselect-navigator");
k.replaceWith(s);
var r=n.adaptTo("foundation-collection");
j.data("foundation-advancedselect.internal.ignoreselectionevent",true);
r.clear();
r.append(u.find(".foundation-collection-item").toArray());
j.removeData("foundation-advancedselect.internal.ignoreselectionevent");
i(j,s,n);
j.trigger("foundation-contentloaded");
l.clearWait()
})
}).fail(function(){l.clearWait();
var q=Granite.I18n.get("Error");
var p=Granite.I18n.get("Something went wrong.");
l.alert(q,p,"error")
})
}function i(j,l,o){var n=l.data("foundationAdvancedselectNavigatorPath").toString();
var m=j.data("foundation-advancedselect.internal.values")||{};
var k=m[n];
if(!k){return
}k.each(function(q,p){j.find(".foundation-collection-item[data-foundation-collection-item-id]").each(function(){if(e(this).data("foundationCollectionItemId")===p.value){o.adaptTo("foundation-selections").select(this)
}})
})
}function b(j,n){var l=j.find(".foundation-advancedselect-navigator");
var p;
if(l.length){p=l.data("foundationAdvancedselectNavigatorPath").toString()
}else{p="_default"
}var m=j.data("foundation-advancedselect.internal.values");
if(!m){m={};
j.data("foundation-advancedselect.internal.values",m)
}if(m[p]){m[p].remove()
}var o=j.data("foundationAdvancedselectName");
var k=j.find(".foundation-advancedselect-collection .foundation-selections-item").map(function(){var r=e(this);
var s=r.data("foundationCollectionItemId");
var q;
if(s){q=e(g.createElement("input")).prop("type","hidden").prop("name",o).prop("value",s)
}else{q=r.find("input.aria-value[type=hidden]").clone();
q.prop("disabled",false);
if(o&&!q.prop("name")){q.prop("name",o)
}}return q.appendTo(n)[0]
});
m[p]=k
}function h(j,l){var k=j.find(".foundation-advancedselect-status");
if(!k.length){return
}var m=k.data("foundationAdvancedselectStatusTemplate");
var n=m.replace("{{count}}",l.children().length);
k.html(n)
}e(g).on("click",".foundation-advancedselect-control",function(l){l.preventDefault();
var k=e(this);
var j=k.data("foundationAdvancedselectControlAction");
if(j==="foundation.navigate"){c(k)
}});
e(g).on("foundation-selections-change",".foundation-advancedselect",function(m){var j=e(this);
if(j.data("foundation-advancedselect.internal.ignoreselectionevent")){return
}var k=j.find(".foundation-advancedselect-values");
b(j,k);
h(j,k);
var l=j.adaptTo("foundation-validation");
if(l){l.checkValidity();
l.updateUI()
}});
var a=e(window).adaptTo("foundation-registry");
a.register("foundation.validation.selector",{submittable:".foundation-advancedselect",candidate:".foundation-advancedselect",exclude:".foundation-advancedselect *"});
var f;
function d(){if(!f){f=Granite.I18n.get("Please fill out this field.")
}return f
}a.register("foundation.validation.validator",{selector:".foundation-advancedselect",validate:function(k){if(k.getAttribute("aria-required")!=="true"){return
}var j=e(k).find(".foundation-advancedselect-values > *");
if(j.length===0){return d()
}}})
})(document,Granite.$);
(function(a,d){function b(e){var f=e.children(":not(.foundation-nestedcheckboxlist)");
return f.is("input:checkbox:not([disabled])")?f:f.find("input:checkbox:not([disabled])")
}function c(f,j){var i=f.closest(".foundation-nestedcheckboxlist").closest("li.foundation-nestedcheckboxlist-item");
if(!i.length){return
}var h=Array.prototype.every.call(f.siblings("li.foundation-nestedcheckboxlist-item"),function(k){return b(d(k)).is(":checked")===j
});
var e=b(i);
var g=e.prop("indeterminate");
if(h){if(g){e.prop({indeterminate:false,checked:j});
c(i,j)
}}else{if(!g){e.prop({indeterminate:true,checked:false});
c(i,j)
}}}d(a).on("change",".foundation-nestedcheckboxlist-item",function(k){k.stopPropagation();
var f=d(this);
var h=f.closest(".foundation-nestedcheckboxlist");
if(h.data("foundation-nestedcheckboxlist-disconnected")===true){return
}var j=d(k.target);
var i=j.prop("checked");
var g=f.find(".foundation-nestedcheckboxlist");
if(g.length&&g.data("foundation-nestedcheckboxlist-disconnected")===true){return
}f.find("ul input:checkbox").prop({indeterminate:false,checked:i});
c(f,i)
})
})(document,Granite.$);
(function(a,c,b){c(a).on("foundation-contentloaded",function(d){c(".betty-ActionBar",d.target).each(function(){var e=c(this);
var f="betty-ActionBar.internal.init";
if(e.data(f)){return
}e.data(f,true);
b.commons.ready(this,function(){b.commons.addResizeListener(this,function(h){var g=e.width();
if(g<=360){e.addClass("betty-ActionBar--collapsed")
}else{e.removeClass("betty-ActionBar--collapsed")
}this._onLayout()
})
}.bind(this))
})
})
})(document,Granite.$,Coral);
(function(a,h,g){var d=h(window).adaptTo("foundation-util-propertybuilder");
var f=h(window).adaptTo("foundation-tracker");
var c=Object.create(HTMLElement.prototype);
c.createdCallback=function(){var i=this;
this._icon=new g.Icon().set({icon:this.icon,size:"S"});
this._icon.classList.add("betty-breadcrumbs-button-icon");
this._buttonText=a.createElement("span");
var m=new g.Icon().set({icon:"chevronDown",size:"XXS"});
m.classList.add("betty-breadcrumbs-button-chevron");
this._button=a.createElement("button");
this._button.className="betty-breadcrumbs-button coral-Button coral-Button--quiet";
this._button.type="button";
this._button.autocomplete="off";
this._button.tracking="off";
this._button.setAttribute("aria-haspopup","true");
var k=a.createElement("span");
k.className="betty-breadcrumbs-button-innerwrapper";
this._button.appendChild(k);
k.appendChild(this._icon);
k.appendChild(this._buttonText);
k.appendChild(m);
this._selectListEl=new g.SelectList();
this._selectListEl.tracking="off";
var j=false;
this._selectListEl.on("coral-selectlist:change",function(q){var n=q.detail.selection;
if(j){j=false;
return
}var p=h(n).data("betty-breadcrumbs.internal.targetItem");
j=true;
requestAnimationFrame(function(){n.selected=false
});
l.open=false;
if(p.selected){return
}p.selected=true;
var o=a.createEvent("HTMLEvents");
o.initEvent("change",true,false);
i.dispatchEvent(o);
f.trackEvent({element:p.trackingElement||p.textContent,type:"breadcrumbs-item",action:"change",widget:{name:i.trackingElement,type:"breadcrumbs"},feature:i.trackingFeature})
});
var l=new g.Popover().set({target:this._button,alignMy:"center top",alignAt:"center top",tracking:"off"});
l.classList.add("betty-breadcrumbs-popover");
l.content.appendChild(this._selectListEl);
l.on("coral-overlay:beforeopen",function(){i._updateSelectList()
});
l.on("coral-overlay:open",function(){var o=i.selectedItem;
var n;
if(o){n=o.trackingElement||o.textContent
}else{n=""
}f.trackEvent({element:n,type:"breadcrumbs-popover",action:"open",widget:{name:i.trackingElement,type:"breadcrumbs"},feature:i.trackingFeature})
});
l.on("coral-overlay:close",function(){var o=i.selectedItem;
var n;
if(o){n=o.trackingElement||o.textContent
}else{n=""
}f.trackEvent({element:n,type:"breadcrumbs-popover",action:"close",widget:{name:i.trackingElement,type:"breadcrumbs"},feature:i.trackingFeature})
});
this.insertBefore(l,this.firstChild);
this.insertBefore(this._button,this.firstChild);
this._isItemDirty=true
};
c.attributeChangedCallback=function(k,i,j){if(k==="icon"){this._icon.icon=j;
return
}};
Object.defineProperties(c,{icon:d.createAttrBasedProperty("icon",""),selectedItem:{get:function(){var i=null;
h(this).children("betty-breadcrumbs-item").each(function(){if(this.selected){i=this;
return false
}});
return i
}},trackingFeature:d.createAttrBasedProperty("trackingfeature",""),trackingElement:d.createAttrBasedProperty("trackingelement","")});
c._onItemAttached=function(i){this._isItemDirty=true;
if(i.selected){this._onSelect(i)
}else{if(!this.selectedItem){i.selected=true
}}this._updateButtonDisability()
};
c._onItemDetached=function(i){this._isItemDirty=true;
if(i.selected){this._onUnselect(i)
}this._updateButtonDisability()
};
c._onSelect=function(i){h(this).children("betty-breadcrumbs-item").not(i).each(function(){this._selected=false
});
this._updateButtonText(i)
};
c._onUnselect=function(i){h(this).children("betty-breadcrumbs-item").not(i).first().prop("selected",true)
};
c._onButtonTextChange=function(i){this._isItemDirty=true;
if(this.selectedItem===i){this._updateButtonText(i)
}};
c._updateButtonDisability=function(){this._button.disabled=h(this).children("betty-breadcrumbs-item").length<=1
};
c._updateButtonText=function(i){this._buttonText.textContent=i.textContent
};
c._updateSelectList=function(){if(!this._isItemDirty){return
}var i=this._selectListEl;
i.items.clear();
h(this).children("betty-breadcrumbs-item").each(function(){var j=new g.SelectList.Item();
j.content.textContent=this.textContent;
h(j).data("betty-breadcrumbs.internal.targetItem",this);
i.items.add(j)
});
this._isItemDirty=false
};
var e=a.registerElement("betty-breadcrumbs",{prototype:c});
var b=Object.create(HTMLElement.prototype);
b.createdCallback=function(){this._selected=false;
this._watchDescendants()
};
b.attachedCallback=function(){if(h(this.parentElement).is("betty-breadcrumbs")){this._parent=this.parentElement;
this._parent._onItemAttached(this)
}};
b.detachedCallback=function(){if(this._parent){this._parent._onItemDetached(this)
}this._parent=null
};
Object.defineProperties(b,{selected:{get:function(){return this._selected
},set:function(i){if(!!i===this._selected){return
}this._selected=!!i;
if(this._parent){if(this._selected){this._parent._onSelect(this)
}else{this._parent._onUnselect(this)
}}}},trackingElement:d.createAttrBasedProperty("trackingelement","")});
b._watchDescendants=function(){var j=this;
var i=new MutationObserver(function(k){if(j._parent){j._parent._onButtonTextChange(j)
}});
i.observe(this,{childList:true})
};
e.Item=a.registerElement("betty-breadcrumbs-item",{prototype:b})
})(document,Granite.$,Coral,Granite);
(function(a,b){b(a).on("click",".granite-collection-deselect",function(f){f.preventDefault();
var d=this.dataset.graniteCollectionDeselectTarget;
if(d){var g=b(d);
var c=g.adaptTo("foundation-selections");
c.clear()
}})
})(document,Granite.$);
(function(i,e,g){var c="granite-collection-navigator.internal.internalEvent";
function h(n,o){var m=o.adaptTo("foundation-collection");
if(!("load" in m)){if(console){console.warn("FoundationCollection#load is not implemented; do nothing.")
}}m.load(n)
}e(i).on("coral-selectlist:change",".granite-collection-navigator:not(betty-breadcrumbs)",function(q){var o=q.originalEvent.detail;
var s=o.selection;
if(e(s).data(c)){return
}this.hide();
if(s===o.oldSelection){return
}var n=e(s);
var r=e(this.dataset.graniteCollectionNavigatorTarget);
var p=s.dataset.graniteCollectionNavigatorCollectionid;
if(p){h(p,r);
var m=!n.next("coral-selectlist-item").length;
a(e(this).prev(),n.text(),m);
setTimeout(function(){n.prevAll().detach()
},500)
}else{window.location=s.dataset.graniteCollectionNavigatorHref
}});
e(i).on("change","betty-breadcrumbs.granite-collection-navigator",function(n){var p=this.selectedItem;
var o=e(this.dataset.graniteCollectionNavigatorTarget);
var m=p.dataset.graniteCollectionNavigatorCollectionid;
if(m){e(p).prevAll("betty-breadcrumbs-item").remove();
h(m,o)
}else{window.location=p.dataset.graniteCollectionNavigatorHref
}});
function a(n,o,m){if(n[0].label){n[0].label.textContent=o
}else{n.children("span").text(o)
}if(n.hasClass("granite-breadcrumbs-button")){n.prop("disabled",m)
}}function l(o,n){o.data(c,true);
o.prop("selected",true);
o.removeData(c);
var m=!o.next("coral-selectlist-item").length;
a(n,o.text(),m)
}function d(s,t){var v=t[0].dataset.foundationCollectionId;
var n=s.find("coral-selectlist-item").filter(function(){return this.dataset.graniteCollectionNavigatorCollectionid===v
});
if(n.length){l(n,s.prev());
n.prevAll().detach();
return
}var o=t.find(".foundation-collection-item").filter(function(){return this.dataset.foundationCollectionItemId===v
});
var r=o.closest("coral-columnview-column")[0].dataset.foundationLayoutColumnviewColumnid;
var p=s.find("coral-selectlist-item").filter(function(){return this.dataset.graniteCollectionNavigatorCollectionid===r
});
var q=p.prev();
var m=function(y,x){y.content.textContent=e(x).find(".foundation-collection-item-title").text();
y.dataset.graniteCollectionNavigatorCollectionid=x.dataset.foundationCollectionItemId
};
if(q.length){m(q[0],o[0]);
l(q,s.prev());
q.prevAll().detach()
}else{var u=new Coral.SelectList.Item();
var w=e(u);
m(u,o[0]);
p.before(u);
l(w,s.prev());
w.prevAll().detach()
}}function k(s,t){if(!s.is("betty-breadcrumbs")){d(s,t);
return
}var v=t[0].dataset.foundationCollectionId;
if(v.startsWith("parentof:")){v=v.substring("parentof:".length)
}var n=s.children("betty-breadcrumbs-item").filter(function(){return this.dataset.graniteCollectionNavigatorCollectionid===v
});
if(n.length){n.prop("selected",true);
n.prevAll("betty-breadcrumbs-item").remove();
return
}var o=t.find(".foundation-collection-item").filter(function(){return this.dataset.foundationCollectionItemId===v
});
var r=o.closest("coral-columnview-column")[0].dataset.foundationLayoutColumnviewColumnid;
var p=s.children("betty-breadcrumbs-item").filter(function(){return this.dataset.graniteCollectionNavigatorCollectionid===r
});
var q=p.prev("betty-breadcrumbs-item");
var m=function(y,x){y.textContent=e(x).find(".foundation-collection-item-title").text();
y.dataset.graniteCollectionNavigatorCollectionid=x.dataset.foundationCollectionItemId;
y.selected=true
};
if(q.length){m(q[0],o[0]);
q.prevAll("betty-breadcrumbs-item").remove()
}else{var u=i.createElement("betty-breadcrumbs-item");
var w=e(u);
m(u,o[0]);
p.before(u);
w.prevAll("betty-breadcrumbs-item").remove()
}}function b(q,r){var m=r[0].dataset.foundationCollectionId;
var o=q.find("coral-selectlist-item").filter(function(){return this.dataset.graniteCollectionNavigatorCollectionid===m
});
if(o.length){l(o,q.prev());
o.prevAll().detach();
return
}var p=r.adaptTo("foundation-collection-meta");
if(!p){return
}var n=new Coral.SelectList.Item();
n.content.textContent=p.getTitle();
n.dataset.graniteCollectionNavigatorCollectionid=m;
q.find("coral-selectlist-item").first().before(n);
l(e(n),q.prev())
}function f(q,r){if(!q.is("betty-breadcrumbs")){b(q,r);
return
}var m=r[0].dataset.foundationCollectionId;
var o=q.children("betty-breadcrumbs-item").filter(function(){return this.dataset.graniteCollectionNavigatorCollectionid===m
});
if(o.length){o.prop("selected",true);
o.prevAll("betty-breadcrumbs-item").remove();
return
}var p=r.adaptTo("foundation-collection-meta");
if(!p){return
}var n=i.createElement("betty-breadcrumbs-item");
n.textContent=p.getTitle();
n.dataset.graniteCollectionNavigatorCollectionid=m;
n.selected=true;
q.children("betty-breadcrumbs-item:first-of-type").before(n)
}function j(q,s,u){var o=History.getState();
var t=o.data.shellCollection;
var w=s[0].dataset.foundationCollectionId;
if(t&&t.id===w){return
}var m=q[0].dataset.graniteCollectionPagetitleSrc;
if(!m){return
}var r=q[0].dataset.graniteCollectionPagetitleBase;
if(u){r+=" | "+u
}var n=g.expand(m,{id:w});
History.pushState({shellCollection:{id:w,target:q[0].dataset.graniteCollectionPagetitleTarget}},r,n);
var x=e('meta[name="foundation.tracking.page"]',i.head).attr("content");
if(x){var p=JSON.parse(x);
p.assetId=w;
var v=e(window).adaptTo("foundation-tracker");
v.trackPage(p)
}}e(function(){if(!History.enabled){return
}var n=i.querySelector(".granite-collection-pagetitle");
if(!n){return
}var o=n.dataset.graniteCollectionPagetitleTarget;
var m=i.querySelector(o);
var p=m.dataset.foundationCollectionId;
History.replaceState({shellCollection:{id:p,target:o}})
});
e(function(){e(".granite-breadcrumbs-button").each(function(){var m=e(this).next(".granite-collection-navigator").find("coral-selectlist-item[selected]").next("coral-selectlist-item").length===0;
this.disabled=m
})
});
e(window).on("statechange",function(p){var o=History.getState();
var m=o.data.shellCollection;
if(!m){return
}var q=e(m.target);
if(q[0].dataset.foundationCollectionId===m.id){return
}var n=q.adaptTo("foundation-collection");
n.load(m.id)
});
e(i).on("foundation-collection-navigate",".foundation-collection",function(m){var n=e(this);
e(".granite-collection-navigator").each(function(){var o=e(this);
if(!n.is(this.dataset.graniteCollectionNavigatorTarget)){return
}if(n.hasClass("foundation-layout-columnview")){k(o,n)
}else{f(o,n)
}});
if(!History.enabled){return
}e(".granite-collection-pagetitle").each(function(){var o=e(this);
if(!n.is(this.dataset.graniteCollectionPagetitleTarget)){return
}j(o,n)
})
})
})(document,Granite.$,Granite.URITemplate);
(function(a,b,c,d){c(a).on("coral-cyclebutton:change",".granite-collection-switcher",function(k){var j=k.originalEvent.detail;
var h=j.selection;
var q=this;
var l=q.dataset.graniteCollectionSwitcherTarget;
var f=h.dataset.graniteCollectionSwitcherSrc;
if(!f||!l){return
}var i=c(l);
var m=Array.prototype.map.call(i.find(".foundation-selections-item"),function(e){return e.dataset.foundationCollectionItemId
});
var o={id:i[0].dataset.foundationCollectionId};
var p=i.adaptTo("foundation-collection");
var n="getPagination" in p?p.getPagination():null;
if(n&&m.length){o.offset=0;
o.limit=n.offset
}var g=d.expand(f,o);
b.UI.Foundation.Layouts.cleanAll(i[0]);
c.ajax({url:g,cache:false}).then(function(e){var r=c(window).adaptTo("foundation-util-htmlparser");
r.parse(e).then(function(s){var t=c(s).children();
t.replaceAll(i);
if(m.length){t.data("foundation-layout-collection-switcher.internal.selectionIds",m)
}t.trigger("foundation-contentloaded");
t.removeData("foundation-layout-collection-switcher.internal.selectionIds")
})
},function(){var s=b.I18n.get("Error");
var e=b.I18n.get("Fail to load data.");
var r=c(window).adaptTo("foundation-ui");
r.alert(s,e,"error")
})
})
})(document,Granite,Granite.$,Granite.URITemplate);
(function(a,b){b(a).on("foundation-selections-change",".foundation-collection",function(){var e=b(this);
var c=e.adaptTo("foundation-selections");
var d=c.count()>0;
b(".granite-collection-create").filter(function(){return e.is(this.dataset.graniteCollectionCreateTarget)
}).each(function(){if(d){this.classList.add("granite-collection-create-hidden")
}else{this.classList.remove("granite-collection-create-hidden")
}})
})
})(document,Granite.$);
(function(b,a,c){c(a).on("coral-cyclebutton:change",".granite-toggleable-control",function(k){var j=c(this);
var i=k.originalEvent.detail.selection;
var h=i.dataset.graniteToggleableControlAction;
if(h==="navigate"){b.location.href=i.dataset.graniteToggleableControlHref;
return
}var g=i.dataset.graniteToggleableControlTarget;
if(!g){return
}var f=c(g);
var d=f.adaptTo("foundation-toggleable");
requestAnimationFrame(function(){if(h===undefined){if(d.isOpen()){h="hide"
}else{h="show"
}}if(h==="show"){d.show(j[0])
}else{if(h==="hide"){d.hide()
}}})
})
})(window,document,Granite.$);
(function(a,c){function d(f){var e=new MutationObserver(function(g){var i=g.some(function(l){return l.target instanceof Coral.AnchorList.Item
});
if(!i){return
}var h=c(f);
var k=true;
h.find("a[is='coral-anchorlist-item']").each(function(){if(c(this).css("display")!=="none"){k=false;
return
}});
if(k){f.open=false
}var j=h.prev();
j.prop("hidden",k)
});
e.observe(f,{attributes:true,subtree:true,attributeFilter:["hidden","class"]})
}var b=new WeakMap();
c(a).on("foundation-contentloaded",function(f){c(".granite-pulldown-overlay",f.target).each(function(){if(b.has(this)){return
}d(this);
b.set(this,true)
})
})
})(document,Granite.$);
(function(a,b){b(a).on("click",".granite-ActionGroup-item",function(d){var c=b(d.target).closest("coral-popover");
c.hide()
})
})(document,Granite.$);
(function(d,a,e,c){var f=c.UI.Foundation.Utils.everyReverse;
var b=e(d).adaptTo("foundation-registry");
e(a).on("click",".granite-form-saveactivator",function(j){var h=this;
var g=h.dataset.graniteFormSaveactivatorHref;
var i=e("#"+h.getAttribute("form"));
i.addClass("granite-form-saveactivator-form");
if(g){i.attr("data-granite-form-saveactivator-form-redirect",g)
}else{i.removeAttr("data-granite-form-saveactivator-form-redirect")
}});
e(a).on("foundation-form-submitted",".granite-form-saveactivator-form",function(l,g,m){if(!g){return
}var i=e(this);
var h=i.data("foundationFormResponseUiSuccess")||i.children(".foundation-form-response-ui-success").data("foundationFormResponseUiSuccess");
if(h){return
}var k=this.dataset.graniteFormSaveactivatorFormRedirect;
if(k){h={name:"foundation.redirect",href:k};
var j=e(d).adaptTo("foundation-util-messenger");
j.put(null,c.I18n.get("The form has been submitted successfully"),"success")
}else{h={name:"foundation.reload"}
}f(b.get("foundation.form.response.ui.success"),function(n){if(n.name!==h.name){return true
}return n.handler.call(i[0],i[0],h)===false
})
})
})(window,document,Granite.$,Granite);
(function(d,f,c){var e=new WeakMap();
function h(m,j){var l=m[0].dataset.granitePickerdialogCollection;
if(l){var k=c(l).adaptTo("foundation-selections");
if(k){k.clear()
}}return{clean:function(){},replace:function(n){}}
}function b(m,k){var j=k.filter("#granite-pickerdialog-search-result-titlebar-center");
var l=k.filter("#granite-pickerdialog-search-result-titlebar-right");
var o=m.find(".granite-pickerdialog-titlebar");
var p=o.children("betty-titlebar-title");
var n=o.children("betty-titlebar-secondary");
if(j.length){p.prop("hidden",true).after(j);
n.prop("hidden",true).after(l)
}o.trigger("foundation-contentloaded");
return{clean:function(){p.prop("hidden",false);
j.remove();
n.prop("hidden",false);
l.remove()
},replace:function(q){j=q.filter("#granite-pickerdialog-search-result-titlebar-center").replaceAll(j);
l=q.filter("#granite-pickerdialog-search-result-titlebar-right").replaceAll(l);
o.trigger("foundation-contentloaded")
}}
}function i(l,j){var m=j.filter("#granite-pickerdialog-search-result-content");
var k=l.find(".granite-pickerdialog-content .foundation-layout-panel-content").prop("hidden",true);
m.insertAfter(k).trigger("foundation-contentloaded");
return{clean:function(){m.remove();
k.prop("hidden",false)
},replace:function(n){m=n.filter("#granite-pickerdialog-search-result-content").replaceAll(m).trigger("foundation-contentloaded")
}}
}function a(m,k){var o=m.find(".granite-pickerdialog-searchfield");
var l=o.children("[foundation-autocomplete-button]");
var j=l.prop("icon");
var p=Granite.I18n.get("Close Search");
l.prop("tabIndex",0);
l.prop("icon","closeCircle");
l.attr("title",p);
l.attr("aria-label",p);
l.removeAttr("role");
var n=function(q){q.preventDefault();
this.blur();
g(m)
};
l.on("click",n);
return{clean:function(){var q=o.adaptTo("foundation-field");
if(q){q.setValue("")
}l.prop("tabIndex",-1);
l.prop("icon",j);
l.removeAttr("title");
l.removeAttr("aria-label");
l.attr("role","presentation");
l.off("click",n)
},replace:function(q){}}
}function g(k){var l=k[0];
var j=e.get(l);
if(j){Granite.UI.Foundation.Utils.everyReverse(j,function(m){m.clean();
return true
})
}e["delete"](l)
}c(d).adaptTo("foundation-registry").register("foundation.form.response.ui.success",{name:"granite.pickerdialog.search.result",handler:function(k,j,m,p,n,l){var o=c(d).adaptTo("foundation-util-htmlparser");
o.parse(l).then(function(s){var r=c(s).children();
var t=c(k).closest(".granite-pickerdialog");
var u=t[0];
var q=e.get(u);
if(q){q.forEach(function(w){w.replace(r)
})
}else{var q=[];
q.push(h(t,r));
q.push(b(t,r));
q.push(i(t,r));
q.push(a(t,r));
e.set(u,q)
}})
}});
c(f).on("click",".granite-pickerdialog-search-close",function(k){k.preventDefault();
var j=c(this).closest(".granite-pickerdialog");
g(j)
})
})(window,document,Granite.$);
(function(c,d){function b(e){return function(f){if(!e){return""
}return e.replace("{{count}}",f.count)
}
}function a(f,h){var g=b(f.data("foundationAdminSelectionstatusTemplate"));
var e=h.adaptTo("foundation-selections");
f.html(g({count:e.count()}))
}d(c).on("foundation-selections-change",".foundation-collection",function(){var e=d(this);
d(".foundation-admin-selectionstatus").filter(function(){return e.is(d(this).data("foundationAdminSelectionstatusTarget"))
}).each(function(){var f=d(this);
a(f,e)
})
})
})(document,Granite.$);
(function(b,a,c){c(a).on("foundation-form-submitted","#granite-user-preferences",function(g,d){if(d){var f=c(this);
c(a).trigger(c.Event("user-preferences-changed",{userPreferences:f.serializeArray()}));
setTimeout(function(){b.location.reload()
},100)
}})
})(window,document,Granite.$);
(function(c,a,b){var d=c.chrome&&/Google/.test(b.vendor)&&!/OPR|Edge/.test(b.userAgent);
if(d){c.addEventListener("unload",function(){a.documentElement.innerHTML=""
})
}})(window,document,navigator);